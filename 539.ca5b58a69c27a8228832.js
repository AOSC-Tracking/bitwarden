"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[539],{28539:(e,t,n)=>{n.r(t),n.d(t,{SecretsManagerModule:()=>ia});var i=n(71146),o=n(73650),s=n(19419),c=n(75557),r=n(41938),a=n(36903),u=n(24852);class l{}l.ɵfac=function(e){return new(e||l)},l.ɵmod=u.oAB({type:l}),l.ɵinj=u.cJS({imports:[s.ez,a.m,r.v,o.U8,c.Bz]});var d=n(19244),p=n(49399),h=n(12492);const g=[[["","slot","sidebar"]],"*"],v=function(){return[]},f=function(){return{"--color-text-alt2":"var(--color-text-main)","--color-background-alt3":"var(--color-secondary-100)","--color-background-alt4":"var(--color-secondary-300)","--color-secondary-300":"var(--color-secondary-500)"}};class m{constructor(){this.mainContentId="main-content",this.variant="primary"}focusMainContent(){var e;null===(e=document.getElementById(this.mainContentId))||void 0===e||e.focus()}}m.ɵfac=function(e){return new(e||m)},m.ɵcmp=u.Xpm({type:m,selectors:[["bit-layout"]],inputs:{variant:"variant"},standalone:!0,features:[u.jDz],ngContentSelectors:["[slot=sidebar]","*"],decls:23,vars:9,consts:[[1,"tw-fixed","tw-z-50","tw-w-full","tw-flex","tw-justify-center","tw-opacity-0","focus-within:tw-opacity-100","tw-pointer-events-none","focus-within:tw-pointer-events-auto"],[1,"tw-bg-background-alt3","tw-rounded-md","tw-rounded-t-none","tw-py-2","tw-text-alt2"],["bitLink","","linkType","light",1,"tw-mx-6","focus-visible:before:!tw-ring-0",3,"fragment","routerLink","click"],[1,"tw-flex","tw-w-full"],[1,"tw-fixed","tw-inset-y-0","tw-left-0","tw-h-screen","tw-w-60","tw-overflow-auto","tw-bg-background-alt3",3,"ngStyle"],["tabindex","-1",1,"tw-ml-60","tw-min-h-screen","tw-min-w-0","tw-flex-1","tw-bg-background","tw-p-6",3,"id"]],template:function(e,t){1&e&&(u.F$t(g),u.TgZ(0,"div",0),u._uU(1,"\n  "),u.TgZ(2,"nav",1),u._uU(3,"\n    "),u.TgZ(4,"a",2),u.NdJ("click",(function(){return t.focusMainContent()})),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n  "),u.qZA(),u._uU(8,"\n"),u.qZA(),u._uU(9,"\n"),u.TgZ(10,"div",3),u._uU(11,"\n  "),u.TgZ(12,"aside",4),u._uU(13,"\n    "),u.Hsn(14),u._uU(15,"\n  "),u.qZA(),u._uU(16,"\n  "),u.TgZ(17,"main",5),u._uU(18,"\n    "),u.Hsn(19,1),u._uU(20,"\n  "),u.qZA(),u._uU(21,"\n"),u.qZA(),u._uU(22,"\n")),2&e&&(u.xp6(4),u.Q6J("fragment",t.mainContentId)("routerLink",u.DdM(7,v)),u.xp6(1),u.Oqu(u.lcZ(6,5,"skipToContent")),u.xp6(7),u.Q6J("ngStyle","secondary"===t.variant&&u.DdM(8,f)),u.xp6(5),u.Q6J("id",t.mainContentId))},dependencies:[a.m,s.PC,p.C,d.L,h.r,c.Bz,c.rH],encapsulation:2});var w=n(85921);class U{}U.ɵfac=function(e){return new(e||U)},U.ɵmod=u.oAB({type:U}),U.ɵinj=u.cJS({imports:[w.m,l,m]});var A=n(39639),_=n(98002),b=n(31393),y=n(27420),Z=n(63078),x=n(782),S=n(85915);class T{}T.ɵfac=function(e){return new(e||T)},T.ɵmod=u.oAB({type:T}),T.ɵinj=u.cJS({imports:[i.m,x.D,S.O]});class I{}I.ɵfac=function(e){return new(e||I)},I.ɵmod=u.oAB({type:I}),I.ɵinj=u.cJS({imports:[i.m,S.O,A.q,Z.WO,_.t,b.A,x.D,y.t,T,T,_.t,y.t,b.A,i.m]});var P=n(66463),q=n(22976),j=n(58691),k=n(4871),C=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};var L=n(2184),O=n(67855),N=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class J{ngOnInit(){document.body.classList.remove("layout_frontend")}}J.ɵfac=function(e){return new(e||J)},J.ɵcmp=u.Xpm({type:J,selectors:[["sm-layout"]],decls:7,vars:0,consts:[["slot","sidebar","name","sidebar"]],template:function(e,t){1&e&&(u.TgZ(0,"bit-layout"),u._uU(1,"\n  "),u._UZ(2,"router-outlet",0),u._uU(3,"\n  "),u._UZ(4,"router-outlet"),u._uU(5,"\n"),u.qZA(),u._uU(6,"\n"))},dependencies:[c.lC,m],encapsulation:2});var D=n(92786),E=n(63201),z=n(22221);class Y{constructor(){this.variant="default",this.treeDepth=0,this.hideActiveStyles=!1,this.mainContentClicked=new u.vpe}}Y.ɵfac=function(e){return new(e||Y)},Y.ɵdir=u.lG2({type:Y,inputs:{text:"text",ariaLabel:"ariaLabel",icon:"icon",route:"route",variant:"variant",treeDepth:"treeDepth",hideActiveStyles:"hideActiveStyles"},outputs:{mainContentClicked:"mainContentClicked"}});var G=n(59554),M=n(21656);const Q=function(e){return{"tw-w-0":e}};function R(e,t){if(1&e&&(u.TgZ(0,"div",10),u._uU(1,"\n      "),u._UZ(2,"button",11),u._uU(3,"\n    "),u.qZA()),2&e){const e=u.oxw();u.Q6J("ngClass",u.VKq(2,Q,"tree"!==e.variant)),u.xp6(2),u.Q6J("bitIconButton","bwi-angle-down")}}function B(e,t){1&e&&u.GkF(0)}function F(e,t){if(1&e&&(u._uU(0,"\n      "),u._UZ(1,"i"),u.TgZ(2,"span",10),u._uU(3),u.qZA(),u._uU(4,"\n    ")),2&e){const e=u.oxw();u.xp6(1),u.Gre("bwi bwi-fw tw-text-alt2 tw-mx-1 ",e.icon,""),u.xp6(1),u.Q6J("ngClass",e.showActiveStyles?"tw-font-bold":"tw-font-semibold"),u.xp6(1),u.Oqu(e.text)}}function $(e,t){1&e&&u.GkF(0)}function V(e,t){if(1&e){const e=u.EpF();u._uU(0,"\n      "),u._uU(1,"\n      "),u._uU(2,"\n      "),u.TgZ(3,"a",12),u.NdJ("isActiveChange",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.setActive(t))}))("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.mainContentClicked.emit())})),u._uU(4,"\n        "),u.YNc(5,$,1,0,"ng-container",13),u._uU(6,"\n      "),u.qZA(),u._uU(7,"\n    ")}if(2&e){const e=u.oxw(),t=u.MAs(18);u.xp6(3),u.Q6J("routerLink",e.route)("routerLinkActiveOptions",e.rlaOptions)("ariaCurrentWhenActive","page"),u.uIk("aria-label",e.ariaLabel||e.text),u.xp6(2),u.Q6J("ngTemplateOutlet",t)}}function K(e,t){1&e&&u.GkF(0)}function H(e,t){if(1&e){const e=u.EpF();u._uU(0,"\n      "),u._uU(1,"\n      "),u.TgZ(2,"button",14),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.mainContentClicked.emit())})),u._uU(3,"\n        "),u.YNc(4,K,1,0,"ng-container",13),u._uU(5,"\n      "),u.qZA(),u._uU(6,"\n    ")}if(2&e){u.oxw();const e=u.MAs(18);u.xp6(4),u.Q6J("ngTemplateOutlet",e)}}const W=[[["","slot","start"]],[["","slot","end"]]],X=function(e,t){return[e,t]},ee=function(e){return{"padding-left":e}},te=function(e){return[e]};class ne extends Y{constructor(){super(...arguments),this._active=!1,this.rlaOptions={paths:"subset",queryParams:"exact",fragment:"ignored",matrixParams:"ignored"},this.focusVisibleWithin$=new G.X(!1),this.fvwStyles$=this.focusVisibleWithin$.pipe((0,D.U)((e=>e?"tw-z-10 tw-rounded tw-outline-none tw-ring tw-ring-text-alt2":"")))}setActive(e){this._active=e}get showActiveStyles(){return this._active&&!this.hideActiveStyles}set exactMatch(e){this.rlaOptions.paths=e?"exact":"subset"}onFocusIn(e){this.focusVisibleWithin$.next(e.matches(".fvw:focus-visible"))}onFocusOut(){this.focusVisibleWithin$.next(!1)}}ne.ɵfac=function(){let e;return function(t){return(e||(e=u.n5z(ne)))(t||ne)}}(),ne.ɵcmp=u.Xpm({type:ne,selectors:[["bit-nav-item"]],hostBindings:function(e,t){1&e&&u.NdJ("focusin",(function(e){return t.onFocusIn(e.target)}))("focusout",(function(){return t.onFocusOut()}))},inputs:{exactMatch:"exactMatch"},features:[u.qOj],ngContentSelectors:["[slot=start]","[slot=end]"],decls:35,vars:16,consts:[[1,"tw-relative",3,"ngClass"],[1,"tw-relative","tw-flex","tw-items-center","tw-pr-4",3,"ngStyle","ngClass"],[1,"[&>*:focus-visible::before]:!tw-ring-text-alt2","[&>*:hover]:!tw-border-text-alt2","[&>*]:!tw-text-alt2"],["slotStart",""],[3,"ngClass",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["anchorAndButtonContent",""],["isAnchor",""],["isButton",""],[1,"tw-flex","tw-gap-1","[&>*:focus-visible::before]:!tw-ring-text-alt2","[&>*:hover]:!tw-border-text-alt2","[&>*]:tw-text-alt2"],[3,"ngClass"],["type","button","size","small","aria-hidden","true",1,"tw-invisible",3,"bitIconButton"],["routerLinkActive","",1,"fvw","tw-w-full","tw-truncate","tw-border-none","tw-bg-transparent","tw-p-0","tw-text-start","!tw-text-alt2","hover:tw-text-alt2","hover:tw-no-underline","focus:tw-outline-none","[&>:not(.bwi)]:hover:tw-underline",3,"routerLink","routerLinkActiveOptions","ariaCurrentWhenActive","isActiveChange","click"],[4,"ngTemplateOutlet"],["type","button",1,"fvw","tw-w-full","tw-truncate","tw-border-none","tw-bg-transparent","tw-p-0","tw-text-start","!tw-text-alt2","hover:tw-text-alt2","hover:tw-no-underline","focus:tw-outline-none","[&>:not(.bwi)]:hover:tw-underline",3,"click"]],template:function(e,t){if(1&e&&(u.F$t(W),u.TgZ(0,"div",0),u.ALo(1,"async"),u._uU(2,"\n  "),u.TgZ(3,"div",1),u._uU(4,"\n    "),u.TgZ(5,"div",2,3),u._uU(7,"\n      "),u.Hsn(8),u._uU(9,"\n    "),u.qZA(),u._uU(10,"\n    "),u._uU(11,"\n    "),u.YNc(12,R,4,4,"div",4),u._uU(13,"\n\n    "),u.YNc(14,B,1,0,"ng-container",5),u._uU(15,"\n\n    "),u._uU(16,"\n    "),u.YNc(17,F,5,5,"ng-template",null,6,u.W1O),u._uU(19,"\n\n    "),u._uU(20,"\n    "),u.YNc(21,V,8,5,"ng-template",null,7,u.W1O),u._uU(23,"\n\n    "),u._uU(24,"\n    "),u.YNc(25,H,7,1,"ng-template",null,8,u.W1O),u._uU(27,"\n\n    "),u.TgZ(28,"div",9),u._uU(29,"\n      "),u.Hsn(30,1),u._uU(31,"\n    "),u.qZA(),u._uU(32,"\n  "),u.qZA(),u._uU(33,"\n"),u.qZA(),u._uU(34,"\n")),2&e){const e=u.MAs(6),n=u.MAs(22),i=u.MAs(26);u.Q6J("ngClass",u.WLB(9,X,t.showActiveStyles?"tw-bg-background-alt4":"tw-bg-background-alt3",u.lcZ(1,7,t.fvwStyles$))),u.xp6(3),u.Q6J("ngStyle",u.VKq(12,ee,("tree"===t.variant?2.5:1)+1.5*t.treeDepth+"rem"))("ngClass",u.VKq(14,te,"tree"===t.variant?"tw-py-1":"tw-py-2")),u.xp6(9),u.Q6J("ngIf",0===e.childElementCount),u.xp6(2),u.Q6J("ngIf",t.route)("ngIfThen",n)("ngIfElse",i)}},dependencies:[s.mk,s.O5,s.tP,s.PC,M.Q,c.rH,c.Od,s.Ov],encapsulation:2});const ie=function(e,t){return[e,t]};function oe(e,t){if(1&e){const e=u.EpF();u._uU(0,"\n    "),u.TgZ(1,"button",6),u.NdJ("click",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.toggle(t))})),u.ALo(2,"i18n"),u.ALo(3,"i18n"),u.qZA(),u._uU(4,"\n  ")}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("bitIconButton",e.open?"bwi-angle-up":"tree"===e.variant?"bwi-angle-right":"bwi-angle-down")("buttonType","light")("title",u.lcZ(2,6,"toggleCollapse")),u.uIk("aria-expanded",e.open.toString())("aria-controls",e.contentId)("aria-label",u.WLB(10,ie,u.lcZ(3,8,"toggleCollapse"),e.text).join(" "))}}function se(e,t){1&e&&u.GkF(0)}function ce(e,t){if(1&e&&(u.ynx(0,7),u._uU(1,"\n    "),u.YNc(2,se,1,0,"ng-container",8),u._uU(3,"\n  "),u.BQk()),2&e){u.oxw();const e=u.MAs(4);u.xp6(2),u.Q6J("ngTemplateOutlet",e)}}function re(e,t){1&e&&u.GkF(0)}function ae(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n      "),u.YNc(2,re,1,0,"ng-container",8),u._uU(3,"\n    "),u.BQk()),2&e){u.oxw();const e=u.MAs(4);u.xp6(2),u.Q6J("ngTemplateOutlet",e)}}function ue(e,t){if(1&e&&(u.TgZ(0,"div",9),u.ALo(1,"i18n"),u._uU(2,"\n  "),u.Hsn(3,1),u._uU(4,"\n"),u.qZA()),2&e){const e=u.oxw();u.uIk("id",e.contentId)("aria-label",u.WLB(4,ie,e.text,u.lcZ(1,2,"submenu")).join(" "))}}const le=[[["","slot","end"]],"*"];class de extends Y{constructor(){super(...arguments),this.contentId=Math.random().toString(36).substring(2),this.open=!1,this.openChange=new u.vpe}toggle(e){null==e||e.stopPropagation(),this.open=!this.open,this.openChange.emit(this.open)}initNestedStyles(){"tree"===this.variant&&[...this.nestedGroups,...this.nestedItems].forEach((e=>{e.treeDepth+=1}))}ngAfterContentInit(){this.initNestedStyles()}}de.ɵfac=function(){let e;return function(t){return(e||(e=u.n5z(de)))(t||de)}}(),de.ɵcmp=u.Xpm({type:de,selectors:[["bit-nav-group"]],contentQueries:function(e,t,n){if(1&e&&(u.Suo(n,de,5),u.Suo(n,ne,5)),2&e){let e;u.iGM(e=u.CRH())&&(t.nestedGroups=e),u.iGM(e=u.CRH())&&(t.nestedItems=e)}},inputs:{open:"open",exactMatch:"exactMatch"},outputs:{openChange:"openChange"},features:[u.qOj],ngContentSelectors:["[slot=end]","*"],decls:20,vars:10,consts:[[3,"text","icon","route","variant","treeDepth","ariaLabel","exactMatch","mainContentClicked"],["button",""],["slot","start",4,"ngIf"],["slot","end"],[4,"ngIf"],["role","group",4,"ngIf"],["type","button","size","small","aria-haspopup","true",1,"tw-ml-auto",3,"bitIconButton","buttonType","title","click"],["slot","start"],[4,"ngTemplateOutlet"],["role","group"]],template:function(e,t){1&e&&(u.F$t(le),u._uU(0,"\n"),u.TgZ(1,"bit-nav-item",0),u.NdJ("mainContentClicked",(function(){return t.toggle()}))("mainContentClicked",(function(){return t.mainContentClicked.emit()})),u._uU(2,"\n  "),u.YNc(3,oe,5,13,"ng-template",null,1,u.W1O),u._uU(5,"\n\n  "),u._uU(6,"\n  "),u.YNc(7,ce,4,1,"ng-container",2),u._uU(8,"\n  "),u.ynx(9,3),u._uU(10,"\n    "),u.Hsn(11),u._uU(12,"\n    "),u.YNc(13,ae,4,1,"ng-container",4),u._uU(14,"\n  "),u.BQk(),u._uU(15,"\n"),u.qZA(),u._uU(16,"\n\n"),u._uU(17,"\n"),u.YNc(18,ue,5,7,"div",5),u._uU(19,"\n")),2&e&&(u.xp6(1),u.Q6J("text",t.text)("icon",t.icon)("route",t.route)("variant",t.variant)("treeDepth",t.treeDepth)("ariaLabel",t.ariaLabel)("exactMatch",t.exactMatch),u.xp6(6),u.Q6J("ngIf","tree"===t.variant),u.xp6(6),u.Q6J("ngIf","tree"!==t.variant),u.xp6(5),u.Q6J("ngIf",t.open))},dependencies:[s.O5,s.tP,M.Q,ne,p.C],encapsulation:2});var pe=n(33031);class he{}he.ɵfac=function(e){return new(e||he)},he.ɵcmp=u.Xpm({type:he,selectors:[["bit-nav-divider"]],decls:2,vars:0,consts:[[1,"tw-h-px","tw-w-full","tw-bg-secondary-300"]],template:function(e,t){1&e&&(u._UZ(0,"div",0),u._uU(1,"\n"))},encapsulation:2});var ge=n(82933);function ve(e,t){1&e&&u._UZ(0,"i",5)}function fe(e,t){1&e&&u._UZ(0,"i",9)}const me=function(e,t){return[e,t]},we=function(e){return["../",e]};function Ue(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-nav-item",7),u.NdJ("mainContentClicked",(function(){u.CHM(e);const t=u.oxw(3);return u.KtG(t.toggle())})),u.ALo(1,"i18n"),u._uU(2,"\n      "),u.YNc(3,fe,1,0,"i",8),u._uU(4,"\n    "),u.qZA()}if(2&e){const e=t.$implicit;u.Q6J("text",e.name)("ariaLabel",u.WLB(7,me,u.lcZ(1,5,"organization"),e.name).join(" "))("route",u.VKq(10,we,e.id))("hideActiveStyles",!0),u.xp6(3),u.Q6J("ngIf",0==e.enabled)}}function Ae(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n    "),u.YNc(2,Ue,5,12,"bit-nav-item",6),u._uU(3,"\n  "),u.BQk()),2&e){const e=t.ngIf;u.xp6(2),u.Q6J("ngForOf",e)}}function _e(e,t){1&e&&(u._UZ(0,"bit-nav-item",10),u.ALo(1,"i18n")),2&e&&u.Q6J("text",u.lcZ(1,1,"newOrganization"))}function be(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-nav-group",1),u.NdJ("openChange",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.open=t)})),u.ALo(1,"i18n"),u._uU(2,"\n  "),u.YNc(3,ve,1,0,"i",2),u._uU(4,"\n  "),u.YNc(5,Ae,4,1,"ng-container",3),u.ALo(6,"async"),u._uU(7,"\n  "),u.YNc(8,_e,2,3,"bit-nav-item",4),u._uU(9,"\n  "),u._UZ(10,"bit-nav-divider"),u._uU(11,"\n"),u.qZA()}if(2&e){const e=t.ngIf,n=u.oxw();u.Q6J("text",e.name)("ariaLabel",u.WLB(12,me,u.lcZ(1,8,"organization"),e.name).join(" "))("route",u.VKq(15,we,e.id))("open",n.open)("exactMatch",!0),u.xp6(3),u.Q6J("ngIf",!e.enabled),u.xp6(2),u.Q6J("ngIf",u.lcZ(6,10,n.organizations$)),u.xp6(3),u.Q6J("ngIf",!n.hideNewButton)}}class ye{constructor(e,t){this.route=e,this.organizationService=t,this.organizations$=this.organizationService.organizations$.pipe((0,D.U)((e=>e.filter((e=>this.filter(e))).sort(((e,t)=>e.name.localeCompare(t.name))).sort(((e,t)=>e.enabled?-1:1))))),this.activeOrganization$=(0,pe.a)([this.route.paramMap,this.organizations$]).pipe((0,D.U)((([e,t])=>t.find((t=>t.id===e.get("organizationId")))))),this.filter=()=>!0,this.open=!1,this.openChange=new u.vpe,this.hideNewButton=!1}toggle(e){null==e||e.stopPropagation(),this.open=!this.open,this.openChange.emit(this.open)}}function Ze(e,t){1&e&&(u._UZ(0,"bit-nav-item",8),u.ALo(1,"i18n")),2&e&&u.Q6J("text",u.lcZ(1,1,"trash"))}function xe(e,t){1&e&&(u.TgZ(0,"bit-nav-group",9),u.ALo(1,"i18n"),u._uU(2,"\n    "),u._UZ(3,"bit-nav-item",10),u.ALo(4,"i18n"),u._uU(5,"\n    "),u._UZ(6,"bit-nav-item",11),u.ALo(7,"i18n"),u._uU(8,"\n  "),u.qZA()),2&e&&(u.Q6J("text",u.lcZ(1,3,"settings")),u.xp6(3),u.Q6J("text",u.lcZ(4,5,"importData")),u.xp6(3),u.Q6J("text",u.lcZ(7,7,"exportData")))}ye.ɵfac=function(e){return new(e||ye)(u.Y36(c.gz),u.Y36(j.Mn))},ye.ɵcmp=u.Xpm({type:ye,selectors:[["org-switcher"]],inputs:{filter:"filter",open:"open",hideNewButton:"hideNewButton"},outputs:{openChange:"openChange"},decls:3,vars:3,consts:[["icon","bwi-business",3,"text","ariaLabel","route","open","exactMatch","openChange",4,"ngIf"],["icon","bwi-business",3,"text","ariaLabel","route","open","exactMatch","openChange"],["slot","end","class","bwi bwi-exclamation-triangle tw-my-auto !tw-text-danger",4,"ngIf"],[4,"ngIf"],["icon","bwi-plus","route","/create-organization",3,"text",4,"ngIf"],["slot","end",1,"bwi","bwi-exclamation-triangle","tw-my-auto","!tw-text-danger"],[3,"text","ariaLabel","route","hideActiveStyles","mainContentClicked",4,"ngFor","ngForOf"],[3,"text","ariaLabel","route","hideActiveStyles","mainContentClicked"],["slot","end","class","bwi bwi-exclamation-triangle !tw-text-danger",4,"ngIf"],["slot","end",1,"bwi","bwi-exclamation-triangle","!tw-text-danger"],["icon","bwi-plus","route","/create-organization",3,"text"]],template:function(e,t){1&e&&(u.YNc(0,be,12,17,"bit-nav-group",0),u.ALo(1,"async"),u._uU(2,"\n")),2&e&&u.Q6J("ngIf",u.lcZ(1,1,t.activeOrganization$))},dependencies:[s.sg,s.O5,he,de,ne,s.Ov,ge.C],encapsulation:2});class Se{constructor(e,t){this.route=e,this.organizationService=t,this.logo=E.s,this.orgFilter=e=>e.canAccessSecretsManager,this.isAdmin$=this.route.params.pipe((0,D.U)((e=>{var t;return null===(t=this.organizationService.get(e.organizationId))||void 0===t?void 0:t.isAdmin})))}}Se.ɵfac=function(e){return new(e||Se)(u.Y36(c.gz),u.Y36(j.Mn))},Se.ɵcmp=u.Xpm({type:Se,selectors:[["sm-navigation"]],decls:25,vars:18,consts:[["routerLink",".",1,"tw-m-5","tw-mt-7","tw-block"],[3,"icon"],[3,"filter","hideNewButton"],["icon","bwi-collection","route","projects",3,"text"],["icon","bwi-key","route","secrets",3,"text"],["icon","bwi-wrench","route","service-accounts",3,"text"],["icon","bwi-trash","route","trash",3,"text",4,"ngIf"],["icon","bwi-cog",3,"text",4,"ngIf"],["icon","bwi-trash","route","trash",3,"text"],["icon","bwi-cog",3,"text"],["route","settings/import",3,"text"],["route","settings/export",3,"text"]],template:function(e,t){1&e&&(u.TgZ(0,"nav"),u._uU(1,"\n  "),u.TgZ(2,"a",0),u._uU(3,"\n    "),u._UZ(4,"bit-icon",1),u._uU(5,"\n  "),u.qZA(),u._uU(6,"\n\n  "),u._UZ(7,"org-switcher",2),u._uU(8,"\n  "),u._UZ(9,"bit-nav-item",3),u.ALo(10,"i18n"),u._uU(11,"\n  "),u._UZ(12,"bit-nav-item",4),u.ALo(13,"i18n"),u._uU(14,"\n  "),u._UZ(15,"bit-nav-item",5),u.ALo(16,"i18n"),u._uU(17,"\n  "),u.YNc(18,Ze,2,3,"bit-nav-item",6),u.ALo(19,"async"),u._uU(20,"\n  "),u.YNc(21,xe,9,9,"bit-nav-group",7),u.ALo(22,"async"),u._uU(23,"\n"),u.qZA(),u._uU(24,"\n")),2&e&&(u.xp6(4),u.Q6J("icon",t.logo),u.xp6(3),u.Q6J("filter",t.orgFilter)("hideNewButton",!0),u.xp6(2),u.Q6J("text",u.lcZ(10,8,"projects")),u.xp6(3),u.Q6J("text",u.lcZ(13,10,"secrets")),u.xp6(3),u.Q6J("text",u.lcZ(16,12,"serviceAccounts")),u.xp6(3),u.Q6J("ngIf",u.lcZ(19,14,t.isAdmin$)),u.xp6(3),u.Q6J("ngIf",u.lcZ(22,16,t.isAdmin$)))},dependencies:[s.O5,c.rH,z.G,de,ne,ye,s.Ov,ge.C],encapsulation:2});var Te=n(51676);class Ie{}Ie.ɵfac=function(e){return new(e||Ie)},Ie.ɵmod=u.oAB({type:Ie}),Ie.ɵinj=u.cJS({imports:[i.m,Te.q]});var Pe=n(54019),qe=n(72591),je=n(68362),ke=n(53634),Ce=n(30359),Le=n(12294),Oe=n(2097),Ne=n(65017),Je=n(98645),De=n(81974),Ee=n(29465),ze=n(18362),Ye=n(54735),Ge=n(50941),Me=n(26361);function Qe(e,t){if(1&e&&(u.TgZ(0,"tr",10),u._uU(1,"\n          "),u.TgZ(2,"td",5),u._uU(3),u.qZA(),u._uU(4,"\n          "),u.TgZ(5,"td",5),u._uU(6),u.qZA(),u._uU(7,"\n        "),u.qZA()),2&e){const e=t.$implicit;u.xp6(3),u.Oqu(e.name),u.xp6(3),u.Oqu(e.errorMessage)}}function Re(e,t){if(1&e&&(u._uU(0,"\n        "),u.YNc(1,Qe,8,2,"tr",9),u._uU(2,"\n      ")),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.data.details)}}class Be{}class Fe{constructor(e,t){this.dialogRef=e,this.data=t}ngOnInit(){var e;if(!(this.data.title&&this.data.subTitle&&this.data.columnTitle&&this.data.message&&(null===(e=this.data.details)||void 0===e?void 0:e.length)>=1))throw this.dialogRef.close(),new Error("The bulk status dialog was not called with the appropriate operation values.")}}Fe.ɵfac=function(e){return new(e||Fe)(u.Y36(Ne.zj),u.Y36(Ne.Kt))},Fe.ɵcmp=u.Xpm({type:Fe,selectors:[["ng-component"]],decls:44,vars:19,consts:[["dialogSize","default"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["header",""],["bitCell",""],["body",""],["bitDialogFooter",""],["bitButton","","buttonType","primary","bitDialogClose","","type","button"],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""]],template:function(e,t){1&e&&(u.TgZ(0,"bit-dialog",0),u._uU(1,"\n  "),u.ynx(2,1),u._uU(3,"\n    "),u.TgZ(4,"span"),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n    "),u.TgZ(8,"span",2),u._uU(9),u.ALo(10,"i18n"),u.qZA(),u._uU(11,"\n  "),u.BQk(),u._uU(12,"\n\n  "),u.TgZ(13,"div",3),u._uU(14),u.ALo(15,"i18n"),u.TgZ(16,"bit-table"),u._uU(17,"\n      "),u.ynx(18,4),u._uU(19,"\n        "),u.TgZ(20,"tr"),u._uU(21,"\n          "),u.TgZ(22,"th",5),u._uU(23),u.ALo(24,"i18n"),u.qZA(),u._uU(25,"\n          "),u.TgZ(26,"th",5),u._uU(27),u.ALo(28,"i18n"),u.qZA(),u._uU(29,"\n        "),u.qZA(),u._uU(30,"\n      "),u.BQk(),u._uU(31,"\n      "),u.YNc(32,Re,3,1,"ng-template",6),u._uU(33,"\n    "),u.qZA(),u._uU(34,"\n  "),u.qZA(),u._uU(35,"\n\n  "),u.ynx(36,7),u._uU(37,"\n    "),u.TgZ(38,"button",8),u._uU(39),u.ALo(40,"i18n"),u.qZA(),u._uU(41,"\n  "),u.BQk(),u._uU(42,"\n"),u.qZA(),u._uU(43,"\n")),2&e&&(u.xp6(5),u.Oqu(u.lcZ(6,7,t.data.title)),u.xp6(4),u.AsE("\n      ",t.data.details.length,"\n      ",u.lcZ(10,9,t.data.subTitle),"\n    "),u.xp6(5),u.hij("\n    ",u.lcZ(15,11,t.data.message),"\n    "),u.xp6(9),u.Oqu(u.lcZ(24,13,t.data.columnTitle)),u.xp6(4),u.Oqu(u.lcZ(28,15,"error")),u.xp6(12),u.hij("\n      ",u.lcZ(40,17,"close"),"\n    "))},dependencies:[s.sg,De.r,Ee.a,ze.f,Ye.a,Ge.Y,Me.v,Ye.f,ge.C],encapsulation:2});var $e=n(42844),Ve=n(70427);class Ke{}class He{}class We{}var Xe=n(58043);class et extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.organizationId=this.getResponseProperty("OrganizationId"),this.name=this.getResponseProperty("Name"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate"),this.read=this.getResponseProperty("Read"),this.write=this.getResponseProperty("Write")}}class tt extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.organizationId=this.getResponseProperty("OrganizationId"),this.name=this.getResponseProperty("Name"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate"),this.read=this.getResponseProperty("Read"),this.write=this.getResponseProperty("Write")}}var nt=n(76528),it=n(55602),ot=n(85540),st=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class ct{constructor(e,t,n){this.cryptoService=e,this.apiService=t,this.encryptService=n,this._project=new Pe.x,this.project$=this._project.asObservable()}getByProjectId(e){return st(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/projects/"+e,null,!0,!0),n=new tt(t);return yield this.createProjectView(n)}))}getProjects(e){return st(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/organizations/"+e+"/projects",null,!0,!0),n=new $e.L(t,et);return yield this.createProjectsListView(e,n.data)}))}create(e,t){return st(this,void 0,void 0,(function*(){const n=yield this.getProjectRequest(e,t),i=yield this.apiService.send("POST","/organizations/"+e+"/projects",n,!0,!0),o=yield this.createProjectView(new tt(i));return this._project.next(o),o}))}update(e,t){return st(this,void 0,void 0,(function*(){const n=yield this.getProjectRequest(e,t),i=yield this.apiService.send("PUT","/projects/"+t.id,n,!0,!0);this._project.next(yield this.createProjectView(new tt(i)))}))}delete(e){return st(this,void 0,void 0,(function*(){const t=e.map((e=>e.id)),n=yield this.apiService.send("POST","/projects/delete",t,!0,!0);return this._project.next(null),n.data.map((t=>{const n=new Be;return n.id=t.id,n.name=e.find((e=>e.id==t.id)).name,n.errorMessage=t.error,n}))}))}getOrganizationKey(e){return st(this,void 0,void 0,(function*(){return yield this.cryptoService.getOrgKey(e)}))}getProjectRequest(e,t){return st(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e),i=new We;return i.name=yield this.encryptService.encrypt(t.name,n),i}))}createProjectView(e){return st(this,void 0,void 0,(function*(){const t=yield this.getOrganizationKey(e.organizationId),n=new He;return n.id=e.id,n.organizationId=e.organizationId,n.creationDate=e.creationDate,n.revisionDate=e.revisionDate,n.read=e.read,n.write=e.write,n.name=yield this.encryptService.decryptToUtf8(new Ve._(e.name),t),n}))}createProjectsListView(e,t){return st(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e);return yield Promise.all(t.map((e=>st(this,void 0,void 0,(function*(){const t=new Ke;return t.id=e.id,t.organizationId=e.organizationId,t.read=e.read,t.write=e.write,t.name=yield this.encryptService.decryptToUtf8(new Ve._(e.name),n),t.creationDate=e.creationDate,t.revisionDate=e.revisionDate,t})))))}))}}ct.ɵfac=function(e){return new(e||ct)(u.LFG(nt.$),u.LFG(it.s),u.LFG(ot.U))},ct.ɵprov=u.Yz7({token:ct,factory:ct.ɵfac,providedIn:"root"});var rt=n(78627),at=n(99721),ut=n(73369),lt=n(46246),dt=n(36338),pt=n(24083),ht=n(24637),gt=n(11512),vt=n(36179),ft=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function mt(e,t){if(1&e&&(u.ynx(0),u._uU(1),u.BQk()),2&e){const e=u.oxw();u.xp6(1),u.hij("\n          ",e.data.projects[0].name,"\n        ")}}function wt(e,t){if(1&e&&(u.ynx(0),u._uU(1),u.ALo(2,"i18n"),u.BQk()),2&e){const e=u.oxw();u.xp6(1),u.AsE("\n          ",e.data.projects.length,"\n          ",u.lcZ(2,2,"projects"),"\n        ")}}class Ut{constructor(e,t,n,i,o,s){this.dialogRef=e,this.data=t,this.projectService=n,this.i18nService=i,this.platformUtilsService=o,this.dialogService=s,this.formGroup=new Je.cw({confirmDelete:new Je.NI("",[this.matchConfirmationMessageValidator()])}),this.submit=()=>ft(this,void 0,void 0,(function*(){this.formGroup.markAllAsTouched(),this.formGroup.invalid||(yield this.delete(),this.dialogRef.close())}))}ngOnInit(){var e;if(!((null===(e=this.data.projects)||void 0===e?void 0:e.length)>=1))throw this.dialogRef.close(),new Error("The project delete dialog was not called with the appropriate operation values.")}get title(){return 1===this.data.projects.length?"deleteProject":"deleteProjects"}get dialogContent(){return 1===this.data.projects.length?this.i18nService.t("deleteProjectDialogMessage",this.data.projects[0].name):this.i18nService.t("deleteProjectsDialogMessage")}get dialogConfirmationLabel(){return this.i18nService.t("deleteProjectInputLabel",this.dialogConfirmationMessage)}delete(){return ft(this,void 0,void 0,(function*(){const e=yield this.projectService.delete(this.data.projects);if(e.find((e=>e.errorMessage)))return void this.openBulkStatusDialog(e.filter((e=>e.errorMessage)));const t=1===this.data.projects.length?"deleteProjectToast":"deleteProjectsToast";this.platformUtilsService.showToast("success",null,this.i18nService.t(t))}))}openBulkStatusDialog(e){this.dialogService.open(Fe,{data:{title:"deleteProjects",subTitle:"projects",columnTitle:"projectName",message:"bulkDeleteProjectsErrorMessage",details:e}})}get dialogConfirmationMessage(){var e,t;return 1===(null===(e=this.data.projects)||void 0===e?void 0:e.length)?this.i18nService.t("deleteProjectConfirmMessage",this.data.projects[0].name):this.i18nService.t("deleteProjectsConfirmMessage",null===(t=this.data.projects)||void 0===t?void 0:t.length.toString())}matchConfirmationMessageValidator(){return e=>this.dialogConfirmationMessage.toLowerCase()==e.value.toLowerCase()?null:{confirmationDoesntMatchError:{message:this.i18nService.t("smConfirmationRequired")}}}}Ut.ɵfac=function(e){return new(e||Ut)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(ct),u.Y36(rt.D),u.Y36(at.P),u.Y36(ut.x))},Ut.ɵcmp=u.Xpm({type:Ut,selectors:[["ng-component"]],decls:46,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","default"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],[4,"ngIf"],["bitDialogContent",""],["type","warning",3,"title"],["bitInput","","formControlName","confirmDelete"],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","danger","bitFormButton",""],["type","button","bitButton","","buttonType","secondary","bitFormButton","","bitDialogClose",""]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-dialog",1),u._uU(3,"\n    "),u.ynx(4,2),u._uU(5,"\n      "),u.TgZ(6,"span"),u._uU(7),u.ALo(8,"i18n"),u.qZA(),u._uU(9,"\n      "),u.TgZ(10,"span",3),u._uU(11,"\n        "),u.YNc(12,mt,2,1,"ng-container",4),u._uU(13,"\n        "),u.YNc(14,wt,3,4,"ng-container",4),u._uU(15,"\n      "),u.qZA(),u._uU(16,"\n    "),u.BQk(),u._uU(17,"\n\n    "),u.TgZ(18,"div",5),u._uU(19,"\n      "),u.TgZ(20,"bit-callout",6),u.ALo(21,"i18n"),u._uU(22),u.qZA(),u._uU(23,"\n      "),u.TgZ(24,"bit-form-field"),u._uU(25,"\n        "),u.TgZ(26,"bit-label"),u._uU(27),u.qZA(),u._uU(28,"\n        "),u._UZ(29,"input",7),u._uU(30,"\n      "),u.qZA(),u._uU(31,"\n    "),u.qZA(),u._uU(32,"\n\n    "),u.ynx(33,8),u._uU(34,"\n      "),u.TgZ(35,"button",9),u._uU(36),u.ALo(37,"i18n"),u.qZA(),u._uU(38,"\n      "),u.TgZ(39,"button",10),u._uU(40),u.ALo(41,"i18n"),u.qZA(),u._uU(42,"\n    "),u.BQk(),u._uU(43,"\n  "),u.qZA(),u._uU(44,"\n"),u.qZA(),u._uU(45,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(7),u.Oqu(u.lcZ(8,10,t.title)),u.xp6(5),u.Q6J("ngIf",1==t.data.projects.length),u.xp6(2),u.Q6J("ngIf",t.data.projects.length>1),u.xp6(6),u.Q6J("title",u.lcZ(21,12,"warning")),u.xp6(2),u.hij("\n        ",t.dialogContent,"\n      "),u.xp6(5),u.Oqu(t.dialogConfirmationLabel),u.xp6(9),u.hij("\n        ",u.lcZ(37,14,t.title),"\n      "),u.xp6(4),u.hij("\n        ",u.lcZ(41,16,"cancel"),"\n      "))},dependencies:[s.O5,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,lt.b,dt.u,De.r,pt.O,Ee.a,ze.f,ht.d,gt.G,vt.u,ge.C],encapsulation:2});const At=e=>{if(!(e instanceof Je.NI))throw new Error("trimValidator only supports validating FormControls");const t=e.value;return null==t||""===t?null:t.trim().length?(t!==t.trim()&&e.setValue(t.trim()),null):{trim:{message:"input is only whitespace"}}};var _t,bt=n(62374),yt=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function Zt(e,t){1&e&&(u.TgZ(0,"div",9),u._uU(1,"\n        "),u._UZ(2,"i",10),u._uU(3,"\n      "),u.qZA())}function xt(e,t){1&e&&(u.TgZ(0,"bit-form-field"),u._uU(1,"\n        "),u.TgZ(2,"bit-label"),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n        "),u._UZ(6,"input",11),u._uU(7,"\n      "),u.qZA()),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,1,"projectName")))}!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit"}(_t||(_t={}));class St{constructor(e,t,n,i,o,s){this.dialogRef=e,this.data=t,this.projectService=n,this.i18nService=i,this.platformUtilsService=o,this.router=s,this.formGroup=new Je.cw({name:new Je.NI("",{validators:[Je.kI.required,Je.kI.maxLength(500),At],updateOn:"submit"})}),this.loading=!1,this.submit=()=>yt(this,void 0,void 0,(function*(){if(!this.data.organizationEnabled)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("projectsCannotCreate"));if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const e=this.getProjectView();if(this.data.operation===_t.Add){const t=yield this.createProject(e);this.router.navigate(["sm",this.data.organizationId,"projects",t.id])}else e.id=this.data.projectId,yield this.updateProject(e);this.dialogRef.close()}))}ngOnInit(){return yt(this,void 0,void 0,(function*(){if(this.data.operation===_t.Edit&&this.data.projectId)yield this.loadData();else if(this.data.operation!==_t.Add)throw this.dialogRef.close(),new Error("The project dialog was not called with the appropriate operation values.")}))}loadData(){return yt(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.projectService.getByProjectId(this.data.projectId);this.loading=!1,this.formGroup.setValue({name:e.name})}))}get title(){return this.data.operation===_t.Add?"newProject":"editProject"}createProject(e){return yt(this,void 0,void 0,(function*(){const t=yield this.projectService.create(this.data.organizationId,e);return this.platformUtilsService.showToast("success",null,this.i18nService.t("projectCreated")),t}))}updateProject(e){return yt(this,void 0,void 0,(function*(){yield this.projectService.update(this.data.organizationId,e),this.platformUtilsService.showToast("success",null,this.i18nService.t("projectSaved"))}))}getProjectView(){const e=new He;return e.organizationId=this.data.organizationId,e.name=this.formGroup.value.name,e}}St.ɵfac=function(e){return new(e||St)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(ct),u.Y36(rt.D),u.Y36(at.P),u.Y36(c.F0))},St.ɵcmp=u.Xpm({type:St,selectors:[["ng-component"]],decls:28,vars:13,consts:[[3,"formGroup","bitSubmit"],["dialogSize","default"],["bitDialogTitle",""],["bitDialogContent",""],["class","tw-text-center",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["type","button","bitButton","","buttonType","secondary","bitFormButton","","bitDialogClose",""],[1,"tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["appAutofocus","","formControlName","name","bitInput",""]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-dialog",1),u._uU(3,"\n    "),u.TgZ(4,"span",2),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n    "),u.TgZ(8,"span",3),u._uU(9,"\n      "),u.YNc(10,Zt,4,0,"div",4),u._uU(11,"\n      "),u.YNc(12,xt,8,3,"bit-form-field",5),u._uU(13,"\n    "),u.qZA(),u._uU(14,"\n    "),u.ynx(15,6),u._uU(16,"\n      "),u.TgZ(17,"button",7),u._uU(18),u.ALo(19,"i18n"),u.qZA(),u._uU(20,"\n      "),u.TgZ(21,"button",8),u._uU(22),u.ALo(23,"i18n"),u.qZA(),u._uU(24,"\n    "),u.BQk(),u._uU(25,"\n  "),u.qZA(),u._uU(26,"\n"),u.qZA(),u._uU(27,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(5),u.Oqu(u.lcZ(6,7,t.title)),u.xp6(5),u.Q6J("ngIf",t.loading),u.xp6(2),u.Q6J("ngIf",!t.loading),u.xp6(6),u.hij("\n        ",u.lcZ(19,9,"save"),"\n      "),u.xp6(4),u.hij("\n        ",u.lcZ(23,11,"cancel"),"\n      "))},dependencies:[s.O5,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,bt.U,lt.b,dt.u,De.r,Ee.a,ze.f,ht.d,gt.G,vt.u,ge.C],encapsulation:2});class Tt{}class It{}class Pt{}class qt{}class jt extends Xe.c{constructor(e){super(e),this.name=this.getResponseProperty("Name"),this.id=this.getResponseProperty("Id")}}class kt extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.organizationId=this.getResponseProperty("OrganizationId"),this.name=this.getResponseProperty("Key"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate"),this.read=this.getResponseProperty("Read"),this.write=this.getResponseProperty("Write");const t=this.getResponseProperty("projects");this.projects=null==t?null:t.map((e=>new jt(e)))}}class Ct extends Xe.c{constructor(e){super(e);const t=this.getResponseProperty("secrets"),n=this.getResponseProperty("projects");this.projects=null==n?null:n.map((e=>new jt(e))),this.secrets=null==t?[]:t.map((e=>new kt(e)))}}class Lt extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.organizationId=this.getResponseProperty("OrganizationId"),this.name=this.getResponseProperty("Key"),this.value=this.getResponseProperty("Value"),this.note=this.getResponseProperty("Note"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate"),this.read=this.getResponseProperty("Read"),this.write=this.getResponseProperty("Write");const t=this.getResponseProperty("Projects");this.projects=null==t?null:t.map((e=>new jt(e)))}}var Ot=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Nt{constructor(e,t,n){this.cryptoService=e,this.apiService=t,this.encryptService=n,this._secret=new Pe.x,this.secret$=this._secret.asObservable()}getBySecretId(e){return Ot(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/secrets/"+e,null,!0,!0),n=new Lt(t);return yield this.createSecretView(n)}))}getSecrets(e){return Ot(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/organizations/"+e+"/secrets",null,!0,!0),n=new Ct(t);return yield this.createSecretsListView(e,n)}))}getSecretsByProject(e,t){return Ot(this,void 0,void 0,(function*(){const n=yield this.apiService.send("GET","/projects/"+t+"/secrets",null,!0,!0),i=new Ct(n);return yield this.createSecretsListView(e,i)}))}create(e,t){return Ot(this,void 0,void 0,(function*(){const n=yield this.getSecretRequest(e,t),i=yield this.apiService.send("POST","/organizations/"+e+"/secrets",n,!0,!0);this._secret.next(yield this.createSecretView(new Lt(i)))}))}update(e,t){return Ot(this,void 0,void 0,(function*(){const n=yield this.getSecretRequest(e,t),i=yield this.apiService.send("PUT","/secrets/"+t.id,n,!0,!0);this._secret.next(yield this.createSecretView(new Lt(i)))}))}delete(e){return Ot(this,void 0,void 0,(function*(){const t=e.map((e=>e.id)),n=yield this.apiService.send("POST","/secrets/delete",t,!0,!0);return this._secret.next(null),n.data.map((t=>{const n=new Be;return n.id=t.id,n.name=e.find((e=>e.id==t.id)).name,n.errorMessage=t.error,n}))}))}getTrashedSecrets(e){return Ot(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/secrets/"+e+"/trash",null,!0,!0);return yield this.createSecretsListView(e,new Ct(t))}))}deleteTrashed(e,t){return Ot(this,void 0,void 0,(function*(){yield this.apiService.send("POST","/secrets/"+e+"/trash/empty",t,!0,!0),this._secret.next(null)}))}restoreTrashed(e,t){return Ot(this,void 0,void 0,(function*(){yield this.apiService.send("POST","/secrets/"+e+"/trash/restore",t,!0,!0),this._secret.next(null)}))}getOrganizationKey(e){return Ot(this,void 0,void 0,(function*(){return yield this.cryptoService.getOrgKey(e)}))}getSecretRequest(e,t){var n;return Ot(this,void 0,void 0,(function*(){const i=yield this.getOrganizationKey(e),o=new qt,[s,c,r]=yield Promise.all([this.encryptService.encrypt(t.name,i),this.encryptService.encrypt(t.value,i),this.encryptService.encrypt(t.note,i)]);return o.key=s.encryptedString,o.value=c.encryptedString,o.note=r.encryptedString,o.projectIds=[],null===(n=t.projects)||void 0===n||n.forEach((e=>o.projectIds.push(e.id))),o}))}createSecretView(e){return Ot(this,void 0,void 0,(function*(){const t=yield this.getOrganizationKey(e.organizationId),n=new Pt;n.id=e.id,n.organizationId=e.organizationId,n.creationDate=e.creationDate,n.revisionDate=e.revisionDate;const[i,o,s]=yield Promise.all([this.encryptService.decryptToUtf8(new Ve._(e.name),t),this.encryptService.decryptToUtf8(new Ve._(e.value),t),this.encryptService.decryptToUtf8(new Ve._(e.note),t)]);return n.name=i,n.value=o,n.note=s,n.read=e.read,n.write=e.write,null!=e.projects&&(n.projects=yield this.decryptProjectsMappedToSecrets(t,e.projects)),n}))}createSecretsListView(e,t){return Ot(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e),i=yield this.decryptProjectsMappedToSecrets(n,t.projects);return yield Promise.all(t.secrets.map((e=>Ot(this,void 0,void 0,(function*(){var t;const o=new Tt;o.id=e.id,o.organizationId=e.organizationId,o.name=yield this.encryptService.decryptToUtf8(new Ve._(e.name),n),o.creationDate=e.creationDate,o.revisionDate=e.revisionDate;const s=null===(t=e.projects)||void 0===t?void 0:t.map((e=>e.id));return o.projects=i.filter((e=>s.includes(e.id))),o.read=e.read,o.write=e.write,o})))))}))}decryptProjectsMappedToSecrets(e,t){return Ot(this,void 0,void 0,(function*(){return yield Promise.all(t.map((t=>Ot(this,void 0,void 0,(function*(){const n=new It;return n.id=t.id,n.name=t.name?yield this.encryptService.decryptToUtf8(new Ve._(t.name),e):null,n})))))}))}}Nt.ɵfac=function(e){return new(e||Nt)(u.LFG(nt.$),u.LFG(it.s),u.LFG(ot.U))},Nt.ɵprov=u.Yz7({token:Nt,factory:Nt.ɵfac,providedIn:"root"});var Jt=n(98205),Dt=n(70094),Et=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function zt(e,t){1&e&&(u.TgZ(0,"div"),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.hij("\n      ",u.lcZ(2,1,"softDeleteSecretWarning"),"\n    "))}class Yt{constructor(e,t,n,i,o,s){this.dialogRef=e,this.secretService=t,this.i18nService=n,this.platformUtilsService=i,this.data=o,this.dialogService=s,this.showSoftDeleteSecretWarning=1===this.data.secrets.length,this.delete=()=>Et(this,void 0,void 0,(function*(){const e=yield this.secretService.delete(this.data.secrets);if(e.find((e=>e.errorMessage)))return this.openBulkStatusDialog(e.filter((e=>e.errorMessage))),void this.dialogRef.close(!0);const t=1===this.data.secrets.length?"softDeleteSuccessToast":"softDeletesSuccessToast";this.platformUtilsService.showToast("success",null,this.i18nService.t(t)),this.dialogRef.close(!0)}))}get title(){return 1===this.data.secrets.length?"deleteSecret":"deleteSecrets"}get submitButtonText(){return 1===this.data.secrets.length?"deleteSecret":"deleteSecrets"}openBulkStatusDialog(e){this.dialogService.open(Fe,{data:{title:"deleteSecrets",subTitle:"secrets",columnTitle:"name",message:"bulkDeleteSecretsErrorMessage",details:e}})}}Yt.ɵfac=function(e){return new(e||Yt)(u.Y36(Ne.zj),u.Y36(Nt),u.Y36(rt.D),u.Y36(at.P),u.Y36(Ne.Kt),u.Y36(ut.x))},Yt.ɵcmp=u.Xpm({type:Yt,selectors:[["ng-component"]],decls:24,vars:14,consts:[["bitDialogTitle",""],["bitDialogContent",""],[4,"ngIf"],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"bitAction"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""]],template:function(e,t){1&e&&(u.TgZ(0,"bit-simple-dialog"),u._uU(1,"\n  "),u.TgZ(2,"span",0),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"span",1),u._uU(7,"\n    "),u.YNc(8,zt,3,3,"div",2),u._uU(9),u.ALo(10,"i18n"),u.qZA(),u._uU(11,"\n  "),u.ynx(12,3),u._uU(13,"\n    "),u.TgZ(14,"button",4),u._uU(15),u.ALo(16,"i18n"),u.qZA(),u._uU(17,"\n    "),u.TgZ(18,"button",5),u._uU(19),u.ALo(20,"i18n"),u.qZA(),u._uU(21,"\n  "),u.BQk(),u._uU(22,"\n"),u.qZA(),u._uU(23,"\n")),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,6,t.title)),u.xp6(5),u.Q6J("ngIf",t.showSoftDeleteSecretWarning),u.xp6(1),u.hij("\n    ",u.lcZ(10,8,"deleteItemConfirmation"),"\n  "),u.xp6(5),u.Q6J("bitAction",t.delete),u.xp6(1),u.hij("\n      ",u.lcZ(16,10,t.submitButtonText),"\n    "),u.xp6(4),u.hij("\n      ",u.lcZ(20,12,"close"),"\n    "))},dependencies:[s.O5,Jt.Q,De.r,Dt.r,ze.f,ge.C],encapsulation:2});var Gt,Mt=n(70032),Qt=n(27646),Rt=n(28975),Bt=n(30469),Ft=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function $t(e,t){1&e&&(u.TgZ(0,"div",21),u._uU(1,"\n        "),u._UZ(2,"i",22),u._uU(3,"\n      "),u.qZA())}function Vt(e,t){if(1&e&&(u.TgZ(0,"bit-option",23),u._uU(1,"\n          "),u.qZA()),2&e){const e=t.$implicit,n=u.oxw();u.Q6J("icon",e.id===n.newProjectGuid?"bwi-plus-circle":"")("value",e.id)("label",e.name)}}function Kt(e,t){1&e&&(u.TgZ(0,"bit-form-field"),u._uU(1,"\n        "),u.TgZ(2,"bit-label"),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n        "),u._UZ(6,"input",24),u._uU(7,"\n      "),u.qZA()),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,1,"projectName")))}function Ht(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",25),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.openDeleteSecretDialog())})),u.qZA()}}!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit"}(Gt||(Gt={}));class Wt{constructor(e,t,n,i,o,s,c,r){this.dialogRef=e,this.data=t,this.secretService=n,this.i18nService=i,this.platformUtilsService=o,this.projectService=s,this.dialogService=c,this.organizationService=r,this.formGroup=new Je.cw({name:new Je.NI("",{validators:[Je.kI.required,Je.kI.maxLength(500),At],updateOn:"submit"}),value:new Je.NI("",[Je.kI.required,Je.kI.maxLength(25e3)]),notes:new Je.NI("",{validators:[Je.kI.maxLength(7e3),At],updateOn:"submit"}),project:new Je.NI("",[Je.kI.required]),newProjectName:new Je.NI("",{validators:[Je.kI.maxLength(500),At],updateOn:"submit"})}),this.destroy$=new Pe.x,this.loading=!0,this.addNewProject=!1,this.newProjectGuid=Qt.c.newGuid(),this.submit=()=>Ft(this,void 0,void 0,(function*(){if(!this.data.organizationEnabled)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("secretsCannotCreate"));if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const e=this.getSecretView();if(this.addNewProject){const t=yield this.createProject(this.getNewProjectView());e.projects=[t]}this.data.operation===Gt.Add?yield this.createSecret(e):(e.id=this.data.secretId,yield this.updateSecret(e)),this.dialogRef.close()}))}ngOnInit(){var e;return Ft(this,void 0,void 0,(function*(){if(this.data.operation===Gt.Edit&&this.data.secretId)yield this.loadData();else{if(this.data.operation!==Gt.Add)throw this.dialogRef.close(),new Error("The secret dialog was not called with the appropriate operation values.");this.data.operation==Gt.Add&&(yield this.loadProjects(!0),null!=this.data.projectId&&""!=this.data.projectId||this.addNewProjectOptionToProjectsDropDown())}this.data.projectId&&this.formGroup.get("project").setValue(this.data.projectId),(null===(e=this.organizationService.get(this.data.organizationId))||void 0===e?void 0:e.isAdmin)&&(this.formGroup.get("project").removeValidators(Je.kI.required),this.formGroup.get("project").updateValueAndValidity())}))}loadData(){var e,t;return Ft(this,void 0,void 0,(function*(){this.formGroup.disable();const n=yield this.secretService.getBySecretId(this.data.secretId);yield this.loadProjects(n.write),this.formGroup.setValue({name:n.name,value:n.value,notes:n.note,project:null!==(t=null===(e=n.projects[0])||void 0===e?void 0:e.id)&&void 0!==t?t:"",newProjectName:""}),this.loading=!1,n.write&&this.formGroup.enable()}))}loadProjects(e){return Ft(this,void 0,void 0,(function*(){this.projects=yield this.projectService.getProjects(this.data.organizationId).then((e=>e.sort(((e,t)=>e.name.localeCompare(t.name))))),e&&(this.projects=this.projects.filter((e=>e.write)))}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}addNewProjectOptionToProjectsDropDown(){this.formGroup.get("project").valueChanges.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.dropDownSelected(e)}));const e=new Ke;e.name=this.i18nService.t("newProject"),e.id=this.newProjectGuid,this.projects.unshift(e)}dropDownSelected(e){this.addNewProject=e==this.newProjectGuid,this.addNewProject?this.formGroup.get("newProjectName").addValidators([Je.kI.required]):this.formGroup.get("newProjectName").clearValidators(),this.formGroup.get("newProjectName").updateValueAndValidity()}get title(){return this.data.operation===Gt.Add?"newSecret":"editSecret"}get showSpinner(){return this.data.operation===Gt.Edit&&this.loading}get deleteButtonIsVisible(){return this.data.operation===Gt.Edit}createProject(e){return Ft(this,void 0,void 0,(function*(){return yield this.projectService.create(this.data.organizationId,e)}))}openDeleteSecretDialog(){const e=this.getSecretListView(),t=this.dialogService.open(Yt,{data:{secrets:e}});(0,Mt.n)(t.closed).then((e=>void 0!==e&&this.dialogRef.close()))}createSecret(e){return Ft(this,void 0,void 0,(function*(){yield this.secretService.create(this.data.organizationId,e),this.platformUtilsService.showToast("success",null,this.i18nService.t("secretCreated"))}))}getNewProjectView(){const e=new He;return e.organizationId=this.data.organizationId,e.name=this.formGroup.value.newProjectName,e}updateSecret(e){return Ft(this,void 0,void 0,(function*(){yield this.secretService.update(this.data.organizationId,e),this.platformUtilsService.showToast("success",null,this.i18nService.t("secretEdited"))}))}getSecretView(){const e=new Pt;e.organizationId=this.data.organizationId,e.name=this.formGroup.value.name,e.value=this.formGroup.value.value,e.note=this.formGroup.value.notes;const t=this.projects.find((e=>e.id==this.formGroup.value.project));return e.projects=null!=t?[t]:[],e}getSecretListView(){const e=[],t=[],n=new Tt;return this.formGroup.value.project?n.projects=[this.projects.find((e=>e.id==this.formGroup.value.project))]:n.projects=t,n.organizationId=this.data.organizationId,n.id=this.data.secretId,n.name=this.formGroup.value.name,e.push(n),e}}Wt.ɵfac=function(e){return new(e||Wt)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(Nt),u.Y36(rt.D),u.Y36(at.P),u.Y36(ct),u.Y36(ut.x),u.Y36(j.Mn))},Wt.ɵcmp=u.Xpm({type:Wt,selectors:[["ng-component"]],decls:77,vars:31,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large"],["bitDialogTitle",""],["bitDialogContent","",1,"tw-relative"],["class","tw-absolute tw-flex tw-h-full tw-w-full tw-items-center tw-justify-center tw-bg-text-contrast",4,"ngIf"],[1,"tw-flex","tw-gap-4","tw-pt-4"],[1,"tw-w-1/3"],["for","secret-name"],["appAutofocus","","formControlName","name","bitInput",""],[1,"tw-w-full"],["bitInput","","rows","4","formControlName","value"],["bitInput","","rows","4","formControlName","notes"],[1,"tw-mb-0","tw-mt-3"],["bitInput","","name","project","formControlName","project"],["value","",3,"label"],[3,"icon","value","label",4,"ngFor","ngForOf"],[4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["type","button","bitButton","","buttonType","secondary","bitFormButton","","bitDialogClose","",3,"disabled"],["class","tw-ml-auto","type","button","bitIconButton","bwi-trash","buttonType","danger","bitFormButton","",3,"click",4,"ngIf"],[1,"tw-absolute","tw-flex","tw-h-full","tw-w-full","tw-items-center","tw-justify-center","tw-bg-text-contrast"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],[3,"icon","value","label"],["formControlName","newProjectName","bitInput",""],["type","button","bitIconButton","bwi-trash","buttonType","danger","bitFormButton","",1,"tw-ml-auto",3,"click"]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-dialog",1),u._uU(3,"\n    "),u.ynx(4,2),u._uU(5),u.ALo(6,"i18n"),u.BQk(),u._uU(7,"\n    "),u.TgZ(8,"div",3),u._uU(9,"\n      "),u.YNc(10,$t,4,0,"div",4),u._uU(11,"\n      "),u.TgZ(12,"div",5),u._uU(13,"\n        "),u.TgZ(14,"bit-form-field",6),u._uU(15,"\n          "),u.TgZ(16,"bit-label",7),u._uU(17),u.ALo(18,"i18n"),u.qZA(),u._uU(19,"\n          "),u._UZ(20,"input",8),u._uU(21,"\n        "),u.qZA(),u._uU(22,"\n        "),u.TgZ(23,"bit-form-field",9),u._uU(24,"\n          "),u.TgZ(25,"bit-label"),u._uU(26),u.ALo(27,"i18n"),u.qZA(),u._uU(28,"\n          "),u._UZ(29,"textarea",10),u._uU(30,"\n        "),u.qZA(),u._uU(31,"\n      "),u.qZA(),u._uU(32,"\n      "),u.TgZ(33,"bit-form-field"),u._uU(34,"\n        "),u.TgZ(35,"bit-label"),u._uU(36),u.ALo(37,"i18n"),u.qZA(),u._uU(38,"\n        "),u._UZ(39,"textarea",11),u._uU(40,"\n      "),u.qZA(),u._uU(41,"\n\n      "),u._UZ(42,"hr"),u._uU(43,"\n\n      "),u.TgZ(44,"bit-form-field",12),u._uU(45,"\n        "),u.TgZ(46,"bit-label"),u._uU(47),u.ALo(48,"i18n"),u.qZA(),u._uU(49,"\n        "),u.TgZ(50,"bit-select",13),u._uU(51,"\n          "),u._UZ(52,"bit-option",14),u.ALo(53,"i18n"),u._uU(54,"\n          "),u.YNc(55,Vt,2,3,"bit-option",15),u._uU(56,"\n        "),u.qZA(),u._uU(57,"\n      "),u.qZA(),u._uU(58,"\n\n      "),u.YNc(59,Kt,8,3,"bit-form-field",16),u._uU(60,"\n    "),u.qZA(),u._uU(61,"\n    "),u.ynx(62,17),u._uU(63,"\n      "),u.TgZ(64,"button",18),u._uU(65),u.ALo(66,"i18n"),u.qZA(),u._uU(67,"\n      "),u.TgZ(68,"button",19),u._uU(69),u.ALo(70,"i18n"),u.qZA(),u._uU(71,"\n      "),u.YNc(72,Ht,1,0,"button",20),u._uU(73,"\n    "),u.BQk(),u._uU(74,"\n  "),u.qZA(),u._uU(75,"\n"),u.qZA(),u._uU(76,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(5),u.Oqu(u.lcZ(6,15,t.title)),u.xp6(5),u.Q6J("ngIf",t.showSpinner),u.xp6(7),u.Oqu(u.lcZ(18,17,"name")),u.xp6(9),u.Oqu(u.lcZ(27,19,"value")),u.xp6(10),u.Oqu(u.lcZ(37,21,"notes")),u.xp6(11),u.Oqu(u.lcZ(48,23,"project")),u.xp6(5),u.Q6J("label",u.lcZ(53,25,"selectPlaceholder")),u.xp6(3),u.Q6J("ngForOf",t.projects),u.xp6(4),u.Q6J("ngIf",1==t.addNewProject),u.xp6(6),u.hij("\n        ",u.lcZ(66,27,"save"),"\n      "),u.xp6(3),u.Q6J("disabled",!1),u.xp6(1),u.hij("\n        ",u.lcZ(70,29,"cancel"),"\n      "),u.xp6(3),u.Q6J("ngIf",t.deleteButtonIsVisible))},dependencies:[Rt.H,Bt.x,s.sg,s.O5,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,bt.U,lt.b,dt.u,De.r,Ee.a,ze.f,ht.d,gt.G,vt.u,M.Q,ge.C],encapsulation:2});class Xt{}class en extends Xt{}class tn{}class nn extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.organizationId=this.getResponseProperty("OrganizationId"),this.name=this.getResponseProperty("Name"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate")}}class on extends nn{constructor(e){super(e),this.accessToSecrets=this.getResponseProperty("AccessToSecrets")}}var sn=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class cn{constructor(e,t,n){this.cryptoService=e,this.apiService=t,this.encryptService=n,this._serviceAccount=new Pe.x,this.serviceAccount$=this._serviceAccount.asObservable()}getServiceAccounts(e,t){return sn(this,void 0,void 0,(function*(){const n=new URLSearchParams;t&&n.set("includeAccessToSecrets","true");const i=yield this.apiService.send("GET","/organizations/"+e+"/service-accounts?"+n.toString(),null,!0,!0),o=new $e.L(i,on);return yield this.createServiceAccountSecretsDetailsViews(e,o.data)}))}getByServiceAccountId(e,t){return sn(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(t),i=yield this.apiService.send("GET","/service-accounts/"+e,null,!0,!0);return yield this.createServiceAccountView(n,new nn(i))}))}update(e,t,n){return sn(this,void 0,void 0,(function*(){const i=yield this.getOrganizationKey(t),o=yield this.getServiceAccountRequest(i,n),s=yield this.apiService.send("PUT","/service-accounts/"+e,o,!0,!0);this._serviceAccount.next(yield this.createServiceAccountView(i,new nn(s)))}))}create(e,t){return sn(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e),i=yield this.getServiceAccountRequest(n,t),o=yield this.apiService.send("POST","/organizations/"+e+"/service-accounts",i,!0,!0);this._serviceAccount.next(yield this.createServiceAccountView(n,new nn(o)))}))}delete(e){return sn(this,void 0,void 0,(function*(){const t=e.map((e=>e.id)),n=yield this.apiService.send("POST","/service-accounts/delete",t,!0,!0);return this._serviceAccount.next(null),n.data.map((t=>{const n=new Be;return n.id=t.id,n.name=e.find((e=>e.id==t.id)).name,n.errorMessage=t.error,n}))}))}getOrganizationKey(e){return sn(this,void 0,void 0,(function*(){return yield this.cryptoService.getOrgKey(e)}))}getServiceAccountRequest(e,t){return sn(this,void 0,void 0,(function*(){const n=new tn;return n.name=yield this.encryptService.encrypt(t.name,e),n}))}createServiceAccountView(e,t){return sn(this,void 0,void 0,(function*(){const n=new Xt;return n.id=t.id,n.organizationId=t.organizationId,n.creationDate=t.creationDate,n.revisionDate=t.revisionDate,n.name=t.name?yield this.encryptService.decryptToUtf8(new Ve._(t.name),e):null,n}))}createServiceAccountSecretsDetailsView(e,t){return sn(this,void 0,void 0,(function*(){const n=new en;return n.id=t.id,n.organizationId=t.organizationId,n.creationDate=t.creationDate,n.revisionDate=t.revisionDate,n.accessToSecrets=t.accessToSecrets,n.name=t.name?yield this.encryptService.decryptToUtf8(new Ve._(t.name),e):null,n}))}createServiceAccountSecretsDetailsViews(e,t){return sn(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e);return yield Promise.all(t.map((e=>sn(this,void 0,void 0,(function*(){return yield this.createServiceAccountSecretsDetailsView(n,e)})))))}))}}cn.ɵfac=function(e){return new(e||cn)(u.LFG(nt.$),u.LFG(it.s),u.LFG(ot.U))},cn.ɵprov=u.Yz7({token:cn,factory:cn.ɵfac,providedIn:"root"});var rn,an=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function un(e,t){1&e&&(u.TgZ(0,"div",9),u._uU(1,"\n        "),u._UZ(2,"i",10),u._uU(3,"\n      "),u.qZA())}function ln(e,t){1&e&&(u.TgZ(0,"div"),u._uU(1,"\n        "),u.TgZ(2,"bit-form-field"),u._uU(3,"\n          "),u.TgZ(4,"bit-label"),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n          "),u._UZ(8,"input",11),u._uU(9,"\n        "),u.qZA(),u._uU(10,"\n      "),u.qZA()),2&e&&(u.xp6(5),u.Oqu(u.lcZ(6,1,"serviceAccountName")))}!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit"}(rn||(rn={}));class dn{constructor(e,t,n,i,o){this.dialogRef=e,this.data=t,this.serviceAccountService=n,this.i18nService=i,this.platformUtilsService=o,this.formGroup=new Je.cw({name:new Je.NI("",{validators:[Je.kI.required,Je.kI.maxLength(500),At],updateOn:"submit"})},{}),this.loading=!1,this.submit=()=>an(this,void 0,void 0,(function*(){if(!this.data.organizationEnabled)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("serviceAccountsCannotCreate"));if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const e=this.getServiceAccountView();let t;this.data.operation==rn.Add?(yield this.serviceAccountService.create(this.data.organizationId,e),t=this.i18nService.t("serviceAccountCreated")):(yield this.serviceAccountService.update(this.data.serviceAccountId,this.data.organizationId,e),t=this.i18nService.t("serviceAccountUpdated")),this.platformUtilsService.showToast("success",null,t),this.dialogRef.close()}))}ngOnInit(){return an(this,void 0,void 0,(function*(){this.data.operation==rn.Edit&&this.loadData()}))}loadData(){return an(this,void 0,void 0,(function*(){this.loading=!0;const e=yield this.serviceAccountService.getByServiceAccountId(this.data.serviceAccountId,this.data.organizationId);this.formGroup.patchValue({name:e.name}),this.loading=!1}))}getServiceAccountView(){const e=new Xt;return e.organizationId=this.data.organizationId,e.name=this.formGroup.value.name,e}get title(){return this.data.operation===rn.Add?"newServiceAccount":"editServiceAccount"}}dn.ɵfac=function(e){return new(e||dn)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(cn),u.Y36(rt.D),u.Y36(at.P))},dn.ɵcmp=u.Xpm({type:dn,selectors:[["ng-component"]],decls:28,vars:13,consts:[[3,"formGroup","bitSubmit"],["dialogSize","default"],["bitDialogTitle",""],["bitDialogContent",""],["class","tw-text-center",4,"ngIf"],[4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["type","button","bitButton","","buttonType","secondary","bitFormButton","","bitDialogClose",""],[1,"tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["appAutofocus","","formControlName","name","bitInput",""]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-dialog",1),u._uU(3,"\n    "),u.ynx(4,2),u._uU(5),u.ALo(6,"i18n"),u.BQk(),u._uU(7,"\n    "),u.TgZ(8,"div",3),u._uU(9,"\n      "),u.YNc(10,un,4,0,"div",4),u._uU(11,"\n      "),u.YNc(12,ln,11,3,"div",5),u._uU(13,"\n    "),u.qZA(),u._uU(14,"\n    "),u.ynx(15,6),u._uU(16,"\n      "),u.TgZ(17,"button",7),u._uU(18),u.ALo(19,"i18n"),u.qZA(),u._uU(20,"\n      "),u.TgZ(21,"button",8),u._uU(22),u.ALo(23,"i18n"),u.qZA(),u._uU(24,"\n    "),u.BQk(),u._uU(25,"\n  "),u.qZA(),u._uU(26,"\n"),u.qZA(),u._uU(27,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(5),u.Oqu(u.lcZ(6,7,t.title)),u.xp6(5),u.Q6J("ngIf",t.loading),u.xp6(2),u.Q6J("ngIf",!t.loading),u.xp6(6),u.hij("\n        ",u.lcZ(19,9,"save"),"\n      "),u.xp6(4),u.hij("\n        ",u.lcZ(23,11,"cancel"),"\n      "))},dependencies:[s.O5,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,bt.U,lt.b,dt.u,De.r,Ee.a,ze.f,ht.d,gt.G,vt.u,ge.C],encapsulation:2});var pn=n(81049),hn=n(2138),gn=n(66385),vn=n(73974),fn=n(26194),mn=n(44234),wn=n(19187),Un=n(63339),An=n(38581);function _n(e,t){1&e&&(u.TgZ(0,"div",8),u._uU(1,"\n  "),u._UZ(2,"i",9),u._uU(3,"\n"),u.qZA())}function bn(e,t){1&e&&(u.TgZ(0,"bit-no-items"),u._uU(1,"\n    "),u.ynx(2,10),u._uU(3),u.ALo(4,"i18n"),u.BQk(),u._uU(5,"\n    "),u.ynx(6,11),u._uU(7),u.ALo(8,"i18n"),u.BQk(),u._uU(9,"\n  "),u.qZA()),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,2,"secretsNoItemsTitle")),u.xp6(4),u.Oqu(u.lcZ(8,4,"secretsTrashNoItemsMessage")))}function yn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-no-items"),u._uU(1,"\n    "),u.ynx(2,10),u._uU(3),u.ALo(4,"i18n"),u.BQk(),u._uU(5,"\n    "),u.ynx(6,11),u._uU(7),u.ALo(8,"i18n"),u.BQk(),u._uU(9,"\n    "),u.TgZ(10,"button",12),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(2);return u.KtG(t.newSecretEvent.emit())})),u._uU(11,"\n      "),u._UZ(12,"i",13),u._uU(13),u.ALo(14,"i18n"),u.qZA(),u._uU(15,"\n  "),u.qZA()}2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,3,"secretsNoItemsTitle")),u.xp6(4),u.Oqu(u.lcZ(8,5,"secretsNoItemsMessage")),u.xp6(6),u.hij("\n      ",u.lcZ(14,7,"newSecret"),"\n    "))}function Zn(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n  "),u.YNc(2,bn,10,6,"bit-no-items",1),u._uU(3,"\n  "),u.YNc(4,yn,16,9,"bit-no-items",1),u._uU(5,"\n"),u.BQk()),2&e){const e=u.oxw();u.xp6(2),u.Q6J("ngIf",e.trash),u.xp6(2),u.Q6J("ngIf",!e.trash)}}function xn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div"),u._uU(1,"\n              "),u.TgZ(2,"button",36),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.editSecretEvent.emit(t.id))})),u._uU(3),u.qZA(),u._uU(4,"\n            "),u.qZA()}if(2&e){const e=u.oxw().$implicit;u.xp6(3),u.hij("\n                ",e.name,"\n              ")}}function Sn(e,t){if(1&e&&(u.TgZ(0,"div"),u._uU(1),u.qZA()),2&e){const e=u.oxw().$implicit;u.xp6(1),u.Oqu(e.name)}}function Tn(e,t){if(1&e&&(u.TgZ(0,"span",37),u._uU(1),u.ALo(2,"ellipsis"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("title",e.name),u.xp6(1),u.hij("\n          ",u.xi3(2,2,e.name,32),"\n        ")}}function In(e,t){1&e&&(u.TgZ(0,"span",38),u._UZ(1,"i",39),u._uU(2),u.ALo(3,"i18n"),u.qZA()),2&e&&(u.xp6(2),u.Oqu(u.lcZ(3,1,"unassigned")))}function Pn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",5),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.editSecretEvent.emit(t.id))})),u._uU(1,"\n          "),u._UZ(2,"i",40),u._uU(3),u.ALo(4,"i18n"),u.qZA()}2&e&&(u.xp6(3),u.hij("\n          ",u.lcZ(4,1,"editSecret"),"\n        "))}function qn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",5),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.copySecretNameEvent.emit(t.name))})),u._uU(1,"\n          "),u._UZ(2,"i",41),u._uU(3),u.ALo(4,"i18n"),u.qZA()}2&e&&(u.xp6(3),u.hij("\n          ",u.lcZ(4,1,"copySecretName"),"\n        "))}function jn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",5),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.copySecretValueEvent.emit(t.id))})),u._uU(1,"\n          "),u._UZ(2,"i",41),u._uU(3),u.ALo(4,"i18n"),u.qZA()}2&e&&(u.xp6(3),u.hij("\n          ",u.lcZ(4,1,"copySecretValue"),"\n        "))}function kn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",5),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.restoreSecretsEvent.emit([t.id]))})),u._uU(1,"\n          "),u._UZ(2,"i",42),u._uU(3),u.ALo(4,"i18n"),u.qZA()}2&e&&(u.xp6(3),u.hij("\n          ",u.lcZ(4,1,"restoreSecret"),"\n        "))}function Cn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",5),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.deleteSecretsEvent.emit([t]))})),u._uU(1,"\n          "),u._UZ(2,"i",6),u._uU(3,"\n          "),u.TgZ(4,"span",7),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n        "),u.qZA()}if(2&e){const e=u.oxw(4);u.xp6(5),u.Oqu(u.lcZ(6,1,e.trash?"permanentlyDelete":"deleteSecret"))}}function Ln(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr",25),u._uU(1,"\n      "),u.TgZ(2,"td",26),u._uU(3,"\n        "),u.TgZ(4,"input",27),u.NdJ("change",(function(t){const n=u.CHM(e).$implicit,i=u.oxw(3);return u.KtG(t?i.selection.toggle(n.id):null)})),u.qZA(),u._uU(5,"\n      "),u.qZA(),u._uU(6,"\n      "),u.TgZ(7,"td",26),u._uU(8,"\n        "),u.TgZ(9,"div",28),u._uU(10,"\n          "),u._UZ(11,"i",29),u._uU(12,"\n          "),u.TgZ(13,"div"),u._uU(14,"\n            "),u.YNc(15,xn,5,1,"div",1),u._uU(16,"\n            "),u.YNc(17,Sn,2,1,"div",1),u._uU(18,"\n            "),u.TgZ(19,"div",30),u._uU(20),u.TgZ(21,"button",31),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,n=u.oxw(3);return u.KtG(n.copySecretUuidEvent.emit(t.id))})),u.ALo(22,"i18n"),u.ALo(23,"i18n"),u.qZA(),u._uU(24,"\n            "),u.qZA(),u._uU(25,"\n          "),u.qZA(),u._uU(26,"\n        "),u.qZA(),u._uU(27,"\n      "),u.qZA(),u._uU(28,"\n      "),u.TgZ(29,"td",26),u._uU(30,"\n        "),u.YNc(31,Tn,3,5,"span",32),u._uU(32,"\n        "),u.YNc(33,In,4,3,"span",33),u._uU(34,"\n      "),u.qZA(),u._uU(35,"\n      "),u.TgZ(36,"td",34),u._uU(37),u.ALo(38,"date"),u.qZA(),u._uU(39,"\n      "),u.TgZ(40,"td",26),u._uU(41,"\n        "),u._UZ(42,"button",22),u.ALo(43,"i18n"),u.ALo(44,"i18n"),u._uU(45,"\n      "),u.qZA(),u._uU(46,"\n\n      "),u.TgZ(47,"bit-menu",null,35),u._uU(49,"\n        "),u.YNc(50,Pn,5,3,"button",4),u._uU(51,"\n        "),u.YNc(52,qn,5,3,"button",4),u._uU(53,"\n        "),u.YNc(54,jn,5,3,"button",4),u._uU(55,"\n        "),u.YNc(56,kn,5,3,"button",4),u._uU(57,"\n        "),u.YNc(58,Cn,8,3,"button",4),u._uU(59,"\n      "),u.qZA(),u._uU(60,"\n    "),u.qZA()}if(2&e){const e=t.$implicit,n=u.MAs(48),i=u.oxw(3);u.xp6(4),u.Q6J("checked",i.selection.isSelected(e.id)),u.xp6(11),u.Q6J("ngIf",!i.trash),u.xp6(2),u.Q6J("ngIf",i.trash),u.xp6(3),u.hij("\n              ",e.id,"\n              "),u.xp6(1),u.Q6J("title",u.lcZ(22,17,"copyUuid")),u.uIk("aria-label",u.lcZ(23,19,"copyUuid")),u.xp6(10),u.Q6J("ngForOf",e.projects),u.xp6(2),u.Q6J("ngIf",0===e.projects.length),u.xp6(4),u.Oqu(u.xi3(38,21,e.revisionDate,"medium")),u.xp6(5),u.Q6J("title",u.lcZ(43,24,"options"))("bitMenuTriggerFor",n),u.uIk("aria-label",u.lcZ(44,26,"options")),u.xp6(8),u.Q6J("ngIf",e.write&&!i.trash),u.xp6(2),u.Q6J("ngIf",!i.trash),u.xp6(2),u.Q6J("ngIf",!i.trash),u.xp6(2),u.Q6J("ngIf",i.trash),u.xp6(2),u.Q6J("ngIf",e.write)}}function On(e,t){if(1&e&&(u._uU(0,"\n    "),u.YNc(1,Ln,61,28,"tr",24),u.ALo(2,"async"),u._uU(3,"\n  ")),2&e){const e=t.$implicit;u.xp6(1),u.Q6J("ngForOf",u.lcZ(2,1,e))}}function Nn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-table",14),u._uU(1,"\n  "),u.ynx(2,15),u._uU(3,"\n    "),u.TgZ(4,"tr"),u._uU(5,"\n      "),u.TgZ(6,"th",16),u._uU(7,"\n        "),u.TgZ(8,"label",17),u._uU(9,"\n          "),u.TgZ(10,"input",18),u.NdJ("change",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(t?n.toggleAll():null)})),u.qZA(),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n      "),u.qZA(),u._uU(14,"\n      "),u.TgZ(15,"th",19),u._uU(16),u.ALo(17,"i18n"),u.qZA(),u._uU(18,"\n      "),u.TgZ(19,"th",20),u._uU(20),u.ALo(21,"i18n"),u.qZA(),u._uU(22,"\n      "),u.TgZ(23,"th",21),u._uU(24),u.ALo(25,"i18n"),u.qZA(),u._uU(26,"\n      "),u.TgZ(27,"th",16),u._uU(28,"\n        "),u._UZ(29,"button",22),u.ALo(30,"i18n"),u.ALo(31,"i18n"),u._uU(32,"\n      "),u.qZA(),u._uU(33,"\n    "),u.qZA(),u._uU(34,"\n  "),u.BQk(),u._uU(35,"\n  "),u.YNc(36,On,4,3,"ng-template",23),u._uU(37,"\n"),u.qZA()}if(2&e){const e=u.oxw(),t=u.MAs(7);u.Q6J("dataSource",e.dataSource),u.xp6(10),u.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected()),u.xp6(1),u.hij("\n          ",u.lcZ(12,11,"all"),"\n        "),u.xp6(5),u.Oqu(u.lcZ(17,13,"name")),u.xp6(3),u.Q6J("fn",e.sortProjects),u.xp6(1),u.Oqu(u.lcZ(21,15,"project")),u.xp6(4),u.Oqu(u.lcZ(25,17,"lastEdited")),u.xp6(5),u.Q6J("title",u.lcZ(30,19,"options"))("bitMenuTriggerFor",t),u.uIk("aria-label",u.lcZ(31,21,"options"))}}function Jn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",5),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.bulkRestoreSecrets())})),u._uU(1,"\n    "),u._UZ(2,"i",42),u._uU(3,"\n    "),u.TgZ(4,"span"),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n  "),u.qZA()}2&e&&(u.xp6(5),u.Oqu(u.lcZ(6,1,"restoreSelected")))}class Dn{get secrets(){return this._secrets}set secrets(e){this.selection.clear(),this._secrets=e,this.dataSource.data=e}set search(e){this.selection.clear(),this.dataSource.filter=e}constructor(e,t){this.i18nService=e,this.platformUtilsService=t,this.dataSource=new hn.G,this.editSecretEvent=new u.vpe,this.copySecretNameEvent=new u.vpe,this.copySecretValueEvent=new u.vpe,this.copySecretUuidEvent=new u.vpe,this.onSecretCheckedEvent=new u.vpe,this.deleteSecretsEvent=new u.vpe,this.newSecretEvent=new u.vpe,this.restoreSecretsEvent=new u.vpe,this.destroy$=new Pe.x,this.selection=new pn.Ov(!0,[]),this.sortProjects=(e,t)=>{var n;const i=e.projects,o=t.projects;return i.length!==o.length?i.length-o.length:null===(n=i[0])||void 0===n?void 0:n.name.localeCompare(o[0].name)},this.selection.changed.pipe((0,je.R)(this.destroy$)).subscribe((e=>this.onSecretCheckedEvent.emit(this.selection.selected)))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}isAllSelected(){var e;if((null===(e=this.selection.selected)||void 0===e?void 0:e.length)>0){return this.selection.selected.length===this.dataSource.filteredData.length}return!1}toggleAll(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.filteredData.map((e=>e.id)))}bulkDeleteSecrets(){this.selection.selected.length>=1?this.deleteSecretsEvent.emit(this.secrets.filter((e=>this.selection.isSelected(e.id)))):this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"))}bulkRestoreSecrets(){this.selection.selected.length>=1?this.restoreSecretsEvent.emit(this.selection.selected):this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"))}static copySecretName(e,t,n){t.copyToClipboard(e),t.showToast("success",null,n.t("valueCopied",n.t("name")))}static copySecretValue(e,t,n,i){const o=i.getBySecretId(e).then((e=>e.value));Dn.copyToClipboardAsync(o,t).then((()=>{t.showToast("success",null,n.t("valueCopied",n.t("value")))}))}static copySecretUuid(e,t,n){t.copyToClipboard(e),t.showToast("success",null,n.t("valueCopied",n.t("uuid")))}static copyToClipboardAsync(e,t){return t.isSafari()?navigator.clipboard.write([new ClipboardItem({"text/plain":e})]):e.then((e=>t.copyToClipboard(e)))}}Dn.ɵfac=function(e){return new(e||Dn)(u.Y36(rt.D),u.Y36(at.P))},Dn.ɵcmp=u.Xpm({type:Dn,selectors:[["sm-secrets-list"]],inputs:{secrets:"secrets",search:"search",trash:"trash"},outputs:{editSecretEvent:"editSecretEvent",copySecretNameEvent:"copySecretNameEvent",copySecretValueEvent:"copySecretValueEvent",copySecretUuidEvent:"copySecretUuidEvent",onSecretCheckedEvent:"onSecretCheckedEvent",deleteSecretsEvent:"deleteSecretsEvent",newSecretEvent:"newSecretEvent",restoreSecretsEvent:"restoreSecretsEvent"},decls:21,vars:7,consts:[["class","tw-items-center tw-justify-center tw-pt-64 tw-text-center",4,"ngIf"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["tableMenu",""],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash","tw-text-danger"],[1,"tw-text-danger"],[1,"tw-items-center","tw-justify-center","tw-pt-64","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["slot","title"],["slot","description"],["type","button","slot","button","bitButton","","buttonType","secondary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"dataSource"],["header",""],["bitCell","",1,"tw-w-0"],[1,"!tw-mb-0","tw-flex","tw-w-fit","tw-gap-2","!tw-font-bold","!tw-text-muted"],["type","checkbox",3,"checked","indeterminate","change"],["bitCell","","bitSortable","name","default",""],["bitCell","","bitSortable","projects",3,"fn"],["bitCell","","bitSortable","revisionDate"],["type","button","bitIconButton","bwi-ellipsis-v","buttonType","main",3,"title","bitMenuTriggerFor"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell",""],["type","checkbox",3,"checked","change"],[1,"tw-flex","tw-items-center","tw-gap-4","tw-break-all"],["aria-hidden","true",1,"bwi","bwi-key","tw-text-muted"],[1,"tw-text-sm","tw-text-muted"],["type","button","bitIconButton","bwi-clone","buttonType","main","size","small",3,"title","click"],["bitBadge","","badgeType","secondary","class","tw-ml-1",3,"title",4,"ngFor","ngForOf"],["bitBadge","","badgeType","warning","class","tw-ml-1",4,"ngIf"],["bitCell","",1,"tw-whitespace-nowrap"],["secretMenu",""],["type","button","bitLink","",3,"click"],["bitBadge","","badgeType","secondary",1,"tw-ml-1",3,"title"],["bitBadge","","badgeType","warning",1,"tw-ml-1"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-exclamation-triangle","tw-mr-1"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-clone"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-refresh"]],template:function(e,t){1&e&&(u.YNc(0,_n,4,0,"div",0),u._uU(1,"\n\n"),u.YNc(2,Zn,6,2,"ng-container",1),u._uU(3,"\n\n"),u.YNc(4,Nn,38,23,"bit-table",2),u._uU(5,"\n\n"),u.TgZ(6,"bit-menu",null,3),u._uU(8,"\n  "),u.YNc(9,Jn,8,3,"button",4),u._uU(10,"\n  "),u.TgZ(11,"button",5),u.NdJ("click",(function(){return t.bulkDeleteSecrets()})),u._uU(12,"\n    "),u._UZ(13,"i",6),u._uU(14,"\n    "),u.TgZ(15,"span",7),u._uU(16),u.ALo(17,"i18n"),u.qZA(),u._uU(18,"\n  "),u.qZA(),u._uU(19,"\n"),u.qZA(),u._uU(20,"\n")),2&e&&(u.Q6J("ngIf",!t.secrets),u.xp6(2),u.Q6J("ngIf",0==(null==t.secrets?null:t.secrets.length)),u.xp6(2),u.Q6J("ngIf",(null==t.secrets?null:t.secrets.length)>=1),u.xp6(5),u.Q6J("ngIf",t.trash),u.xp6(7),u.Oqu(u.lcZ(17,5,"deleteSecrets")))},dependencies:[s.sg,s.O5,gn.l,De.r,M.Q,h._,vn.M,fn.t,mn.e,Ye.a,Ge.Y,Me.v,wn.T,Ye.f,Un.M,s.Ov,s.uU,An.p,ge.C],encapsulation:2});var En=n(58172),zn=n(27059),Yn=n(7203),Gn=n(34961),Mn=n(12963),Qn=n(91849),Rn=n(28315),Bn=n(45202),Fn=n(19576);function $n(e,t){if(1&e&&u._UZ(0,"i",16),2&e){const e=u.oxw(3);u.Gre("bwi ",e.icon,"")}}function Vn(e,t){if(1&e&&(u.TgZ(0,"h1",14),u.ALo(1,"i18n"),u._uU(2,"\n        "),u.YNc(3,$n,1,3,"i",15),u._uU(4),u.ALo(5,"i18n"),u.qZA()),2&e){const e=u.oxw().ngIf,t=u.oxw();u.Q6J("title",t.title||u.lcZ(1,3,e.titleId)),u.xp6(3),u.Q6J("ngIf",t.icon),u.xp6(1),u.hij("\n        ",t.title||u.lcZ(5,5,e.titleId),"\n      ")}}function Kn(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n                "),u._UZ(2,"bit-menu-divider"),u._uU(3,"\n                "),u.TgZ(4,"span",33),u._uU(5),u.qZA(),u._uU(6,"\n              "),u.BQk()),2&e){const e=u.oxw(3);u.xp6(5),u.hij("\n                  ",e.hostname,"\n                ")}}function Hn(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",31),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(3);return u.KtG(t.lock())})),u._uU(1,"\n                "),u._UZ(2,"i",34),u._uU(3),u.ALo(4,"i18n"),u.qZA()}2&e&&(u.xp6(3),u.hij("\n                ",u.lcZ(4,1,"lockNow"),"\n              "))}function Wn(e,t){if(1&e){const e=u.EpF();u.ynx(0),u._uU(1,"\n          "),u.TgZ(2,"button",17),u._uU(3,"\n            "),u._UZ(4,"dynamic-avatar",18),u.ALo(5,"userName"),u._uU(6,"\n          "),u.qZA(),u._uU(7,"\n\n          "),u.TgZ(8,"bit-menu",null,19),u._uU(10,"\n            "),u.TgZ(11,"div",20),u._uU(12,"\n              "),u.TgZ(13,"div",21),u._uU(14,"\n                "),u._UZ(15,"dynamic-avatar",18),u.ALo(16,"userName"),u._uU(17,"\n                "),u.TgZ(18,"div",22),u._uU(19,"\n                  "),u.TgZ(20,"span"),u._uU(21),u.ALo(22,"i18n"),u.qZA(),u._uU(23,"\n                  "),u.TgZ(24,"small",23),u._uU(25),u.ALo(26,"userName"),u.qZA(),u._uU(27,"\n                "),u.qZA(),u._uU(28,"\n              "),u.qZA(),u._uU(29,"\n\n              "),u.YNc(30,Kn,7,1,"ng-container",9),u._uU(31,"\n\n              "),u._UZ(32,"bit-menu-divider"),u._uU(33,"\n\n              "),u.TgZ(34,"a",24),u._uU(35,"\n                "),u._UZ(36,"i",25),u._uU(37),u.ALo(38,"i18n"),u.qZA(),u._uU(39,"\n              "),u.TgZ(40,"a",26),u._uU(41,"\n                "),u._UZ(42,"i",27),u._uU(43),u.ALo(44,"i18n"),u.qZA(),u._uU(45,"\n              "),u.TgZ(46,"a",28),u._uU(47,"\n                "),u._UZ(48,"i",29),u._uU(49),u.ALo(50,"i18n"),u.qZA(),u._uU(51,"\n\n              "),u._UZ(52,"bit-menu-divider"),u._uU(53,"\n\n              "),u.YNc(54,Hn,5,3,"button",30),u.ALo(55,"async"),u._uU(56,"\n              "),u.TgZ(57,"button",31),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(2);return u.KtG(t.logout())})),u._uU(58,"\n                "),u._UZ(59,"i",32),u._uU(60),u.ALo(61,"i18n"),u.qZA(),u._uU(62,"\n            "),u.qZA(),u._uU(63,"\n          "),u.qZA(),u._uU(64,"\n        "),u.BQk()}if(2&e){const e=t.ngIf,n=u.MAs(9),i=u.oxw(2);u.xp6(2),u.Q6J("bitMenuTriggerFor",n),u.xp6(2),u.Q6J("id",e.userId)("text",u.lcZ(5,13,e)),u.xp6(11),u.Q6J("id",e.userId)("text",u.lcZ(16,15,e)),u.xp6(6),u.Oqu(u.lcZ(22,17,"loggedInAs")),u.xp6(4),u.hij("\n                    ",u.lcZ(26,19,e),"\n                  "),u.xp6(5),u.Q6J("ngIf",i.selfHosted),u.xp6(7),u.hij("\n                ",u.lcZ(38,21,"accountSettings"),"\n              "),u.xp6(6),u.hij("\n                ",u.lcZ(44,23,"getHelp"),"\n              "),u.xp6(6),u.hij("\n                ",u.lcZ(50,25,"getApps"),"\n              "),u.xp6(5),u.Q6J("ngIf",u.lcZ(55,27,i.canLock$)),u.xp6(6),u.hij("\n                ",u.lcZ(61,29,"logOut"),"\n              ")}}const Xn=function(e){return{"tw-border-0 tw-border-b tw-border-solid tw-border-secondary-300 tw-bg-background-alt tw-pb-0":e}},ei=function(e){return{"tw-hidden":e}};function ti(e,t){if(1&e&&(u.TgZ(0,"header",1),u._uU(1,"\n  "),u.TgZ(2,"div",2),u._uU(3,"\n    "),u.TgZ(4,"div",3),u._uU(5,"\n      "),u.Hsn(6),u._uU(7,"\n      "),u.TgZ(8,"div",4,5),u._uU(10,"\n        "),u.Hsn(11,1),u._uU(12,"\n      "),u.qZA(),u._uU(13,"\n      "),u.YNc(14,Vn,6,7,"h1",6),u._uU(15,"\n    "),u.qZA(),u._uU(16,"\n    "),u.TgZ(17,"div",7),u._uU(18,"\n      "),u.TgZ(19,"div",8),u._uU(20,"\n        "),u.Hsn(21,2),u._uU(22,"\n        "),u._UZ(23,"product-switcher"),u._uU(24,"\n        "),u.YNc(25,Wn,65,31,"ng-container",9),u.ALo(26,"async"),u._uU(27,"\n      "),u.qZA(),u._uU(28,"\n      "),u.TgZ(29,"div",10,11),u._uU(31,"\n        "),u.Hsn(32,3),u._uU(33,"\n      "),u.qZA(),u._uU(34,"\n    "),u.qZA(),u._uU(35,"\n  "),u.qZA(),u._uU(36,"\n  "),u.TgZ(37,"div",12,13),u._uU(39,"\n    "),u.Hsn(40,4),u._uU(41,"\n  "),u.qZA(),u._uU(42,"\n"),u.qZA()),2&e){const e=u.MAs(9),t=u.MAs(30),n=u.MAs(38),i=u.oxw();u.Q6J("ngClass",u.VKq(8,Xn,0!==n.childElementCount)),u.xp6(8),u.Q6J("ngClass",u.VKq(10,ei,0===e.childElementCount)),u.xp6(6),u.Q6J("ngIf",0===e.childElementCount),u.xp6(11),u.Q6J("ngIf",u.lcZ(26,6,i.account$)),u.xp6(4),u.Q6J("ngClass",u.VKq(12,ei,0===t.childElementCount)),u.xp6(8),u.Q6J("ngClass",u.VKq(14,ei,0===n.childElementCount))}}const ni=[[["","slot","breadcrumbs"]],[["","slot","title"]],"*",[["","slot","secondary"]],[["","slot","tabs"]]];class ii{constructor(e,t,n,i,o){this.route=e,this.stateService=t,this.platformUtilsService=n,this.vaultTimeoutSettingsService=i,this.messagingService=o,this.hostname=location.hostname,this.routeData$=this.route.data.pipe((0,D.U)((e=>({titleId:e.titleId})))),this.selfHosted=this.platformUtilsService.isSelfHost(),this.account$=(0,pe.a)([this.stateService.activeAccount$,this.stateService.accounts$]).pipe((0,D.U)((([e,t])=>{var n;return null===(n=t[e])||void 0===n?void 0:n.profile}))),this.canLock$=this.vaultTimeoutSettingsService.availableVaultTimeoutActions$().pipe((0,D.U)((e=>e.includes(zn.B.Lock))))}lock(){this.messagingService.send("lockVault")}logout(){this.messagingService.send("logout")}}ii.ɵfac=function(e){return new(e||ii)(u.Y36(c.gz),u.Y36(En.b),u.Y36(at.P),u.Y36(Yn.E),u.Y36(Gn.o))},ii.ɵcmp=u.Xpm({type:ii,selectors:[["app-header"]],inputs:{title:"title",icon:"icon"},ngContentSelectors:["[slot=breadcrumbs]","[slot=title]","*","[slot=secondary]","[slot=tabs]"],decls:3,vars:3,consts:[["class","-tw-m-6 tw-mb-3 tw-flex tw-flex-col tw-p-6",3,"ngClass",4,"ngIf"],[1,"-tw-m-6","tw-mb-3","tw-flex","tw-flex-col","tw-p-6",3,"ngClass"],[1,"tw-flex"],[1,"tw-flex","tw-min-w-0","tw-flex-1","tw-flex-col","tw-gap-2"],[3,"ngClass"],["titleContainer",""],["bitTypography","h1","noMargin","","class","tw-m-0 tw-mr-2 tw-truncate tw-leading-10",3,"title",4,"ngIf"],[1,"tw-ml-auto","tw-flex","tw-flex-col","tw-gap-4"],[1,"tw-flex","tw-min-w-max","tw-items-center","tw-justify-end","tw-gap-2"],[4,"ngIf"],[1,"tw-ml-auto",3,"ngClass"],["contentContainer",""],[1,"-tw-mx-4","-tw-mb-px",3,"ngClass"],["tabsContainer",""],["bitTypography","h1","noMargin","",1,"tw-m-0","tw-mr-2","tw-truncate","tw-leading-10",3,"title"],["aria-hidden","true",3,"class",4,"ngIf"],["aria-hidden","true"],["type","button",1,"tw-border-0","tw-bg-transparent","tw-p-0",3,"bitMenuTriggerFor"],[3,"id","text"],["accountMenu",""],[1,"tw-flex","tw-min-w-52","tw-max-w-72","tw-flex-col"],["appStopProp","",1,"tw-flex","tw-items-center","tw-px-4","tw-py-1","tw-leading-tight","tw-text-info"],[1,"tw-ml-2","tw-block","tw-overflow-hidden","tw-whitespace-nowrap"],[1,"tw-block","tw-overflow-hidden","tw-whitespace-nowrap","tw-text-muted"],["bitMenuItem","","routerLink","/settings/account"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-user"],["bitMenuItem","","href","https://bitwarden.com/help/","target","_blank","rel","noopener"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-question-circle"],["bitMenuItem","","href","https://bitwarden.com/download/","target","_blank","rel","noopener"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-download"],["bitMenuItem","","type","button",3,"click",4,"ngIf"],["bitMenuItem","","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-sign-out"],[1,"tw-break-all","tw-px-4","tw-py-1","tw-text-left","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-lock"]],template:function(e,t){1&e&&(u.F$t(ni),u.YNc(0,ti,43,16,"header",0),u.ALo(1,"async"),u._uU(2,"\n")),2&e&&u.Q6J("ngIf",u.lcZ(1,1,t.routeData$))},dependencies:[s.mk,s.O5,c.rH,Mn._,vn.M,fn.t,mn.e,Qn.n,Rn.t,x.D,Bn.m,s.Ov,ge.C,Fn.z],encapsulation:2});class oi{constructor(e,t,n){this.route=e,this.dialogService=t,this.organizationService=n,this.destroy$=new Pe.x}ngOnInit(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{var t;this.organizationId=e.organizationId,this.organizationEnabled=null===(t=this.organizationService.get(e.organizationId))||void 0===t?void 0:t.enabled}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}openSecretDialog(){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}openProjectDialog(){this.dialogService.open(St,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}openServiceAccountDialog(){this.dialogService.open(dn,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}}function si(e,t){1&e&&(u.TgZ(0,"div",7),u._uU(1,"\n  "),u._UZ(2,"i",8),u._uU(3,"\n"),u.qZA())}function ci(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-no-items"),u._uU(1,"\n  "),u.ynx(2,9),u._uU(3),u.ALo(4,"i18n"),u.BQk(),u._uU(5,"\n  "),u.ynx(6,10),u._uU(7),u.ALo(8,"i18n"),u.BQk(),u._uU(9,"\n  "),u.TgZ(10,"button",11),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.newProjectEvent.emit())})),u._uU(11,"\n    "),u._UZ(12,"i",12),u._uU(13),u.ALo(14,"i18n"),u.qZA(),u._uU(15,"\n"),u.qZA()}2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,3,"projectsNoItemsTitle")),u.xp6(4),u.Oqu(u.lcZ(8,5,"projectsNoItemsMessage")),u.xp6(6),u.hij("\n    ",u.lcZ(14,7,"newProject"),"\n  "))}function ri(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",4),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.editProjectEvent.emit(t.id))})),u._uU(1,"\n          "),u._UZ(2,"i",35),u._uU(3),u.ALo(4,"i18n"),u.qZA()}2&e&&(u.xp6(3),u.hij("\n          ",u.lcZ(4,1,"editProject"),"\n        "))}function ai(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",4),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw().$implicit,n=u.oxw(3);return u.KtG(n.deleteProject(t.id))})),u._uU(1,"\n          "),u._UZ(2,"i",5),u._uU(3,"\n          "),u.TgZ(4,"span",6),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n        "),u.qZA()}2&e&&(u.xp6(5),u.Oqu(u.lcZ(6,1,"deleteProject")))}oi.ɵfac=function(e){return new(e||oi)(u.Y36(c.gz),u.Y36(ut.x),u.Y36(j.Mn))},oi.ɵcmp=u.Xpm({type:oi,selectors:[["sm-new-menu"]],decls:28,vars:13,consts:[["type","button","bitButton","","buttonType","primary",1,"tw-min-w-max",3,"bitMenuTriggerFor"],["aria-hidden","true",1,"bwi","bwi-angle-down"],["newMenu",""],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-sitemap"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-key"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-wrench"]],template:function(e,t){if(1&e&&(u.TgZ(0,"button",0),u._uU(1),u.ALo(2,"i18n"),u._UZ(3,"i",1),u._uU(4,"\n"),u.qZA(),u._uU(5,"\n\n"),u.TgZ(6,"bit-menu",null,2),u._uU(8,"\n  "),u.TgZ(9,"button",3),u.NdJ("click",(function(){return t.openProjectDialog()})),u._uU(10,"\n    "),u._UZ(11,"i",4),u._uU(12),u.ALo(13,"i18n"),u.qZA(),u._uU(14,"\n  "),u.TgZ(15,"button",3),u.NdJ("click",(function(){return t.openSecretDialog()})),u._uU(16,"\n    "),u._UZ(17,"i",5),u._uU(18),u.ALo(19,"i18n"),u.qZA(),u._uU(20,"\n  "),u.TgZ(21,"button",3),u.NdJ("click",(function(){return t.openServiceAccountDialog()})),u._uU(22,"\n    "),u._UZ(23,"i",6),u._uU(24),u.ALo(25,"i18n"),u.qZA(),u._uU(26,"\n"),u.qZA(),u._uU(27,"\n")),2&e){const e=u.MAs(7);u.Q6J("bitMenuTriggerFor",e),u.xp6(1),u.hij("\n  ",u.lcZ(2,5,"new")," "),u.xp6(11),u.hij("\n    ",u.lcZ(13,7,"project"),"\n  "),u.xp6(6),u.hij("\n    ",u.lcZ(19,9,"secret"),"\n  "),u.xp6(6),u.hij("\n    ",u.lcZ(25,11,"serviceAccount"),"\n  ")}},dependencies:[De.r,vn.M,fn.t,mn.e,ge.C],encapsulation:2});const ui=function(e,t){return["/sm",e,"projects",t]};function li(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr",24),u._uU(1,"\n      "),u.TgZ(2,"td",25),u._uU(3,"\n        "),u.TgZ(4,"input",26),u.NdJ("change",(function(t){const n=u.CHM(e).$implicit,i=u.oxw(3);return u.KtG(t?i.selection.toggle(n.id):null)})),u.qZA(),u._uU(5,"\n      "),u.qZA(),u._uU(6,"\n      "),u.TgZ(7,"td",25),u._uU(8,"\n        "),u.TgZ(9,"div",27),u._uU(10,"\n          "),u._UZ(11,"i",28),u._uU(12,"\n          "),u.TgZ(13,"a",29),u._uU(14),u.qZA(),u._uU(15,"\n        "),u.qZA(),u._uU(16,"\n      "),u.qZA(),u._uU(17,"\n      "),u.TgZ(18,"td",30),u._uU(19),u.ALo(20,"date"),u.qZA(),u._uU(21,"\n      "),u.TgZ(22,"td",25),u._uU(23,"\n        "),u._UZ(24,"button",21),u.ALo(25,"i18n"),u.ALo(26,"i18n"),u._uU(27,"\n      "),u.qZA(),u._uU(28,"\n      "),u.TgZ(29,"bit-menu",null,31),u._uU(31,"\n        "),u.TgZ(32,"a",32),u._uU(33,"\n          "),u._UZ(34,"i",33),u._uU(35),u.ALo(36,"i18n"),u.qZA(),u._uU(37,"\n        "),u.YNc(38,ri,5,3,"button",34),u._uU(39,"\n        "),u.YNc(40,ai,8,3,"button",34),u._uU(41,"\n      "),u.qZA(),u._uU(42,"\n    "),u.qZA()}if(2&e){const e=t.$implicit,n=u.MAs(30),i=u.oxw(3);u.xp6(4),u.Q6J("checked",i.selection.isSelected(e.id)),u.xp6(9),u.Q6J("routerLink",u.WLB(20,ui,e.organizationId,e.id)),u.xp6(1),u.Oqu(e.name),u.xp6(5),u.Oqu(u.xi3(20,11,e.revisionDate,"medium")),u.xp6(5),u.Q6J("bitMenuTriggerFor",n)("title",u.lcZ(25,14,"options")),u.uIk("aria-label",u.lcZ(26,16,"options")),u.xp6(8),u.Q6J("routerLink",u.WLB(23,ui,e.organizationId,e.id)),u.xp6(3),u.hij("\n          ",u.lcZ(36,18,"viewProject"),"\n        "),u.xp6(3),u.Q6J("ngIf",e.write),u.xp6(2),u.Q6J("ngIf",e.write)}}function di(e,t){if(1&e&&(u._uU(0,"\n    "),u.YNc(1,li,43,26,"tr",23),u.ALo(2,"async"),u._uU(3,"\n  ")),2&e){const e=t.$implicit;u.xp6(1),u.Q6J("ngForOf",u.lcZ(2,1,e))}}const pi=function(e){return{"tw-invisible":e}};function hi(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-table",13),u._uU(1,"\n  "),u.ynx(2,14),u._uU(3,"\n    "),u.TgZ(4,"tr"),u._uU(5,"\n      "),u.TgZ(6,"th",15),u._uU(7,"\n        "),u.TgZ(8,"label",16),u._uU(9,"\n          "),u.TgZ(10,"input",17),u.NdJ("change",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(t?n.toggleAll():null)})),u.qZA(),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n      "),u.qZA(),u._uU(14,"\n      "),u.TgZ(15,"th",18),u._uU(16),u.ALo(17,"i18n"),u.qZA(),u._uU(18,"\n      "),u.TgZ(19,"th",19),u._uU(20),u.ALo(21,"i18n"),u.qZA(),u._uU(22,"\n      "),u.TgZ(23,"th",20),u.ALo(24,"async"),u._uU(25,"\n        "),u._UZ(26,"button",21),u.ALo(27,"i18n"),u.ALo(28,"i18n"),u._uU(29,"\n      "),u.qZA(),u._uU(30,"\n    "),u.qZA(),u._uU(31,"\n  "),u.BQk(),u._uU(32,"\n  "),u.YNc(33,di,4,3,"ng-template",22),u._uU(34,"\n"),u.qZA()}if(2&e){const e=u.oxw(),t=u.MAs(7);u.Q6J("dataSource",e.dataSource),u.xp6(10),u.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected()),u.xp6(1),u.hij("\n          ",u.lcZ(12,10,"all"),"\n        "),u.xp6(5),u.Oqu(u.lcZ(17,12,"name")),u.xp6(4),u.Oqu(u.lcZ(21,14,"lastEdited")),u.xp6(3),u.Q6J("ngClass",u.VKq(22,pi,!u.lcZ(24,16,e.hasWriteAccessOnSelected$))),u.xp6(3),u.Q6J("bitMenuTriggerFor",t)("title",u.lcZ(27,18,"options")),u.uIk("aria-label",u.lcZ(28,20,"options"))}}class gi{get projects(){return this._projects}set projects(e){this.selection.clear(),this._projects=e,this.dataSource.data=e}set search(e){this.selection.clear(),this.dataSource.filter=e}constructor(e,t){this.i18nService=e,this.platformUtilsService=t,this.editProjectEvent=new u.vpe,this.deleteProjectEvent=new u.vpe,this.newProjectEvent=new u.vpe,this.selection=new pn.Ov(!0,[]),this.dataSource=new hn.G,this.hasWriteAccessOnSelected$=this.selection.changed.pipe((0,D.U)((e=>this.selectedHasWriteAccess())))}isAllSelected(){var e;if((null===(e=this.selection.selected)||void 0===e?void 0:e.length)>0){return this.selection.selected.length===this.dataSource.filteredData.length}return!1}toggleAll(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.filteredData.map((e=>e.id)))}deleteProject(e){this.deleteProjectEvent.emit(this.projects.filter((t=>t.id==e)))}bulkDeleteProjects(){this.selection.selected.length>=1?this.deleteProjectEvent.emit(this.projects.filter((e=>this.selection.isSelected(e.id)))):this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"))}selectedHasWriteAccess(){return!!this.projects.filter((e=>this.selection.isSelected(e.id))).some((e=>e.write))}}gi.ɵfac=function(e){return new(e||gi)(u.Y36(rt.D),u.Y36(at.P))},gi.ɵcmp=u.Xpm({type:gi,selectors:[["sm-projects-list"]],inputs:{projects:"projects",search:"search"},outputs:{editProjectEvent:"editProjectEvent",deleteProjectEvent:"deleteProjectEvent",newProjectEvent:"newProjectEvent"},decls:19,vars:6,consts:[["class","tw-items-center tw-justify-center tw-pt-64 tw-text-center",4,"ngIf"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["tableMenu",""],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash","tw-text-danger"],[1,"tw-text-danger"],[1,"tw-items-center","tw-justify-center","tw-pt-64","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["slot","title"],["slot","description"],["type","button","slot","button","bitButton","","buttonType","secondary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"dataSource"],["header",""],["bitCell","",1,"tw-w-0"],[1,"!tw-mb-0","tw-flex","tw-w-fit","tw-gap-2","!tw-font-bold","!tw-text-muted"],["type","checkbox",3,"checked","indeterminate","change"],["bitCell","","bitSortable","name","default",""],["bitCell","","bitSortable","revisionDate"],["bitCell","",1,"tw-w-0",3,"ngClass"],["type","button","bitIconButton","bwi-ellipsis-v","buttonType","main",3,"bitMenuTriggerFor","title"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell",""],["type","checkbox",3,"checked","change"],[1,"tw-flex","tw-items-center","tw-gap-4","tw-break-all"],["aria-hidden","true",1,"bwi","bwi-collection","tw-text-muted"],["bitLink","",3,"routerLink"],["bitCell","",1,"tw-whitespace-nowrap"],["projectMenu",""],["bitMenuItem","",3,"routerLink"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-eye"],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil"]],template:function(e,t){1&e&&(u.YNc(0,si,4,0,"div",0),u._uU(1,"\n\n"),u.YNc(2,ci,16,9,"bit-no-items",1),u._uU(3,"\n\n"),u.YNc(4,hi,35,24,"bit-table",2),u._uU(5,"\n\n"),u.TgZ(6,"bit-menu",null,3),u._uU(8,"\n  "),u.TgZ(9,"button",4),u.NdJ("click",(function(){return t.bulkDeleteProjects()})),u._uU(10,"\n    "),u._UZ(11,"i",5),u._uU(12,"\n    "),u.TgZ(13,"span",6),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n"),u.qZA(),u._uU(18,"\n")),2&e&&(u.Q6J("ngIf",!t.projects),u.xp6(2),u.Q6J("ngIf",0==(null==t.projects?null:t.projects.length)),u.xp6(2),u.Q6J("ngIf",(null==t.projects?null:t.projects.length)>=1),u.xp6(10),u.Oqu(u.lcZ(15,4,"deleteProjects")))},dependencies:[s.mk,s.sg,s.O5,c.rH,De.r,M.Q,h.r,vn.M,fn.t,mn.e,Ye.a,Ge.Y,Me.v,wn.T,Ye.f,Un.M,s.Ov,s.uU,ge.C],encapsulation:2});const vi=function(e){return{"tw-text-primary-700 tw-line-through tw-decoration-primary-700 tw-opacity-50":e}};function fi(e,t){if(1&e&&(u._uU(0,"\n  "),u._UZ(1,"i",5),u.TgZ(2,"span",6),u._uU(3),u._UZ(4,"i",7),u.qZA(),u._uU(5,"\n")),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngClass",e.completed?"bwi-check tw-text-success":e.icon),u.xp6(1),u.Q6J("ngClass",u.VKq(3,vi,e.completed)),u.xp6(1),u.Oqu(e.title)}}function mi(e,t){1&e&&u.GkF(0)}function wi(e,t){if(1&e&&(u.TgZ(0,"a",8),u._uU(1,"\n    "),u.YNc(2,mi,1,0,"ng-container",9),u._uU(3,"\n  "),u.qZA()),2&e){const e=u.oxw(),t=u.MAs(1);u.Q6J("routerLink",e.route),u.xp6(2),u.Q6J("ngTemplateOutlet",t)}}function Ui(e,t){1&e&&u.GkF(0)}function Ai(e,t){if(1&e&&(u.TgZ(0,"button",10),u._uU(1,"\n    "),u.YNc(2,Ui,1,0,"ng-container",9),u._uU(3,"\n  "),u.qZA()),2&e){u.oxw();const e=u.MAs(1);u.xp6(2),u.Q6J("ngTemplateOutlet",e)}}const _i=function(e){return{"tw-opacity-50":e}};class bi{constructor(){this.completed=!1,this.icon="bwi-info-circle"}handleClick(e){e.stopPropagation()}}bi.ɵfac=function(e){return new(e||bi)},bi.ɵcmp=u.Xpm({type:bi,selectors:[["sm-onboarding-task"]],hostAttrs:[1,"tw-max-w-max"],inputs:{completed:"completed",icon:"icon",title:"title",route:"route"},ngContentSelectors:["*"],decls:15,vars:5,consts:[["content",""],[1,"tw-list-none"],["bitLink","",3,"routerLink",4,"ngIf"],["type","button","bitLink","",4,"ngIf"],[1,"tw-ml-8","tw-mt-1","tw-text-sm",3,"ngClass","click"],[1,"bwi","bwi-fw","!tw-mr-4",3,"ngClass"],[3,"ngClass"],[1,"bwi","bwi-angle-right","tw-ml-1"],["bitLink","",3,"routerLink"],[4,"ngTemplateOutlet"],["type","button","bitLink",""]],template:function(e,t){1&e&&(u.F$t(),u.YNc(0,fi,6,5,"ng-template",null,0,u.W1O),u._uU(2,"\n\n"),u.TgZ(3,"li",1),u._uU(4,"\n  "),u.YNc(5,wi,4,2,"a",2),u._uU(6,"\n  "),u.YNc(7,Ai,4,1,"button",3),u._uU(8,"\n  "),u.TgZ(9,"div",4),u.NdJ("click",(function(e){return t.handleClick(e)})),u._uU(10,"\n    "),u.Hsn(11),u._uU(12,"\n  "),u.qZA(),u._uU(13,"\n"),u.qZA(),u._uU(14,"\n")),2&e&&(u.xp6(5),u.Q6J("ngIf",t.route),u.xp6(2),u.Q6J("ngIf",!t.route),u.xp6(2),u.Q6J("ngClass",u.VKq(3,_i,t.completed)))},dependencies:[s.mk,s.O5,s.tP,c.rH,h.r,h._],encapsulation:2});var yi=n(1931);function Zi(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.hij("\n        ",u.Dn7(2,1,"complete",e.amountCompleted,e.tasks.length),"\n      ")}}function xi(e,t){1&e&&(u._uU(0,"\n  "),u._UZ(1,"i",13),u._uU(2,"\n"))}class Si{constructor(){this.dismiss=new u.vpe,this.open=!0,this.visible=!1}get amountCompleted(){return this.tasks.filter((e=>e.completed)).length}get barWidth(){return 0===this.tasks.length?0:this.amountCompleted/this.tasks.length*100}toggle(){this.open=!this.open}}function Ti(e,t){if(1&e&&(u.TgZ(0,"div",3),u._uU(1,"\n    "),u.Hsn(2,1),u._uU(3,"\n  "),u.qZA()),2&e){const e=u.oxw();u.uIk("id",e.contentId)}}Si.ɵfac=function(e){return new(e||Si)},Si.ɵcmp=u.Xpm({type:Si,selectors:[["sm-onboarding"]],contentQueries:function(e,t,n){if(1&e&&u.Suo(n,bi,4),2&e){let e;u.iGM(e=u.CRH())&&(t.tasks=e)}},inputs:{title:"title"},outputs:{dismiss:"dismiss"},ngContentSelectors:["*"],decls:36,vars:9,consts:[["open","",1,"tw-rounded-sm","tw-bg-background-alt","tw-text-main",3,"toggle"],["details",""],[1,"tw-list-none","tw-p-2","tw-px-4"],[1,"tw-flex","tw-select-none","tw-items-center","tw-gap-4"],["aria-hidden","true",1,"bwi","bwi-dashboard","tw-text-3xl","tw-text-primary-500"],[1,"tw-text-lg"],[1,"tw-flex-1",3,"showText","barWidth"],[4,"ngIf","ngIfElse"],["aria-hidden","true",1,"bwi","tw-my-auto",3,"ngClass"],[1,"tw-mb-0","tw-ml-6","tw-flex","tw-flex-col","tw-gap-4"],[1,"tw-p-4","tw-pt-0"],["bitLink","","type","button",1,"tw-ml-auto","tw-block",3,"click"],["spinner",""],[1,"bwi","bwi-spinner","bwi-spin"]],template:function(e,t){if(1&e&&(u.F$t(),u.TgZ(0,"details",0,1),u.NdJ("toggle",(function(){return t.toggle()})),u._uU(2,"\n  "),u.TgZ(3,"summary",2),u._uU(4,"\n    "),u.TgZ(5,"div",3),u._uU(6,"\n      "),u._UZ(7,"i",4),u._uU(8,"\n      "),u.TgZ(9,"div",5),u._uU(10),u.qZA(),u._uU(11,"\n      "),u._UZ(12,"bit-progress",6),u._uU(13,"\n      "),u.YNc(14,Zi,3,5,"span",7),u._uU(15,"\n      "),u._UZ(16,"i",8),u._uU(17,"\n    "),u.qZA(),u._uU(18,"\n  "),u.qZA(),u._uU(19,"\n  "),u.TgZ(20,"ul",9),u._uU(21,"\n    "),u.Hsn(22),u._uU(23,"\n  "),u.qZA(),u._uU(24,"\n  "),u.TgZ(25,"div",10),u._uU(26,"\n    "),u.TgZ(27,"button",11),u.NdJ("click",(function(){return t.dismiss.emit()})),u._uU(28),u.ALo(29,"i18n"),u.qZA(),u._uU(30,"\n  "),u.qZA(),u._uU(31,"\n"),u.qZA(),u._uU(32,"\n\n"),u.YNc(33,xi,3,0,"ng-template",null,12,u.W1O),u._uU(35,"\n")),2&e){const e=u.MAs(34);u.xp6(10),u.Oqu(t.title),u.xp6(2),u.Q6J("showText",!1)("barWidth",t.barWidth),u.xp6(2),u.Q6J("ngIf",t.tasks.length>0)("ngIfElse",e),u.xp6(2),u.Q6J("ngClass",t.open?"bwi-angle-down":"bwi-angle-up"),u.xp6(12),u.hij("\n      ",u.lcZ(29,7,"dismiss"),"\n    ")}},dependencies:[s.mk,s.O5,h._,yi.t,ge.C],encapsulation:2});const Ii=[[["","slot","summary"]],"*"];class Pi{constructor(){this.open=!0,this.contentId=Math.random().toString(36).substring(2)}toggle(){this.open=!this.open}}Pi.ɵfac=function(e){return new(e||Pi)},Pi.ɵcmp=u.Xpm({type:Pi,selectors:[["sm-section"]],inputs:{open:"open"},ngContentSelectors:["[slot=summary]","*"],decls:13,vars:4,consts:[[1,"tw-flex","tw-max-w-min","tw-items-center","tw-gap-2"],["type","button",3,"bitIconButton","click"],["class","tw-mt-4",4,"ngIf"],[1,"tw-mt-4"]],template:function(e,t){1&e&&(u.F$t(Ii),u.TgZ(0,"section"),u._uU(1,"\n  "),u.TgZ(2,"header",0),u._uU(3,"\n    "),u.TgZ(4,"div"),u.Hsn(5),u.qZA(),u._uU(6,"\n    "),u.TgZ(7,"button",1),u.NdJ("click",(function(){return t.toggle()})),u.qZA(),u._uU(8,"\n  "),u.qZA(),u._uU(9,"\n  "),u.YNc(10,Ti,4,1,"div",2),u._uU(11,"\n"),u.qZA(),u._uU(12,"\n")),2&e&&(u.xp6(7),u.Q6J("bitIconButton",t.open?"bwi-angle-up":"bwi-angle-down"),u.uIk("aria-expanded",t.open)("aria-controls",t.contentId),u.xp6(3),u.Q6J("ngIf",t.open))},dependencies:[s.O5,M.Q],encapsulation:2});var qi=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function ji(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"sm-onboarding-task",16),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(3);return u.KtG(t.openNewProjectDialog())})),u.ALo(1,"i18n"),u.qZA()}if(2&e){const e=u.oxw(2).ngIf;u.Q6J("title",u.lcZ(1,2,"createProject"))("completed",e.tasks.createProject)}}const ki=function(){return["settings","import"]};function Ci(e,t){if(1&e&&(u._UZ(0,"sm-onboarding-task",17),u.ALo(1,"i18n")),2&e){const e=u.oxw(2).ngIf;u.Q6J("title",u.lcZ(1,3,"importSecrets"))("route",u.DdM(5,ki))("completed",e.tasks.importSecrets)}}function Li(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"sm-onboarding-task",18),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(3);return u.KtG(t.openSecretDialog())})),u.ALo(1,"i18n"),u.qZA()}if(2&e){const e=u.oxw(2).ngIf;u.Q6J("title",u.lcZ(1,2,"createSecret"))("completed",e.tasks.createSecret)}}function Oi(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"sm-onboarding",9),u.NdJ("dismiss",(function(){u.CHM(e);const t=u.oxw(2);return u.KtG(t.hideOnboarding())})),u.ALo(1,"i18n"),u._uU(2,"\n    "),u.TgZ(3,"sm-onboarding-task",10),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(2);return u.KtG(t.openServiceAccountDialog())})),u.ALo(4,"i18n"),u._uU(5,"\n      "),u.TgZ(6,"span",11),u._uU(7),u.ALo(8,"i18n"),u.TgZ(9,"a",12),u._uU(10),u.ALo(11,"i18n"),u.qZA(),u._uU(12,"\n      "),u.qZA(),u._uU(13,"\n    "),u.qZA(),u._uU(14,"\n    "),u.YNc(15,ji,2,4,"sm-onboarding-task",13),u._uU(16,"\n    "),u.YNc(17,Ci,2,6,"sm-onboarding-task",14),u._uU(18,"\n    "),u.YNc(19,Li,2,4,"sm-onboarding-task",15),u._uU(20,"\n  "),u.qZA()}if(2&e){const e=u.oxw().ngIf,t=u.oxw();u.Q6J("title",u.lcZ(1,8,"getStarted")),u.xp6(3),u.Q6J("title",u.lcZ(4,10,"createServiceAccount"))("completed",e.tasks.createServiceAccount),u.xp6(4),u.hij("\n        ",u.lcZ(8,12,"downloadThe"),"\n        "),u.xp6(3),u.Oqu(u.lcZ(11,14,"smCLI")),u.xp6(5),u.Q6J("ngIf",t.userIsAdmin),u.xp6(2),u.Q6J("ngIf",t.userIsAdmin),u.xp6(2),u.Q6J("ngIf",e.tasks.createProject)}}function Ni(e,t){if(1&e&&(u.TgZ(0,"div",19),u._uU(1),u.ALo(2,"i18n"),u.TgZ(3,"a",20),u._uU(4),u.ALo(5,"i18n"),u.qZA(),u._uU(6,"\n      "),u.qZA()),2&e){const e=u.oxw().ngIf;u.xp6(1),u.hij("\n        ",u.Dn7(2,2,"showingPortionOfTotal",e.latestProjects.length,e.allProjects.length),"\n        "),u.xp6(3),u.Oqu(u.lcZ(5,6,"viewAll"))}}function Ji(e,t){if(1&e&&(u.TgZ(0,"div",19),u._uU(1),u.ALo(2,"i18n"),u.TgZ(3,"a",21),u._uU(4),u.ALo(5,"i18n"),u.qZA(),u._uU(6,"\n      "),u.qZA()),2&e){const e=u.oxw().ngIf;u.xp6(1),u.hij("\n        ",u.Dn7(2,2,"showingPortionOfTotal",e.latestSecrets.length,e.allSecrets.length),"\n        "),u.xp6(3),u.Oqu(u.lcZ(5,6,"viewAll"))}}function Di(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div"),u._uU(1,"\n  "),u.YNc(2,Oi,21,16,"sm-onboarding",3),u._uU(3,"\n\n  "),u.TgZ(4,"div",4),u._uU(5,"\n    "),u.TgZ(6,"sm-section"),u._uU(7,"\n      "),u.TgZ(8,"h2",5),u._uU(9),u.ALo(10,"i18n"),u.qZA(),u._uU(11,"\n      "),u.TgZ(12,"sm-projects-list",6),u.NdJ("newProjectEvent",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.openNewProjectDialog())}))("editProjectEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.openEditProject(t))}))("deleteProjectEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.openDeleteProjectDialog(t))})),u.qZA(),u._uU(13,"\n      "),u.YNc(14,Ni,7,8,"div",7),u._uU(15,"\n    "),u.qZA(),u._uU(16,"\n    "),u.TgZ(17,"sm-section"),u._uU(18,"\n      "),u.TgZ(19,"h2",5),u._uU(20),u.ALo(21,"i18n"),u.qZA(),u._uU(22,"\n      "),u.TgZ(23,"sm-secrets-list",8),u.NdJ("deleteSecretsEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.openDeleteSecret(t))}))("newSecretEvent",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.openNewSecretDialog())}))("editSecretEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.openEditSecret(t))}))("copySecretNameEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.copySecretName(t))}))("copySecretValueEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.copySecretValue(t))}))("copySecretUuidEvent",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.copySecretUuid(t))})),u.qZA(),u._uU(24,"\n      "),u.YNc(25,Ji,7,8,"div",7),u._uU(26,"\n    "),u.qZA(),u._uU(27,"\n  "),u.qZA(),u._uU(28,"\n"),u.qZA()}if(2&e){const e=t.ngIf,n=u.oxw();u.xp6(2),u.Q6J("ngIf",n.showOnboarding),u.xp6(7),u.Oqu(u.lcZ(10,7,"projects")),u.xp6(3),u.Q6J("projects",e.latestProjects),u.xp6(2),u.Q6J("ngIf",e.allProjects.length>0),u.xp6(6),u.Oqu(u.lcZ(21,9,"secrets")),u.xp6(3),u.Q6J("secrets",e.latestSecrets),u.xp6(2),u.Q6J("ngIf",e.allSecrets.length>0)}}function Ei(e,t){1&e&&(u._uU(0,"\n  "),u.TgZ(1,"div",22),u._uU(2,"\n    "),u._UZ(3,"i",23),u._uU(4,"\n  "),u.qZA(),u._uU(5,"\n"))}class zi{constructor(e,t,n,i,o,s,c,r,a){this.route=e,this.projectService=t,this.secretService=n,this.serviceAccountService=i,this.dialogService=o,this.organizationService=s,this.stateService=c,this.platformUtilsService=r,this.i18nService=a,this.destroy$=new Pe.x,this.tableSize=10,this.showOnboarding=!1,this.loading=!0,this.organizationEnabled=!1}ngOnInit(){const e=this.route.params.pipe((0,D.U)((e=>e.organizationId)),(0,qe.x)());e.pipe((0,D.U)((e=>this.organizationService.get(e))),(0,je.R)(this.destroy$)).subscribe((e=>{this.organizationId=e.id,this.organizationName=e.name,this.userIsAdmin=e.isAdmin,this.loading=!0,this.organizationEnabled=e.enabled}));const t=(0,pe.a)([e,this.projectService.project$.pipe((0,ke.O)(null))]).pipe((0,Ce.w)((([e])=>this.projectService.getProjects(e))),(0,Le.B)()),n=(0,pe.a)([e,this.secretService.secret$.pipe((0,ke.O)(null)),this.projectService.project$.pipe((0,ke.O)(null))]).pipe((0,Ce.w)((([e])=>this.secretService.getSecrets(e))),(0,Le.B)()),i=(0,pe.a)([e,this.serviceAccountService.serviceAccount$.pipe((0,ke.O)(null))]).pipe((0,Ce.w)((([e])=>this.serviceAccountService.getServiceAccounts(e,!1))),(0,Le.B)());this.view$=e.pipe((0,Ce.w)((e=>(0,pe.a)([t,n,i]).pipe((0,Ce.w)((([t,n,i])=>qi(this,void 0,void 0,(function*(){return{latestProjects:this.getRecentItems(t,this.tableSize),latestSecrets:this.getRecentItems(n,this.tableSize),allProjects:t,allSecrets:n,tasks:yield this.saveCompletedTasks(e,{importSecrets:n.length>0,createSecret:n.length>0,createProject:t.length>0,createServiceAccount:i.length>0})}})))))))),e.pipe((0,Ce.w)((()=>this.view$.pipe((0,Oe.q)(1)))),(0,je.R)(this.destroy$)).subscribe((e=>{this.showOnboarding=Object.values(e.tasks).includes(!1),this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getRecentItems(e,t){return e.sort(((e,t)=>new Date(t.revisionDate).getTime()-new Date(e.revisionDate).getTime())).slice(0,t)}saveCompletedTasks(e,t){return qi(this,void 0,void 0,(function*(){const n=(yield this.stateService.getSMOnboardingTasks())||{},i=Object.fromEntries(Object.entries(t).filter((([e,t])=>!0===t))),o=Object.assign(Object.assign({importSecrets:!1,createSecret:!1,createProject:!1,createServiceAccount:!1},n[e]),i);return this.stateService.setSMOnboardingTasks(Object.assign(Object.assign({},n),{[e]:o})),o}))}openEditProject(e){this.dialogService.open(St,{data:{organizationId:this.organizationId,operation:Gt.Edit,organizationEnabled:this.organizationEnabled,projectId:e}})}openNewProjectDialog(){this.dialogService.open(St,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}openServiceAccountDialog(){this.dialogService.open(dn,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}openDeleteProjectDialog(e){this.dialogService.open(Ut,{data:{projects:e}})}openSecretDialog(){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}openEditSecret(e){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Edit,secretId:e,organizationEnabled:this.organizationEnabled}})}openDeleteSecret(e){this.dialogService.open(Yt,{data:{secrets:e}})}openNewSecretDialog(){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}copySecretName(e){Dn.copySecretName(e,this.platformUtilsService,this.i18nService)}copySecretValue(e){Dn.copySecretValue(e,this.platformUtilsService,this.i18nService,this.secretService)}copySecretUuid(e){Dn.copySecretUuid(e,this.platformUtilsService,this.i18nService)}hideOnboarding(){this.showOnboarding=!1,this.saveCompletedTasks(this.organizationId,{importSecrets:!0,createSecret:!0,createProject:!0,createServiceAccount:!0})}}zi.ɵfac=function(e){return new(e||zi)(u.Y36(c.gz),u.Y36(ct),u.Y36(Nt),u.Y36(cn),u.Y36(ut.x),u.Y36(j.Mn),u.Y36(En.b),u.Y36(at.P),u.Y36(rt.D))},zi.ɵcmp=u.Xpm({type:zi,selectors:[["sm-overview"]],decls:11,vars:5,consts:[[3,"title"],[4,"ngIf","ngIfElse"],["spinner",""],[3,"title","dismiss",4,"ngIf"],[1,"tw-mt-6","tw-flex","tw-flex-col","tw-gap-6"],["slot","summary","bitTypography","h2","noMargin","",1,"tw-mb-0"],[3,"projects","newProjectEvent","editProjectEvent","deleteProjectEvent"],["class","tw-ml-auto tw-mt-4 tw-max-w-max",4,"ngIf"],["baseRoute","secrets",3,"secrets","deleteSecretsEvent","newSecretEvent","editSecretEvent","copySecretNameEvent","copySecretValueEvent","copySecretUuidEvent"],[3,"title","dismiss"],["icon","bwi-cli",3,"title","completed","click"],[1,"tw-pl-1"],["bitLink","","href","https://bitwarden.com/help/secrets-manager-cli/","target","_blank"],["icon","bwi-collection",3,"title","completed","click",4,"ngIf"],["icon","bwi-download",3,"title","route","completed",4,"ngIf"],["icon","bwi-key",3,"title","completed","click",4,"ngIf"],["icon","bwi-collection",3,"title","completed","click"],["icon","bwi-download",3,"title","route","completed"],["icon","bwi-key",3,"title","completed","click"],[1,"tw-ml-auto","tw-mt-4","tw-max-w-max"],["bitLink","","routerLink","projects",1,"tw-ml-2"],["bitLink","","routerLink","secrets",1,"tw-ml-2"],[1,"tw-items-center","tw-justify-center","tw-pt-64","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"]],template:function(e,t){if(1&e&&(u.TgZ(0,"app-header",0),u._uU(1,"\n  "),u._UZ(2,"sm-new-menu"),u._uU(3,"\n"),u.qZA(),u._uU(4,"\n\n"),u.YNc(5,Di,29,11,"div",1),u.ALo(6,"async"),u._uU(7,"\n\n"),u.YNc(8,Ei,6,0,"ng-template",null,2,u.W1O),u._uU(10,"\n")),2&e){const e=u.MAs(9);u.Q6J("title",t.organizationName),u.xp6(5),u.Q6J("ngIf",u.lcZ(6,3,!t.loading&&t.view$))("ngIfElse",e)}},dependencies:[ii,oi,gi,Dn,s.O5,c.rH,h.r,Rn.t,Si,bi,Pi,s.Ov,ge.C],encapsulation:2});const Yi=[{path:"",component:zi}];class Gi{}Gi.ɵfac=function(e){return new(e||Gi)},Gi.ɵmod=u.oAB({type:Gi}),Gi.ɵinj=u.cJS({imports:[c.Bz.forChild(Yi),c.Bz]});class Mi{}Mi.ɵfac=function(e){return new(e||Mi)},Mi.ɵmod=u.oAB({type:Mi}),Mi.ɵinj=u.cJS({imports:[I,Gi,Ie]});var Qi,Ri,Bi=n(40857),Fi=n(79596),$i=n(83464);!function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.ServiceAccount=2]="ServiceAccount",e[e.Project=3]="Project"}(Qi||(Qi={}));class Vi{static itemIcon(e){switch(e){case Qi.User:return"bwi-user";case Qi.Group:return"bwi-family";case Qi.ServiceAccount:return"bwi-wrench";case Qi.Project:return"bwi-collection"}}}!function(e){e.CanRead="canRead",e.CanReadWrite="canReadWrite"}(Ri||(Ri={}));class Ki{static toApPermissionEnum(e,t){if(e&&t)return Ri.CanReadWrite;if(e)return Ri.CanRead;throw new Error("Unsupported Access Policy Permission option")}static toRead(e){return e==Ri.CanRead||e==Ri.CanReadWrite}static toWrite(e){return e===Ri.CanReadWrite}}var Hi=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Wi{constructor(e){this.organizationService=e}showAccessRemovalWarning(e,t){return Hi(this,void 0,void 0,(function*(){const n=this.organizationService.get(e);if(n.isOwner||n.isAdmin)return!1;const i=t.find((e=>e.type===Qi.User&&e.currentUser&&e.permission===Ri.CanReadWrite)),o=t.filter((e=>e.type===Qi.Group&&e.permission==Ri.CanReadWrite&&e.currentUserInGroup));return(null==o||0==o.length)&&null==i}))}isAccessRemoval(e,t){return 0!==(null==e?void 0:e.length)&&(0===(null==t?void 0:t.length)||this.isAnyCurrentIdNotInSelectedIds(e,t))}isAnyCurrentIdNotInSelectedIds(e,t){const n=e.map((e=>e.id)),i=t.map((e=>e.id));return!n.every((e=>i.includes(e)))}}Wi.ɵfac=function(e){return new(e||Wi)(u.LFG(j.Mn))},Wi.ɵprov=u.Yz7({token:Wi,factory:Wi.ɵfac,providedIn:"root"});class Xi{}class eo extends Xi{}class to extends Xi{}class no extends Xi{}class io extends Xi{}class oo extends Xi{}class so{}class co{}class ro{}function ao(e){const t=[];return e.userAccessPolicies.forEach((e=>{t.push({type:Qi.User,icon:Vi.itemIcon(Qi.User),id:e.organizationUserId,accessPolicyId:e.id,labelName:e.organizationUserName,listName:e.organizationUserName,permission:Ki.toApPermissionEnum(e.read,e.write),userId:e.userId,currentUser:e.currentUser})})),e.groupAccessPolicies.forEach((e=>{t.push({type:Qi.Group,icon:Vi.itemIcon(Qi.Group),id:e.groupId,accessPolicyId:e.id,labelName:e.groupName,listName:e.groupName,permission:Ki.toApPermissionEnum(e.read,e.write),currentUserInGroup:e.currentUserInGroup})})),t}function uo(e){return e.map((e=>{let t,n,i=e.name,o=e.name;switch(e.type){case"user":t=Vi.itemIcon(Qi.User),n=Qi.User,Qt.c.isNullOrWhitespace(e.name)?(i=e.email,o=e.email):i=`${e.name} (${e.email})`;break;case"group":t=Vi.itemIcon(Qi.Group),n=Qi.Group;break;case"serviceAccount":t=Vi.itemIcon(Qi.ServiceAccount),n=Qi.ServiceAccount;break;case"project":t=Vi.itemIcon(Qi.Project),n=Qi.Project}return{icon:t,type:n,id:e.id,labelName:o,listName:i,currentUserInGroup:e.currentUserInGroup,currentUser:e.currentUser}}))}class lo{}class po{}class ho{}class go extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.read=this.getResponseProperty("Read"),this.write=this.getResponseProperty("Write"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate")}}class vo extends go{constructor(e){super(e),this.organizationUserId=this.getResponseProperty("OrganizationUserId"),this.organizationUserName=this.getResponseProperty("OrganizationUserName"),this.grantedProjectId=this.getResponseProperty("GrantedProjectId"),this.userId=this.getResponseProperty("UserId"),this.currentUser=this.getResponseProperty("CurrentUser")}}class fo extends go{constructor(e){super(e),this.organizationUserId=this.getResponseProperty("OrganizationUserId"),this.organizationUserName=this.getResponseProperty("OrganizationUserName"),this.grantedServiceAccountId=this.getResponseProperty("GrantedServiceAccountId"),this.userId=this.getResponseProperty("UserId"),this.currentUser=this.getResponseProperty("CurrentUser")}}class mo extends go{constructor(e){super(e),this.groupId=this.getResponseProperty("GroupId"),this.groupName=this.getResponseProperty("GroupName"),this.grantedProjectId=this.getResponseProperty("GrantedProjectId"),this.currentUserInGroup=this.getResponseProperty("CurrentUserInGroup")}}class wo extends go{constructor(e){super(e),this.groupId=this.getResponseProperty("GroupId"),this.groupName=this.getResponseProperty("GroupName"),this.grantedServiceAccountId=this.getResponseProperty("GrantedServiceAccountId"),this.currentUserInGroup=this.getResponseProperty("CurrentUserInGroup")}}class Uo extends go{constructor(e){super(e),this.serviceAccountId=this.getResponseProperty("ServiceAccountId"),this.serviceAccountName=this.getResponseProperty("ServiceAccountName"),this.grantedProjectId=this.getResponseProperty("GrantedProjectId"),this.grantedProjectName=this.getResponseProperty("GrantedProjectName")}}class Ao extends Xe.c{constructor(e){super(e);const t=this.getResponseProperty("UserAccessPolicies");this.userAccessPolicies=t.map((e=>new vo(e)));const n=this.getResponseProperty("GroupAccessPolicies");this.groupAccessPolicies=n.map((e=>new mo(e)));const i=this.getResponseProperty("ServiceAccountAccessPolicies");this.serviceAccountAccessPolicies=i.map((e=>new Uo(e)))}}class _o{}class bo{}class yo{}class Zo extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.name=this.getResponseProperty("Name"),this.type=this.getResponseProperty("Type"),this.email=this.getResponseProperty("Email"),this.currentUserInGroup=this.getResponseProperty("CurrentUserInGroup"),this.currentUser=this.getResponseProperty("CurrentUser")}}class xo extends Xe.c{constructor(e){super(e);const t=this.getResponseProperty("UserAccessPolicies");this.userAccessPolicies=t.map((e=>new vo(e)));const n=this.getResponseProperty("GroupAccessPolicies");this.groupAccessPolicies=n.map((e=>new mo(e)))}}class So extends Xe.c{constructor(e){super(e);const t=this.getResponseProperty("UserAccessPolicies");this.userAccessPolicies=t.map((e=>new fo(e)));const n=this.getResponseProperty("GroupAccessPolicies");this.groupAccessPolicies=n.map((e=>new wo(e)))}}var To=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Io{constructor(e,t,n){this.cryptoService=e,this.apiService=t,this.encryptService=n,this._projectAccessPolicyChanges$=new Pe.x,this._serviceAccountGrantedPolicyChanges$=new Pe.x,this.projectAccessPolicyChanges$=this._projectAccessPolicyChanges$.asObservable(),this.serviceAccountGrantedPolicyChanges$=this._serviceAccountGrantedPolicyChanges$.asObservable()}refreshProjectAccessPolicyChanges(){this._projectAccessPolicyChanges$.next(null)}getGrantedPolicies(e,t){return To(this,void 0,void 0,(function*(){const n=yield this.apiService.send("GET","/service-accounts/"+e+"/granted-policies",null,!0,!0),i=new $e.L(n,Uo);return yield this.createServiceAccountProjectAccessPolicyViews(i.data,t)}))}createGrantedPolicies(e,t,n){return To(this,void 0,void 0,(function*(){const i=this.getGrantedPoliciesCreateRequest(n),o=yield this.apiService.send("POST","/service-accounts/"+t+"/granted-policies",i,!0,!0),s=new $e.L(o,Uo),c=yield this.createServiceAccountProjectAccessPolicyViews(s.data,e);return this._serviceAccountGrantedPolicyChanges$.next(c),c}))}getProjectAccessPolicies(e,t){return To(this,void 0,void 0,(function*(){const n=yield this.apiService.send("GET","/projects/"+t+"/access-policies",null,!0,!0),i=new Ao(n);return yield this.createProjectAccessPoliciesView(e,i)}))}getProjectPeopleAccessPolicies(e){return To(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/projects/"+e+"/access-policies/people",null,!0,!0),n=new xo(t);return this.createProjectPeopleAccessPoliciesView(n)}))}putProjectPeopleAccessPolicies(e,t){return To(this,void 0,void 0,(function*(){const n=this.getPeopleAccessPoliciesRequest(t),i=yield this.apiService.send("PUT","/projects/"+e+"/access-policies/people",n,!0,!0),o=new xo(i);return this.createProjectPeopleAccessPoliciesView(o)}))}getServiceAccountPeopleAccessPolicies(e){return To(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/service-accounts/"+e+"/access-policies/people",null,!0,!0),n=new So(t);return this.createServiceAccountPeopleAccessPoliciesView(n)}))}putServiceAccountPeopleAccessPolicies(e,t){return To(this,void 0,void 0,(function*(){const n=this.getPeopleAccessPoliciesRequest(t),i=yield this.apiService.send("PUT","/service-accounts/"+e+"/access-policies/people",n,!0,!0),o=new So(i);return this.createServiceAccountPeopleAccessPoliciesView(o)}))}createProjectAccessPolicies(e,t,n){return To(this,void 0,void 0,(function*(){const i=this.getAccessPoliciesCreateRequest(n),o=yield this.apiService.send("POST","/projects/"+t+"/access-policies",i,!0,!0),s=new Ao(o),c=yield this.createProjectAccessPoliciesView(e,s);return this._projectAccessPolicyChanges$.next(c),c}))}deleteAccessPolicy(e){return To(this,void 0,void 0,(function*(){yield this.apiService.send("DELETE","/access-policies/"+e,null,!0,!1),this._projectAccessPolicyChanges$.next(null),this._serviceAccountGrantedPolicyChanges$.next(null)}))}updateAccessPolicy(e){return To(this,void 0,void 0,(function*(){const t=new _o;t.read=e.read,t.write=e.write,yield this.apiService.send("PUT","/access-policies/"+e.id,t,!0,!0)}))}createProjectAccessPoliciesView(e,t){return To(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e),i=new so;return i.userAccessPolicies=t.userAccessPolicies.map((e=>this.createUserProjectAccessPolicyView(e))),i.groupAccessPolicies=t.groupAccessPolicies.map((e=>this.createGroupProjectAccessPolicyView(e))),i.serviceAccountAccessPolicies=yield Promise.all(t.serviceAccountAccessPolicies.map((e=>To(this,void 0,void 0,(function*(){return yield this.createServiceAccountProjectAccessPolicyView(n,e)}))))),i}))}createProjectPeopleAccessPoliciesView(e){const t=new co;return t.userAccessPolicies=e.userAccessPolicies.map((e=>this.createUserProjectAccessPolicyView(e))),t.groupAccessPolicies=e.groupAccessPolicies.map((e=>this.createGroupProjectAccessPolicyView(e))),t}createServiceAccountPeopleAccessPoliciesView(e){const t=new ro;return t.userAccessPolicies=e.userAccessPolicies.map((e=>this.createUserServiceAccountAccessPolicyView(e))),t.groupAccessPolicies=e.groupAccessPolicies.map((e=>this.createGroupServiceAccountAccessPolicyView(e))),t}getAccessPoliciesCreateRequest(e){var t,n,i;const o=new po;return(null===(t=e.userAccessPolicies)||void 0===t?void 0:t.length)>0&&(o.userAccessPolicyRequests=e.userAccessPolicies.map((e=>this.getAccessPolicyRequest(e.organizationUserId,e)))),(null===(n=e.groupAccessPolicies)||void 0===n?void 0:n.length)>0&&(o.groupAccessPolicyRequests=e.groupAccessPolicies.map((e=>this.getAccessPolicyRequest(e.groupId,e)))),(null===(i=e.serviceAccountAccessPolicies)||void 0===i?void 0:i.length)>0&&(o.serviceAccountAccessPolicyRequests=e.serviceAccountAccessPolicies.map((e=>this.getAccessPolicyRequest(e.serviceAccountId,e)))),o}getPeopleAccessPoliciesRequest(e){var t,n;const i=new ho;return(null===(t=e.userAccessPolicies)||void 0===t?void 0:t.length)>0&&(i.userAccessPolicyRequests=e.userAccessPolicies.map((e=>this.getAccessPolicyRequest(e.organizationUserId,e)))),(null===(n=e.groupAccessPolicies)||void 0===n?void 0:n.length)>0&&(i.groupAccessPolicyRequests=e.groupAccessPolicies.map((e=>this.getAccessPolicyRequest(e.groupId,e)))),i}createUserProjectAccessPolicyView(e){return Object.assign(Object.assign({},this.createBaseAccessPolicyView(e)),{grantedProjectId:e.grantedProjectId,organizationUserId:e.organizationUserId,organizationUserName:e.organizationUserName,userId:e.userId,currentUser:e.currentUser})}createGroupProjectAccessPolicyView(e){return Object.assign(Object.assign({},this.createBaseAccessPolicyView(e)),{grantedProjectId:e.grantedProjectId,groupId:e.groupId,groupName:e.groupName,currentUserInGroup:e.currentUserInGroup})}createServiceAccountProjectAccessPolicyView(e,t){return To(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},this.createBaseAccessPolicyView(t)),{grantedProjectId:t.grantedProjectId,serviceAccountId:t.serviceAccountId,grantedProjectName:t.grantedProjectName?yield this.encryptService.decryptToUtf8(new Ve._(t.grantedProjectName),e):null,serviceAccountName:t.serviceAccountName?yield this.encryptService.decryptToUtf8(new Ve._(t.serviceAccountName),e):null})}))}createUserServiceAccountAccessPolicyView(e){return Object.assign(Object.assign({},this.createBaseAccessPolicyView(e)),{grantedServiceAccountId:e.grantedServiceAccountId,organizationUserId:e.organizationUserId,organizationUserName:e.organizationUserName,userId:e.userId,currentUser:e.currentUser})}createGroupServiceAccountAccessPolicyView(e){return Object.assign(Object.assign({},this.createBaseAccessPolicyView(e)),{grantedServiceAccountId:e.grantedServiceAccountId,groupId:e.groupId,groupName:e.groupName,currentUserInGroup:e.currentUserInGroup})}getPeoplePotentialGrantees(e){return To(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/organizations/"+e+"/access-policies/people/potential-grantees",null,!0,!0),n=new $e.L(t,Zo);return yield this.createPotentialGranteeViews(e,n.data)}))}getServiceAccountsPotentialGrantees(e){return To(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/organizations/"+e+"/access-policies/service-accounts/potential-grantees",null,!0,!0),n=new $e.L(t,Zo);return yield this.createPotentialGranteeViews(e,n.data)}))}getProjectsPotentialGrantees(e){return To(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/organizations/"+e+"/access-policies/projects/potential-grantees",null,!0,!0),n=new $e.L(t,Zo);return yield this.createPotentialGranteeViews(e,n.data)}))}getOrganizationKey(e){return To(this,void 0,void 0,(function*(){return yield this.cryptoService.getOrgKey(e)}))}getAccessPolicyRequest(e,t){const n=new bo;return n.granteeId=e,n.read=t.read,n.write=t.write,n}createBaseAccessPolicyView(e){return{id:e.id,read:e.read,write:e.write,creationDate:e.creationDate,revisionDate:e.revisionDate}}createPotentialGranteeViews(e,t){return To(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e);return yield Promise.all(t.map((e=>To(this,void 0,void 0,(function*(){const t=new lo;return t.id=e.id,t.type=e.type,t.email=e.email,t.currentUser=e.currentUser,t.currentUserInGroup=e.currentUserInGroup,"serviceAccount"===e.type||"project"===e.type?t.name=e.name?yield this.encryptService.decryptToUtf8(new Ve._(e.name),n):null:t.name=e.name,t})))))}))}getGrantedPoliciesCreateRequest(e){return e.map((e=>{const t=new yo;return t.grantedId=e.grantedProjectId,t.read=e.read,t.write=e.write,t}))}createServiceAccountProjectAccessPolicyViews(e,t){return To(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(t);return yield Promise.all(e.map((e=>To(this,void 0,void 0,(function*(){const t=new oo;return t.id=e.id,t.read=e.read,t.write=e.write,t.creationDate=e.creationDate,t.revisionDate=e.revisionDate,t.serviceAccountId=e.serviceAccountId,t.grantedProjectId=e.grantedProjectId,t.serviceAccountName=e.serviceAccountName?yield this.encryptService.decryptToUtf8(new Ve._(e.serviceAccountName),n):null,t.grantedProjectName=e.grantedProjectName?yield this.encryptService.decryptToUtf8(new Ve._(e.grantedProjectName),n):null,t})))))}))}}Io.ɵfac=function(e){return new(e||Io)(u.LFG(nt.$),u.LFG(it.s),u.LFG(ot.U))},Io.ɵprov=u.Yz7({token:Io,factory:Io.ɵfac,providedIn:"root"});var Po=n(14494),qo=n(33218),jo=n(6378),ko=n(44358);function Co(e,t){if(1&e){const e=u.EpF();u.ynx(0),u._uU(1,"\n    "),u.TgZ(2,"bit-form-field",6),u._uU(3,"\n      "),u.TgZ(4,"bit-label"),u._uU(5),u.qZA(),u._uU(6,"\n      "),u.TgZ(7,"bit-multi-select",7),u.NdJ("blur",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.handleBlur())}))("onItemsConfirmed",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(n.selectItems(t))})),u.qZA(),u._uU(8,"\n      "),u.TgZ(9,"bit-hint"),u._uU(10),u.qZA(),u._uU(11,"\n    "),u.qZA(),u._uU(12,"\n  "),u.BQk()}if(2&e){const e=u.oxw();u.xp6(5),u.Oqu(e.label),u.xp6(2),u.Q6J("loading",e.loading)("baseItems",e.selectionList.deselectedItems)("disabled",e.disabled)("removeSelectedItems",!0),u.xp6(3),u.Oqu(e.hint)}}function Lo(e,t){if(1&e&&(u.TgZ(0,"option",25),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e.perm),u.xp6(1),u.hij("\n              ",u.lcZ(2,2,e.labelId),"\n            ")}}function Oo(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"select",23),u.NdJ("blur",(function(){u.CHM(e);const t=u.oxw(5);return u.KtG(t.handleBlur())})),u._uU(1,"\n            "),u.YNc(2,Lo,3,4,"option",24),u._uU(3,"\n          "),u.qZA()}if(2&e){const e=u.oxw(5);u.xp6(2),u.Q6J("ngForOf",e.permissionList)}}function No(e,t){if(1&e&&(u._uU(0,"\n            "),u.TgZ(1,"span"),u._uU(2),u.ALo(3,"i18n"),u.qZA(),u._uU(4,"\n          ")),2&e){const e=u.oxw(5);u.xp6(2),u.Oqu(u.lcZ(3,1,e.staticPermission))}}function Jo(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr",14),u._uU(1,"\n        "),u.TgZ(2,"td",15),u._uU(3,"\n          "),u._UZ(4,"i",16),u._uU(5,"\n        "),u.qZA(),u._uU(6,"\n        "),u.TgZ(7,"td",17),u._uU(8),u.qZA(),u._uU(9,"\n        "),u.TgZ(10,"td",18),u._uU(11,"\n          "),u.YNc(12,Oo,4,1,"select",19),u._uU(13,"\n          "),u.YNc(14,No,5,3,"ng-template",null,20,u.W1O),u._uU(16,"\n        "),u.qZA(),u._uU(17,"\n        "),u.TgZ(18,"td",21),u._uU(19,"\n          "),u.TgZ(20,"button",22),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,n=u.oxw(4);return n.selectionList.deselectItem(t.id),u.KtG(n.handleBlur())})),u.ALo(21,"i18n"),u.ALo(22,"i18n"),u.qZA(),u._uU(23,"\n        "),u.qZA(),u._uU(24,"\n      "),u.qZA()}if(2&e){const e=t.$implicit,n=t.index,i=u.MAs(15),o=u.oxw(4);u.Q6J("formGroupName",n),u.xp6(4),u.Gre("bwi ",e.icon," tw-text-muted"),u.xp6(4),u.Oqu(e.labelName),u.xp6(4),u.Q6J("ngIf",!o.staticPermission)("ngIfElse",i),u.xp6(8),u.uIk("title",u.lcZ(21,9,"remove"))("aria-label",u.lcZ(22,11,"remove"))}}function Do(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n      "),u.YNc(2,Jo,25,13,"tr",13),u._uU(3,"\n    "),u.BQk()),2&e){const e=u.oxw(3);u.xp6(2),u.Q6J("ngForOf",e.selectionList.selectedItems)}}function Eo(e,t){if(1&e&&(u._uU(0,"\n    "),u.YNc(1,Do,4,1,"ng-container",1),u._uU(2,"\n  ")),2&e){const e=u.oxw(2),t=u.MAs(8);u.xp6(1),u.Q6J("ngIf",e.selectionList.selectedItems.length>0)("ngIfElse",t)}}function zo(e,t){if(1&e&&(u.TgZ(0,"bit-table",8),u._uU(1,"\n  "),u.ynx(2,9),u._uU(3,"\n    "),u.TgZ(4,"tr"),u._uU(5,"\n      "),u.TgZ(6,"th",10),u._uU(7),u.qZA(),u._uU(8,"\n      "),u.TgZ(9,"th",11),u._uU(10),u.ALo(11,"i18n"),u.qZA(),u._uU(12,"\n    "),u.qZA(),u._uU(13,"\n  "),u.BQk(),u._uU(14,"\n  "),u.YNc(15,Eo,3,2,"ng-template",12),u._uU(16,"\n"),u.qZA()),2&e){const e=u.oxw();u.Q6J("formGroup",e.formGroup),u.xp6(7),u.Oqu(e.columnTitle),u.xp6(3),u.Oqu(u.lcZ(11,3,"permissions"))}}function Yo(e,t){if(1&e&&(u._uU(0,"\n  "),u.TgZ(1,"div",26),u._uU(2),u.qZA(),u._uU(3,"\n")),2&e){const e=u.oxw();u.xp6(2),u.hij("\n    ",e.emptyMessage,"\n  ")}}function Go(e,t){if(1&e){const e=u.EpF();u._uU(0,"\n  "),u.TgZ(1,"bit-form-field",27),u._uU(2,"\n    "),u.TgZ(3,"bit-label"),u._uU(4),u.qZA(),u._uU(5,"\n    "),u.TgZ(6,"bit-multi-select",28),u.NdJ("blur",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.handleBlur())})),u.qZA(),u._uU(7,"\n    "),u.TgZ(8,"bit-hint"),u._uU(9),u.qZA(),u._uU(10,"\n  "),u.qZA(),u._uU(11,"\n\n  "),u.TgZ(12,"div",29),u._uU(13,"\n    "),u.TgZ(14,"button",30),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.addButton())})),u._uU(15),u.ALo(16,"i18n"),u.qZA(),u._uU(17,"\n  "),u.qZA(),u._uU(18,"\n")}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("formGroup",e.multiSelectFormGroup),u.xp6(3),u.Oqu(e.label),u.xp6(2),u.Q6J("baseItems",e.selectionList.deselectedItems),u.xp6(3),u.Oqu(e.hint),u.xp6(6),u.hij("\n      ",u.lcZ(16,5,"add"),"\n    ")}}function Mo(e,t){1&e&&(u._uU(0,"\n  "),u.TgZ(1,"div",31),u._uU(2,"\n    "),u._UZ(3,"i",32),u._uU(4,"\n  "),u.qZA(),u._uU(5,"\n"))}class Qo{get items(){return this.selectionList.allItems}set items(e){var t;if(null!=e){const n=null!==(t=this.selectionList.formArray.getRawValue())&&void 0!==t?t:[];this.selectionList.populateItems(e.map((e=>{var t;return e.icon=null!==(t=e.icon)&&void 0!==t?t:Vi.itemIcon(e.type),e})),n)}}constructor(e,t){this.formBuilder=e,this.i18nService=t,this.destroy$=new Pe.x,this.selectionList=new qo.t((e=>{var t;const n=null!==(t=this.staticPermission)&&void 0!==t?t:this.initialPermission,i=this.formBuilder.control(n);let o=!1,s=!1;e.type==Qi.Group&&(o=e.currentUserInGroup),e.type==Qi.User&&(s=e.currentUser);return this.formBuilder.group({id:new Je.NI(e.id),type:new Je.NI(e.type),permission:i,currentUserInGroup:new Je.NI(o),currentUser:new Je.NI(s)})}),this._itemComparator.bind(this)),this.formGroup=this.formBuilder.group({items:this.selectionList.formArray}),this.multiSelectFormGroup=new Je.cw({multiSelect:new Je.NI([])}),this.permissionList=[{perm:Ri.CanRead,labelId:"canRead"},{perm:Ri.CanReadWrite,labelId:"canReadWrite"}],this.initialPermission=Ri.CanRead}registerOnChange(e){this.notifyOnChange=e}registerOnTouched(e){this.notifyOnTouch=e}setDisabledState(e){this.disabled=e,this.disabled?(this.formGroup.disable(),this.multiSelectFormGroup.disable()):(this.formGroup.enable(),this.multiSelectFormGroup.enable())}writeValue(e){if(this.pauseChangeNotification=!0,this.selectionList.deselectAll(),null!=e){if(!Array.isArray(e))throw new Error("The access selector component only supports Array form values!");for(const t of e)this.selectionList.selectItem(t.id,t);this.pauseChangeNotification=!1}else this.pauseChangeNotification=!1}ngOnInit(){this.selectionList.formArray.valueChanges.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.notifyOnChange&&!this.pauseChangeNotification&&(this.selectionList.formArray.disabled?this.notifyOnChange([]):this.notifyOnChange(e))}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}handleBlur(){this.notifyOnTouch&&this.notifyOnTouch()}selectItems(e){this.pauseChangeNotification=!0,this.selectionList.selectItems(e.map((e=>e.id))),this.pauseChangeNotification=!1,null!=this.notifyOnChange&&this.notifyOnChange(this.selectionList.formArray.value)}addButton(){this.selectItems(this.multiSelectFormGroup.value.multiSelect),this.multiSelectFormGroup.reset()}_itemComparator(e,t){return e.type-t.type||this.i18nService.collator.compare(e.listName,t.listName)||this.i18nService.collator.compare(e.labelName,t.labelName)}}Qo.ɵfac=function(e){return new(e||Qo)(u.Y36(Je.qu),u.Y36(rt.D))},Qo.ɵcmp=u.Xpm({type:Qo,selectors:[["sm-access-policy-selector"]],inputs:{loading:"loading",addButtonMode:"addButtonMode",label:"label",hint:"hint",columnTitle:"columnTitle",emptyMessage:"emptyMessage",permissionList:"permissionList",initialPermission:"initialPermission",staticPermission:"staticPermission",items:"items"},features:[u._Bn([{provide:Je.JU,useExisting:(0,u.Gpc)((()=>Qo)),multi:!0}])],decls:16,vars:4,consts:[[1,"tw-flex"],[4,"ngIf","ngIfElse"],[3,"formGroup",4,"ngIf","ngIfElse"],["empty",""],["buttonMode",""],["spinner",""],[1,"tw-grow"],[1,"tw-w-full",3,"loading","baseItems","disabled","removeSelectedItems","blur","onItemsConfirmed"],[3,"formGroup"],["header",""],["bitCell","","colspan","2"],["bitCell",""],["body","","formArrayName","items"],["bitRow","",3,"formGroupName",4,"ngFor","ngForOf"],["bitRow","",3,"formGroupName"],["bitCell","",1,"tw-w-0","tw-pr-0"],["aria-hidden","true"],["bitCell","",1,"tw-max-w-sm","tw-truncate"],["bitCell","",1,"tw-mb-auto","tw-inline-block","tw-w-auto"],["bitInput","","formControlName","permission",3,"blur",4,"ngIf","ngIfElse"],["static",""],["bitCell","",1,"tw-w-0"],["type","button","bitIconButton","bwi-close","buttonType","main","size","default",3,"click"],["bitInput","","formControlName","permission",3,"blur"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"tw-mt-4","tw-text-center"],[1,"tw-grow",3,"formGroup"],["formControlName","multiSelect",1,"tw-w-full",3,"baseItems","blur"],[1,"tw-ml-3","tw-mt-7","tw-shrink-0"],["type","button","bitButton","","buttonType","secondary",3,"click"],[1,"tw-items-center","tw-justify-center","tw-pt-10","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"]],template:function(e,t){if(1&e&&(u.TgZ(0,"div",0),u._uU(1,"\n  "),u.YNc(2,Co,13,6,"ng-container",1),u._uU(3,"\n"),u.qZA(),u._uU(4,"\n\n"),u.YNc(5,zo,17,5,"bit-table",2),u._uU(6,"\n\n"),u.YNc(7,Yo,4,1,"ng-template",null,3,u.W1O),u._uU(9,"\n\n"),u.YNc(10,Go,19,7,"ng-template",null,4,u.W1O),u._uU(12,"\n\n"),u.YNc(13,Mo,6,0,"ng-template",null,5,u.W1O),u._uU(15,"\n")),2&e){const e=u.MAs(11),n=u.MAs(14);u.xp6(2),u.Q6J("ngIf",!t.addButtonMode)("ngIfElse",e),u.xp6(3),u.Q6J("ngIf",!t.loading)("ngIfElse",n)}},dependencies:[s.sg,s.O5,Je.YN,Je.Kr,Je.EJ,Je.JJ,Je.JL,Je.sg,Je.u,Je.x0,Je.CE,De.r,ht.d,gt.G,jo.O,vt.u,ko.M,M.Q,Ye.a,Ge.Y,Me.v,Ye.f,ge.C],encapsulation:2});var Ro=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function Bo(e,t){1&e&&(u.TgZ(0,"p",5),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.hij("\n      ",u.lcZ(2,1,"projectPeopleDescription"),"\n    "))}class Fo{constructor(e,t,n,i,o,s,c,r,a){this.route=e,this.dialogService=t,this.changeDetectorRef=n,this.validationService=i,this.accessPolicyService=o,this.router=s,this.platformUtilsService=c,this.i18nService=r,this.accessPolicySelectorService=a,this.destroy$=new Pe.x,this.currentAccessPolicies$=(0,pe.a)([this.route.params]).pipe((0,Ce.w)((([e])=>this.accessPolicyService.getProjectPeopleAccessPolicies(e.projectId).then((e=>ao(e))))),(0,Fi.K)((()=>(this.router.navigate(["/sm",this.organizationId,"projects"]),$i.E)))),this.potentialGrantees$=(0,pe.a)([this.route.params]).pipe((0,Ce.w)((([e])=>this.accessPolicyService.getPeoplePotentialGrantees(e.organizationId).then((e=>uo(e)))))),this.formGroup=new Je.cw({accessPolicies:new Je.NI([])}),this.loading=!0,this.submit=()=>Ro(this,void 0,void 0,(function*(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const e=yield this.accessPolicySelectorService.showAccessRemovalWarning(this.organizationId,this.formGroup.value.accessPolicies);if(e){if(!(yield this.showWarning()))return void this.setSelected(this.currentAccessPolicies)}try{const t=function(e,t){const n=new co;return n.userAccessPolicies=t.filter((e=>e.type==Qi.User)).map((t=>{const n=new eo;return n.grantedProjectId=e,n.organizationUserId=t.id,n.read=Ki.toRead(t.permission),n.write=Ki.toWrite(t.permission),n})),n.groupAccessPolicies=t.filter((e=>e.type==Qi.Group)).map((t=>{const n=new no;return n.grantedProjectId=e,n.groupId=t.id,n.read=Ki.toRead(t.permission),n.write=Ki.toWrite(t.permission),n})),n}(this.projectId,this.formGroup.value.accessPolicies),n=yield this.accessPolicyService.putProjectPeopleAccessPolicies(this.projectId,t);this.currentAccessPolicies=ao(n),e&&this.router.navigate(["sm",this.organizationId,"projects"]),this.platformUtilsService.showToast("success",null,this.i18nService.t("projectAccessUpdated"))}catch(t){this.validationService.showError(t),this.setSelected(this.currentAccessPolicies)}}))}ngOnInit(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.organizationId=e.organizationId,this.projectId=e.projectId})),(0,pe.a)([this.potentialGrantees$,this.currentAccessPolicies$]).pipe((0,je.R)(this.destroy$)).subscribe((([e,t])=>{this.potentialGrantees=e,this.setSelected(t)}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setSelected(e){this.loading=!0,this.currentAccessPolicies=e,null!=e&&(this.changeDetectorRef.detectChanges(),this.formGroup.patchValue({accessPolicies:e.map((e=>({type:e.type,id:e.id,permission:e.permission,currentUser:e.type==Qi.User?e.currentUser:null,currentUserInGroup:e.type==Qi.Group?e.currentUserInGroup:null})))})),this.loading=!1}showWarning(){return Ro(this,void 0,void 0,(function*(){return yield this.dialogService.openSimpleDialog({title:{key:"smAccessRemovalWarningProjectTitle"},content:{key:"smAccessRemovalWarningProjectMessage"},acceptButtonText:{key:"removeAccess"},cancelButtonText:{key:"cancel"},type:"warning"})}))}}Fo.ɵfac=function(e){return new(e||Fo)(u.Y36(c.gz),u.Y36(ut.x),u.Y36(u.sBO),u.Y36(Po.R),u.Y36(Io),u.Y36(c.F0),u.Y36(at.P),u.Y36(rt.D),u.Y36(Wi))},Fo.ɵcmp=u.Xpm({type:Fo,selectors:[["sm-project-people"]],decls:19,vars:21,consts:[[3,"formGroup","bitSubmit"],[1,"tw-w-2/5"],["class","tw-mt-8",4,"ngIf"],["formControlName","accessPolicies",3,"loading","addButtonMode","items","label","hint","columnTitle","emptyMessage"],["bitButton","","buttonType","primary","bitFormButton","","type","submit",1,"tw-mt-7"],[1,"tw-mt-8"]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"div",1),u._uU(3,"\n    "),u.YNc(4,Bo,3,3,"p",2),u._uU(5,"\n    "),u.TgZ(6,"sm-access-policy-selector",3),u.ALo(7,"i18n"),u.ALo(8,"i18n"),u.ALo(9,"i18n"),u.ALo(10,"i18n"),u._uU(11,"\n    "),u.qZA(),u._uU(12,"\n    "),u.TgZ(13,"button",4),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n"),u.qZA(),u._uU(18,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(4),u.Q6J("ngIf",!t.loading),u.xp6(2),u.Q6J("loading",t.loading)("addButtonMode",!0)("items",t.potentialGrantees)("label",u.lcZ(7,11,"people"))("hint",u.lcZ(8,13,"projectPeopleSelectHint"))("columnTitle",u.lcZ(9,15,"name"))("emptyMessage",u.lcZ(10,17,"projectEmptyPeopleAccessPolicies")),u.xp6(8),u.hij("\n      ",u.lcZ(15,19,"save"),"\n    "))},dependencies:[Qo,s.O5,Je._Y,Je.JJ,Je.JL,Je.sg,Je.u,lt.b,dt.u,De.r,ge.C],encapsulation:2});var $o=n(67775),Vo=n(37260),Ko=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function Ho(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",6),u._uU(1,"\n      "),u.TgZ(2,"button",7),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(3);return u.KtG(t.openNewSecretDialog())})),u._uU(3,"\n        "),u._UZ(4,"i",8),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n    "),u.qZA()}2&e&&(u.xp6(5),u.hij("\n        ",u.lcZ(6,1,"newSecret"),"\n      "))}function Wo(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"sm-secrets-list",9),u.NdJ("deleteSecretsEvent",(function(t){u.CHM(e);const n=u.oxw(3);return u.KtG(n.openDeleteSecret(t))}))("newSecretEvent",(function(){u.CHM(e);const t=u.oxw(3);return u.KtG(t.openNewSecretDialog())}))("editSecretEvent",(function(t){u.CHM(e);const n=u.oxw(3);return u.KtG(n.openEditSecret(t))}))("copySecretNameEvent",(function(t){u.CHM(e);const n=u.oxw(3);return u.KtG(n.copySecretName(t))}))("copySecretValueEvent",(function(t){u.CHM(e);const n=u.oxw(3);return u.KtG(n.copySecretValue(t))}))("copySecretUuidEvent",(function(t){u.CHM(e);const n=u.oxw(3);return u.KtG(n.copySecretUuid(t))})),u.qZA()}if(2&e){const e=u.oxw(2).ngIf;u.Q6J("secrets",e.secrets)}}function Xo(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n    "),u.YNc(2,Ho,8,3,"div",4),u._uU(3,"\n    "),u.YNc(4,Wo,1,1,"sm-secrets-list",5),u._uU(5,"\n  "),u.BQk()),2&e){const e=u.oxw().ngIf;u.oxw();const t=u.MAs(8);u.xp6(2),u.Q6J("ngIf",(null==e.secrets?null:e.secrets.length)>0&&(null==e.project?null:e.project.write)),u.xp6(2),u.Q6J("ngIf",(null==e.secrets?null:e.secrets.length)>0||(null==e.project?null:e.project.write))("ngIfElse",t)}}function es(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n  "),u.YNc(2,Xo,6,3,"ng-container",3),u._uU(3,"\n"),u.BQk()),2&e){const e=t.ngIf;u.oxw();const n=u.MAs(5);u.xp6(2),u.Q6J("ngIf",(null==e?null:e.secrets)&&(null==e?null:e.project))("ngIfElse",n)}}function ts(e,t){1&e&&(u._uU(0,"\n  "),u.TgZ(1,"div",10),u._uU(2,"\n    "),u._UZ(3,"i",11),u._uU(4,"\n  "),u.qZA(),u._uU(5,"\n"))}function ns(e,t){1&e&&(u._uU(0,"\n  "),u.TgZ(1,"bit-no-items"),u._uU(2,"\n    "),u.ynx(3,12),u._uU(4),u.ALo(5,"i18n"),u.BQk(),u._uU(6,"\n    "),u.ynx(7,13),u._uU(8),u.ALo(9,"i18n"),u.BQk(),u._uU(10,"\n  "),u.qZA(),u._uU(11,"\n")),2&e&&(u.xp6(4),u.Oqu(u.lcZ(5,2,"secretsNoItemsTitle")),u.xp6(4),u.Oqu(u.lcZ(9,4,"smProjectSecretsNoItemsNoAccess")))}const is=function(e,t){return{project:e,secrets:t}};class os{constructor(e,t,n,i,o,s,c){this.route=e,this.projectService=t,this.secretService=n,this.dialogService=i,this.platformUtilsService=o,this.i18nService=s,this.organizationService=c}ngOnInit(){const e=this.projectService.project$.pipe((0,$o.h)((e=>(null==e?void 0:e.id)===this.projectId)),(0,ke.O)(null));this.project$=(0,pe.a)([this.route.params,e]).pipe((0,Ce.w)((([e,t])=>this.projectService.getByProjectId(e.projectId)))),this.secrets$=this.secretService.secret$.pipe((0,ke.O)(null),(0,Vo.V)(this.route.params,e),(0,Ce.w)((([e,t])=>Ko(this,void 0,void 0,(function*(){var e;return this.organizationId=t.organizationId,this.projectId=t.projectId,this.organizationEnabled=null===(e=this.organizationService.get(t.organizationId))||void 0===e?void 0:e.enabled,yield this.getSecretsByProject()})))))}getSecretsByProject(){return Ko(this,void 0,void 0,(function*(){return yield this.secretService.getSecretsByProject(this.organizationId,this.projectId)}))}openEditSecret(e){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Edit,secretId:e,organizationEnabled:this.organizationEnabled}})}openDeleteSecret(e){this.dialogService.open(Yt,{data:{secrets:e}})}openNewSecretDialog(){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Add,projectId:this.projectId,organizationEnabled:this.organizationEnabled}})}copySecretName(e){Dn.copySecretName(e,this.platformUtilsService,this.i18nService)}copySecretValue(e){Dn.copySecretValue(e,this.platformUtilsService,this.i18nService,this.secretService)}copySecretUuid(e){Dn.copySecretUuid(e,this.platformUtilsService,this.i18nService)}}os.ɵfac=function(e){return new(e||os)(u.Y36(c.gz),u.Y36(ct),u.Y36(Nt),u.Y36(ut.x),u.Y36(at.P),u.Y36(rt.D),u.Y36(j.Mn))},os.ɵcmp=u.Xpm({type:os,selectors:[["sm-project-secrets"]],decls:10,vars:8,consts:[[4,"ngIf"],["spinner",""],["contactAdmin",""],[4,"ngIf","ngIfElse"],["class","float-right tw-mt-3 tw-items-center",4,"ngIf"],[3,"secrets","deleteSecretsEvent","newSecretEvent","editSecretEvent","copySecretNameEvent","copySecretValueEvent","copySecretUuidEvent",4,"ngIf","ngIfElse"],[1,"float-right","tw-mt-3","tw-items-center"],["type","button","bitButton","","buttonType","secondary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"secrets","deleteSecretsEvent","newSecretEvent","editSecretEvent","copySecretNameEvent","copySecretValueEvent","copySecretUuidEvent"],[1,"tw-items-center","tw-justify-center","tw-pt-64","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["slot","title"],["slot","description"]],template:function(e,t){1&e&&(u.YNc(0,es,4,2,"ng-container",0),u.ALo(1,"async"),u.ALo(2,"async"),u._uU(3,"\n\n"),u.YNc(4,ts,6,0,"ng-template",null,1,u.W1O),u._uU(6,"\n\n"),u.YNc(7,ns,12,6,"ng-template",null,2,u.W1O),u._uU(9,"\n")),2&e&&u.Q6J("ngIf",u.WLB(5,is,u.lcZ(1,1,t.project$),u.lcZ(2,3,t.secrets$)))},dependencies:[Un.M,Dn,s.O5,De.r,s.Ov,ge.C],encapsulation:2});var ss=n(80060),cs=n(99042),rs=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function as(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-form-field",19),u._uU(1,"\n              "),u.TgZ(2,"select",20),u.NdJ("change",(function(t){u.CHM(e);const n=u.oxw().$implicit,i=u.oxw(4);return u.KtG(i.update(t.target,n))})),u._uU(3,"\n                "),u.TgZ(4,"option",21),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n                "),u.TgZ(8,"option",22),u._uU(9),u.ALo(10,"i18n"),u.qZA(),u._uU(11,"\n              "),u.qZA(),u._uU(12,"\n            "),u.qZA()}if(2&e){const e=u.oxw().$implicit;u.xp6(2),u.Q6J("disabled",e.static),u.xp6(2),u.Q6J("selected",e.read&&1!=e.write),u.xp6(1),u.hij("\n                  ",u.lcZ(6,5,"canRead"),"\n                "),u.xp6(3),u.Q6J("selected",e.read&&e.write),u.xp6(1),u.hij("\n                  ",u.lcZ(10,7,"canReadWrite"),"\n                ")}}function us(e,t){1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"canRead")))}function ls(e,t){1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"canWrite")))}function ds(e,t){1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"canReadWrite")))}function ps(e,t){if(1&e&&(u._uU(0,"\n              "),u.YNc(1,us,3,3,"span",23),u._uU(2,"\n              "),u.YNc(3,ls,3,3,"span",23),u._uU(4,"\n              "),u.YNc(5,ds,3,3,"span",23),u._uU(6,"\n            ")),2&e){const e=u.oxw().$implicit;u.xp6(1),u.Q6J("ngIf",e.read&&1!=e.write),u.xp6(2),u.Q6J("ngIf",1!=e.read&&e.write),u.xp6(2),u.Q6J("ngIf",e.read&&e.write)}}function hs(e,t){if(1&e&&(u.TgZ(0,"tr",11),u._uU(1,"\n          "),u.TgZ(2,"td",12),u._uU(3,"\n            "),u._UZ(4,"i",13),u._uU(5,"\n          "),u.qZA(),u._uU(6,"\n          "),u.TgZ(7,"td",14),u._uU(8),u.qZA(),u._uU(9,"\n          "),u.TgZ(10,"td",8),u._uU(11,"\n            "),u.YNc(12,as,13,9,"bit-form-field",15),u._uU(13,"\n            "),u.YNc(14,ps,7,3,"ng-template",null,16,u.W1O),u._uU(16,"\n          "),u.qZA(),u._uU(17,"\n          "),u.TgZ(18,"td",17),u._uU(19,"\n            "),u._UZ(20,"button",18),u.ALo(21,"i18n"),u.ALo(22,"i18n"),u._uU(23,"\n          "),u.qZA(),u._uU(24,"\n        "),u.qZA()),2&e){const e=t.$implicit,n=u.MAs(15),i=u.oxw(4);u.xp6(4),u.Gre("bwi ",e.icon," tw-text-muted"),u.xp6(4),u.Oqu(e.name),u.xp6(4),u.Q6J("ngIf",!e.static)("ngIfElse",n),u.xp6(8),u.Q6J("bitAction",i.delete(e)),u.uIk("title",u.lcZ(21,9,"remove"))("aria-label",u.lcZ(22,11,"remove"))}}function gs(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n        "),u.YNc(2,hs,25,13,"tr",10),u._uU(3,"\n      "),u.BQk()),2&e){const e=u.oxw(2).ngIf;u.xp6(2),u.Q6J("ngForOf",e)}}function vs(e,t){if(1&e&&(u._uU(0,"\n      "),u.YNc(1,gs,4,1,"ng-container",3),u._uU(2,"\n    ")),2&e){const e=u.oxw().ngIf;u.oxw();const t=u.MAs(26);u.xp6(1),u.Q6J("ngIf",e.length>0)("ngIfElse",t)}}function fs(e,t){if(1&e&&(u.TgZ(0,"bit-table"),u._uU(1,"\n    "),u.ynx(2,6),u._uU(3,"\n      "),u.TgZ(4,"tr"),u._uU(5,"\n        "),u.TgZ(6,"th",7),u._uU(7),u.qZA(),u._uU(8,"\n        "),u.TgZ(9,"th",8),u._uU(10),u.ALo(11,"i18n"),u.qZA(),u._uU(12,"\n      "),u.qZA(),u._uU(13,"\n    "),u.BQk(),u._uU(14,"\n\n    "),u.YNc(15,vs,3,2,"ng-template",9),u._uU(16,"\n  "),u.qZA()),2&e){const e=u.oxw();u.xp6(7),u.Oqu(e.columnTitle),u.xp6(3),u.Oqu(u.lcZ(11,2,"permissions"))}}function ms(e,t){if(1&e&&(u._uU(0,"\n  "),u.TgZ(1,"div",24),u._uU(2),u.qZA(),u._uU(3,"\n")),2&e){const e=u.oxw();u.xp6(2),u.hij("\n    ",e.emptyMessage,"\n  ")}}function ws(e,t){1&e&&(u._uU(0,"\n  "),u.TgZ(1,"div",25),u._uU(2,"\n    "),u._UZ(3,"i",26),u._uU(4,"\n  "),u.qZA(),u._uU(5,"\n"))}class Us{set rows(e){const t=e.sort(((e,t)=>e.icon==t.icon?e.name.localeCompare(t.name):e.icon==Us.userIcon?-1:1));this.rows$.next(t)}constructor(e,t){this.accessPolicyService=e,this.route=t,this.onCreateAccessPolicies=new u.vpe,this.onDeleteAccessPolicy=new u.vpe,this.onUpdateAccessPolicy=new u.vpe,this.rows$=new Pe.x,this.maxLength=15,this.formGroup=new Je.cw({multiSelect:new Je.NI([],[Je.kI.required,Je.kI.maxLength(this.maxLength)])}),this.loading=!0,this.selectItems$=(0,pe.a)([this.rows$,this.route.params]).pipe((0,Ce.w)((([e,t])=>this.getPotentialGrantees(t.organizationId).then((t=>t.filter((t=>!e.some((e=>e.id===t.id)))).map((e=>{let t,n=e.name,i=e.name;return"user"===e.type?(t=Us.userIcon,Qt.c.isNullOrWhitespace(e.name)?(n=e.email,i=e.email):n=`${e.name} (${e.email})`):"group"===e.type?t=Us.groupIcon:"serviceAccount"===e.type?t=Us.serviceAccountIcon:"project"===e.type&&(t=Us.projectIcon),{icon:t,id:e.id,labelName:i,listName:n}})))))),(0,D.U)((e=>e.sort(((e,t)=>e.listName.localeCompare(t.listName))))),(0,ss.b)((()=>{this.loading=!1,this.formGroup.reset(),this.formGroup.enable()})),(0,Le.B)()),this.submit=()=>rs(this,void 0,void 0,(function*(){if(this.formGroup.markAllAsTouched(),!this.formGroup.invalid)return this.formGroup.disable(),this.loading=!0,this.onCreateAccessPolicies.emit(this.formGroup.value.multiSelect),(0,cs.z)(this.selectItems$)})),this.delete=e=>()=>rs(this,void 0,void 0,(function*(){return this.loading=!0,this.formGroup.disable(),this.onDeleteAccessPolicy.emit(e),(0,cs.z)(this.selectItems$)}))}ngOnInit(){this.formGroup.disable()}update(e,t){return rs(this,void 0,void 0,(function*(){"canRead"===e.value?(t.read=!0,t.write=!1):"canReadWrite"===e.value&&(t.read=!0,t.write=!0),this.onUpdateAccessPolicy.emit(t)}))}getPotentialGrantees(e){switch(this.granteeType){case"people":return this.accessPolicyService.getPeoplePotentialGrantees(e);case"serviceAccounts":return this.accessPolicyService.getServiceAccountsPotentialGrantees(e);case"projects":return this.accessPolicyService.getProjectsPotentialGrantees(e)}}static getAccessItemType(e){switch(e.icon){case Us.userIcon:return"user";case Us.groupIcon:return"group";case Us.serviceAccountIcon:return"serviceAccount";case Us.projectIcon:return"project"}}static getBaseAccessPolicyView(e){const t=new Xi;return t.id=e.accessPolicyId,t.read=e.read,t.write=e.write,t}}Us.userIcon="bwi-user",Us.groupIcon="bwi-family",Us.serviceAccountIcon="bwi-wrench",Us.projectIcon="bwi-collection",Us.ɵfac=function(e){return new(e||Us)(u.Y36(Io),u.Y36(c.gz))},Us.ɵcmp=u.Xpm({type:Us,selectors:[["sm-access-selector"]],inputs:{label:"label",hint:"hint",columnTitle:"columnTitle",emptyMessage:"emptyMessage",granteeType:"granteeType",rows:"rows"},outputs:{onCreateAccessPolicies:"onCreateAccessPolicies",onDeleteAccessPolicy:"onDeleteAccessPolicy",onUpdateAccessPolicy:"onUpdateAccessPolicy"},decls:31,vars:15,consts:[[1,"tw-mt-5",3,"formGroup","bitSubmit"],["formControlName","multiSelect",1,"tw-mr-4","tw-w-full",3,"baseItems","loading"],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],[4,"ngIf","ngIfElse"],["empty",""],["spinner",""],["header",""],["bitCell","","colspan","2"],["bitCell",""],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-w-0","tw-pr-0"],["aria-hidden","true"],["bitCell","",1,"tw-max-w-sm","tw-truncate"],["class","tw-mb-auto tw-inline-block tw-w-auto",4,"ngIf","ngIfElse"],["staticPermissions",""],["bitCell","",1,"tw-w-0"],["type","button","bitIconButton","bwi-close","buttonType","main","size","default",3,"bitAction"],[1,"tw-mb-auto","tw-inline-block","tw-w-auto"],["bitInput","",3,"disabled","change"],["value","canRead",3,"selected"],["value","canReadWrite",3,"selected"],[4,"ngIf"],[1,"tw-mt-4","tw-text-center"],[1,"tw-items-center","tw-justify-center","tw-pt-10","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"]],template:function(e,t){if(1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-form-field"),u._uU(3,"\n    "),u.TgZ(4,"bit-label"),u._uU(5),u.qZA(),u._uU(6,"\n    "),u._UZ(7,"bit-multi-select",1),u.ALo(8,"async"),u._uU(9,"\n    "),u.TgZ(10,"bit-hint"),u._uU(11),u.qZA(),u._uU(12,"\n    "),u.TgZ(13,"button",2),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n"),u.qZA(),u._uU(18,"\n\n"),u.ynx(19),u._uU(20,"\n  "),u.YNc(21,fs,17,4,"bit-table",3),u.ALo(22,"async"),u._uU(23,"\n"),u.BQk(),u._uU(24,"\n\n"),u.YNc(25,ms,4,1,"ng-template",null,4,u.W1O),u._uU(27,"\n\n"),u.YNc(28,ws,6,0,"ng-template",null,5,u.W1O),u._uU(30,"\n")),2&e){const e=u.MAs(29);u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(5),u.Oqu(t.label),u.xp6(2),u.Q6J("baseItems",u.lcZ(8,9,t.selectItems$))("loading",t.loading),u.xp6(4),u.Oqu(t.hint),u.xp6(3),u.hij("\n      ",u.lcZ(15,11,"add"),"\n    "),u.xp6(7),u.Q6J("ngIf",u.lcZ(22,13,t.rows$))("ngIfElse",e)}},dependencies:[s.sg,s.O5,Je._Y,Je.YN,Je.Kr,Je.JJ,Je.JL,Je.sg,Je.u,Jt.Q,lt.b,dt.u,De.r,ht.d,gt.G,jo.O,vt.u,ko.M,M.Q,Ye.a,Ge.Y,Me.v,Ye.f,s.Ov,ge.C],encapsulation:2});var As=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class _s{handleUpdateAccessPolicy(e){return As(this,void 0,void 0,(function*(){try{return yield this.accessPolicyService.updateAccessPolicy(Us.getBaseAccessPolicyView(e))}catch(t){this.validationService.showError(t)}}))}handleCreateAccessPolicies(e){const t=new so;return t.serviceAccountAccessPolicies=e.filter((e=>"serviceAccount"===Us.getAccessItemType(e))).map((e=>{const t=new oo;return t.grantedProjectId=this.projectId,t.serviceAccountId=e.id,t.read=!0,t.write=!1,t})),this.accessPolicyService.createProjectAccessPolicies(this.organizationId,this.projectId,t)}handleDeleteAccessPolicy(e){return As(this,void 0,void 0,(function*(){try{yield this.accessPolicyService.deleteAccessPolicy(e.accessPolicyId)}catch(t){this.validationService.showError(t)}}))}constructor(e,t,n){this.route=e,this.validationService=t,this.accessPolicyService=n,this.destroy$=new Pe.x,this.rows$=this.accessPolicyService.projectAccessPolicyChanges$.pipe((0,ke.O)(null),(0,Ce.w)((()=>this.accessPolicyService.getProjectAccessPolicies(this.organizationId,this.projectId))),(0,D.U)((e=>e.serviceAccountAccessPolicies.map((e=>({type:"serviceAccount",name:e.serviceAccountName,id:e.serviceAccountId,accessPolicyId:e.id,read:e.read,write:e.write,icon:Us.serviceAccountIcon,static:!1}))))))}ngOnInit(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.organizationId=e.organizationId,this.projectId=e.projectId}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}_s.ɵfac=function(e){return new(e||_s)(u.Y36(c.gz),u.Y36(Po.R),u.Y36(Io))},_s.ɵcmp=u.Xpm({type:_s,selectors:[["sm-project-service-accounts"]],decls:15,vars:18,consts:[[1,"tw-w-2/5"],[1,"tw-mt-8"],["granteeType","serviceAccounts",3,"rows","label","hint","columnTitle","emptyMessage","onCreateAccessPolicies","onDeleteAccessPolicy","onUpdateAccessPolicy"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u._uU(1,"\n  "),u.TgZ(2,"p",1),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"sm-access-selector",2),u.NdJ("onCreateAccessPolicies",(function(e){return t.handleCreateAccessPolicies(e)}))("onDeleteAccessPolicy",(function(e){return t.handleDeleteAccessPolicy(e)}))("onUpdateAccessPolicy",(function(e){return t.handleUpdateAccessPolicy(e)})),u.ALo(7,"async"),u.ALo(8,"i18n"),u.ALo(9,"i18n"),u.ALo(10,"i18n"),u.ALo(11,"i18n"),u._uU(12,"\n  "),u.qZA(),u._uU(13,"\n"),u.qZA(),u._uU(14,"\n")),2&e&&(u.xp6(3),u.hij("\n    ",u.lcZ(4,6,"projectServiceAccountsDescription"),"\n  "),u.xp6(3),u.Q6J("rows",u.lcZ(7,8,t.rows$))("label",u.lcZ(8,10,"serviceAccounts"))("hint",u.lcZ(9,12,"projectServiceAccountsSelectHint"))("columnTitle",u.lcZ(10,14,"serviceAccounts"))("emptyMessage",u.lcZ(11,16,"projectEmptyServiceAccountAccessPolicies")))},dependencies:[Us,s.Ov,ge.C],encapsulation:2});var bs=n(14677),ys=n(36835),Zs=n(8427),xs=n(93814),Ss=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};const Ts=function(){return["people"]},Is=function(){return["service-accounts"]};function Ps(e,t){1&e&&(u.ynx(0),u._uU(1,"\n      "),u.TgZ(2,"bit-tab-link",5),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n      "),u.TgZ(6,"bit-tab-link",5),u._uU(7),u.ALo(8,"i18n"),u.qZA(),u._uU(9,"\n    "),u.BQk()),2&e&&(u.xp6(2),u.Q6J("route",u.DdM(8,Ts)),u.xp6(1),u.Oqu(u.lcZ(4,4,"people")),u.xp6(3),u.Q6J("route",u.DdM(9,Is)),u.xp6(1),u.Oqu(u.lcZ(8,6,"serviceAccounts")))}function qs(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",8),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(2);return u.KtG(t.openEditDialog())})),u._uU(1),u.ALo(2,"i18n"),u.qZA()}2&e&&(u.xp6(1),u.hij("\n    ",u.lcZ(2,1,"editProject"),"\n  "))}const js=function(){return[".."]},ks=function(){return["secrets"]};function Cs(e,t){if(1&e&&(u.TgZ(0,"app-header",1),u._uU(1,"\n  "),u.TgZ(2,"bit-breadcrumbs",2),u._uU(3,"\n    "),u.TgZ(4,"bit-breadcrumb",3),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n  "),u.qZA(),u._uU(8,"\n  "),u.TgZ(9,"bit-tab-nav-bar",4),u._uU(10,"\n    "),u.TgZ(11,"bit-tab-link",5),u._uU(12),u.ALo(13,"i18n"),u.qZA(),u._uU(14,"\n    "),u.YNc(15,Ps,10,10,"ng-container",6),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n  "),u._UZ(18,"sm-new-menu"),u._uU(19,"\n  "),u.YNc(20,qs,3,3,"button",7),u._uU(21,"\n"),u.qZA()),2&e){const e=t.ngIf;u.Q6J("title",e.name),u.xp6(4),u.Q6J("route",u.DdM(11,js)),u.xp6(1),u.Oqu(u.lcZ(6,7,"projects")),u.xp6(6),u.Q6J("route",u.DdM(12,ks)),u.xp6(1),u.Oqu(u.lcZ(13,9,"secrets")),u.xp6(3),u.Q6J("ngIf",e.write),u.xp6(5),u.Q6J("ngIf",e.write)}}class Ls{constructor(e,t,n,i,o,s,c){this.route=e,this.projectService=t,this.router=n,this.dialogService=i,this.platformUtilsService=o,this.i18nService=s,this.organizationService=c,this.destroy$=new Pe.x}ngOnInit(){const e=this.projectService.project$.pipe((0,$o.h)((e=>(null==e?void 0:e.id)===this.projectId)),(0,ke.O)(null));this.project$=(0,pe.a)([this.route.params,e]).pipe((0,Ce.w)((([e,t])=>this.projectService.getByProjectId(e.projectId))),(0,Fi.K)((()=>(this.router.navigate(["/sm",this.organizationId,"projects"]).then((()=>{this.platformUtilsService.showToast("error",null,this.i18nService.t("notFound",this.i18nService.t("project")))})),$i.E)))),this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{var t;this.organizationId=e.organizationId,this.projectId=e.projectId,this.organizationEnabled=null===(t=this.organizationService.get(e.organizationId))||void 0===t?void 0:t.enabled}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}openEditDialog(){return Ss(this,void 0,void 0,(function*(){this.dialogService.open(St,{data:{organizationId:this.organizationId,operation:_t.Edit,organizationEnabled:this.organizationEnabled,projectId:this.projectId}})}))}}function Os(e,t){if(1&e&&(u.TgZ(0,"tr",9),u._uU(1,"\n          "),u.TgZ(2,"td",3),u._uU(3),u.qZA(),u._uU(4,"\n          "),u.TgZ(5,"td",3),u._uU(6),u.ALo(7,"i18n"),u.qZA(),u._uU(8,"\n        "),u.qZA()),2&e){const e=t.$implicit;u.xp6(3),u.Oqu(e.name),u.xp6(3),u.Oqu(u.lcZ(7,2,e.description))}}function Ns(e,t){if(1&e&&(u._uU(0,"\n        "),u.YNc(1,Os,9,4,"tr",8),u._uU(2,"\n      ")),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.data.details)}}var Js;Ls.ɵfac=function(e){return new(e||Ls)(u.Y36(c.gz),u.Y36(ct),u.Y36(c.F0),u.Y36(ut.x),u.Y36(at.P),u.Y36(rt.D),u.Y36(j.Mn))},Ls.ɵcmp=u.Xpm({type:Ls,selectors:[["sm-project"]],decls:5,vars:3,consts:[["icon","bwi-collection",3,"title",4,"ngIf"],["icon","bwi-collection",3,"title"],["slot","breadcrumbs"],["icon","bwi-angle-left",3,"route"],["label","Main","slot","tabs"],[3,"route"],[4,"ngIf"],["type","button","slot","secondary","bitButton","","buttonType","secondary",3,"click",4,"ngIf"],["type","button","slot","secondary","bitButton","","buttonType","secondary",3,"click"]],template:function(e,t){1&e&&(u.YNc(0,Cs,22,13,"app-header",0),u.ALo(1,"async"),u._uU(2,"\n"),u._UZ(3,"router-outlet"),u._uU(4,"\n")),2&e&&u.Q6J("ngIf",u.lcZ(1,1,t.project$))},dependencies:[ii,oi,s.O5,c.lC,De.r,bs.f,ys.G,Zs.n,xs.L,s.Ov,ge.C],encapsulation:2}),function(e){e[e.Continue=0]="Continue",e[e.Cancel=1]="Cancel"}(Js||(Js={}));class Ds{constructor(e,t){this.dialogRef=e,this.data=t,this.bulkConfirmationResult=Js}ngOnInit(){var e;if(!(this.data.title&&this.data.columnTitle&&this.data.message&&(null===(e=this.data.details)||void 0===e?void 0:e.length)>=1))throw this.dialogRef.close(),new Error("The bulk confirmation dialog was not called with the appropriate operation values.")}}Ds.ɵfac=function(e){return new(e||Ds)(u.Y36(Ne.zj),u.Y36(Ne.Kt))},Ds.ɵcmp=u.Xpm({type:Ds,selectors:[["sm-bulk-confirmation-dialog"]],decls:41,vars:18,consts:[["bitDialogTitle",""],["bitDialogContent",""],["header",""],["bitCell",""],["body",""],["bitDialogFooter","",1,"tw-flex","tw-gap-2"],["type","button","bitButton","","buttonType","primary","bitFormButton","",3,"click"],["bitButton","","buttonType","secondary","bitDialogClose","","type","button"],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""]],template:function(e,t){1&e&&(u.TgZ(0,"bit-dialog"),u._uU(1,"\n  "),u.ynx(2,0),u._uU(3),u.ALo(4,"i18n"),u.BQk(),u._uU(5,"\n\n  "),u.TgZ(6,"div",1),u._uU(7),u.ALo(8,"i18n"),u.TgZ(9,"bit-table"),u._uU(10,"\n      "),u.ynx(11,2),u._uU(12,"\n        "),u.TgZ(13,"tr"),u._uU(14,"\n          "),u.TgZ(15,"th",3),u._uU(16),u.ALo(17,"i18n"),u.qZA(),u._uU(18,"\n          "),u.TgZ(19,"th",3),u._uU(20),u.ALo(21,"i18n"),u.qZA(),u._uU(22,"\n        "),u.qZA(),u._uU(23,"\n      "),u.BQk(),u._uU(24,"\n      "),u.YNc(25,Ns,3,1,"ng-template",4),u._uU(26,"\n    "),u.qZA(),u._uU(27,"\n  "),u.qZA(),u._uU(28,"\n\n  "),u.TgZ(29,"div",5),u._uU(30,"\n    "),u.TgZ(31,"button",6),u.NdJ("click",(function(){return t.dialogRef.close(t.bulkConfirmationResult.Continue)})),u._uU(32),u.ALo(33,"i18n"),u.qZA(),u._uU(34,"\n    "),u.TgZ(35,"button",7),u._uU(36),u.ALo(37,"i18n"),u.qZA(),u._uU(38,"\n  "),u.qZA(),u._uU(39,"\n"),u.qZA(),u._uU(40,"\n")),2&e&&(u.xp6(3),u.hij("\n    ",u.lcZ(4,6,t.data.title),"\n  "),u.xp6(4),u.hij("\n    ",u.lcZ(8,8,t.data.message),"\n    "),u.xp6(9),u.Oqu(u.lcZ(17,10,t.data.columnTitle)),u.xp6(4),u.Oqu(u.lcZ(21,12,"description")),u.xp6(12),u.hij("\n      ",u.lcZ(33,14,"continue"),"\n    "),u.xp6(4),u.hij("\n      ",u.lcZ(37,16,"cancel"),"\n    "))},dependencies:[s.sg,lt.b,De.r,Ee.a,ze.f,Ye.a,Ge.Y,Me.v,Ye.f,ge.C],encapsulation:2});var Es=n(94239),zs=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Ys{constructor(e,t,n,i,o){this.route=e,this.projectService=t,this.accessPolicyService=n,this.dialogService=i,this.organizationService=o}ngOnInit(){this.projects$=(0,pe.a)([this.route.params,this.projectService.project$.pipe((0,ke.O)(null)),this.accessPolicyService.projectAccessPolicyChanges$.pipe((0,ke.O)(null))]).pipe((0,Ce.w)((([e])=>zs(this,void 0,void 0,(function*(){var t;return this.organizationId=e.organizationId,this.organizationEnabled=null===(t=this.organizationService.get(e.organizationId))||void 0===t?void 0:t.enabled,yield this.getProjects()})))))}getProjects(){return zs(this,void 0,void 0,(function*(){return yield this.projectService.getProjects(this.organizationId)}))}openEditProject(e){this.dialogService.open(St,{data:{organizationId:this.organizationId,operation:_t.Edit,organizationEnabled:this.organizationEnabled,projectId:e}})}openNewProjectDialog(){this.dialogService.open(St,{data:{organizationId:this.organizationId,operation:_t.Add,organizationEnabled:this.organizationEnabled}})}openDeleteProjectDialog(e){return zs(this,void 0,void 0,(function*(){if(e.some((e=>0==e.write))){const t=e.filter((e=>0==e.write)),n=e.filter((e=>e.write)),i=this.dialogService.open(Ds,{data:{title:"deleteProjects",columnTitle:"projectName",message:"smProjectsDeleteBulkConfirmation",details:this.getBulkConfirmationDetails(t)}});(yield(0,Mt.n)(i.closed))==Js.Continue&&this.dialogService.open(Ut,{data:{projects:n}})}else this.dialogService.open(Ut,{data:{projects:e}})}))}getBulkConfirmationDetails(e){return e.map((e=>({id:e.id,name:e.name,description:"smProjectDeleteAccessRestricted"})))}}Ys.ɵfac=function(e){return new(e||Ys)(u.Y36(c.gz),u.Y36(ct),u.Y36(Io),u.Y36(ut.x),u.Y36(j.Mn))},Ys.ɵcmp=u.Xpm({type:Ys,selectors:[["sm-projects"]],decls:12,vars:8,consts:[[1,"tw-w-80",3,"placeholder","ngModel","ngModelChange"],[3,"projects","search","newProjectEvent","editProjectEvent","deleteProjectEvent"]],template:function(e,t){1&e&&(u.TgZ(0,"app-header"),u._uU(1,"\n  "),u.TgZ(2,"bit-search",0),u.NdJ("ngModelChange",(function(e){return t.search=e})),u.ALo(3,"i18n"),u.qZA(),u._uU(4,"\n  "),u._UZ(5,"sm-new-menu"),u._uU(6,"\n"),u.qZA(),u._uU(7,"\n"),u.TgZ(8,"sm-projects-list",1),u.NdJ("newProjectEvent",(function(){return t.openNewProjectDialog()}))("editProjectEvent",(function(e){return t.openEditProject(e)}))("deleteProjectEvent",(function(e){return t.openDeleteProjectDialog(e)})),u.ALo(9,"async"),u._uU(10,"\n"),u.qZA(),u._uU(11,"\n")),2&e&&(u.xp6(2),u.Q6J("placeholder",u.lcZ(3,4,"searchProjects"))("ngModel",t.search),u.xp6(6),u.Q6J("projects",u.lcZ(9,6,t.projects$))("search",t.search))},dependencies:[ii,oi,gi,Es.g,Je.JJ,Je.On,s.Ov,ge.C],encapsulation:2});const Gs=[{path:"",component:Ys},{path:":projectId",component:Ls,children:[{path:"",pathMatch:"full",redirectTo:"secrets"},{path:"secrets",component:os},{path:"people",component:Fo},{path:"service-accounts",component:_s}]}];class Ms{}Ms.ɵfac=function(e){return new(e||Ms)},Ms.ɵmod=u.oAB({type:Ms}),Ms.ɵinj=u.cJS({imports:[c.Bz.forChild(Gs),c.Bz]});class Qs{}Qs.ɵfac=function(e){return new(e||Qs)},Qs.ɵmod=u.oAB({type:Qs}),Qs.ɵinj=u.cJS({imports:[I,Ms,Bi.J]});var Rs=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Bs{constructor(e,t,n,i,o,s){this.route=e,this.secretService=t,this.dialogService=n,this.platformUtilsService=i,this.i18nService=o,this.organizationService=s}ngOnInit(){this.secrets$=this.secretService.secret$.pipe((0,ke.O)(null),(0,Vo.V)(this.route.params),(0,Ce.w)((([e,t])=>Rs(this,void 0,void 0,(function*(){var e;return this.organizationId=t.organizationId,this.organizationEnabled=null===(e=this.organizationService.get(t.organizationId))||void 0===e?void 0:e.enabled,yield this.getSecrets()}))))),this.route.snapshot.queryParams.search&&(this.search=this.route.snapshot.queryParams.search)}getSecrets(){return Rs(this,void 0,void 0,(function*(){return yield this.secretService.getSecrets(this.organizationId)}))}openEditSecret(e){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Edit,secretId:e,organizationEnabled:this.organizationEnabled}})}openDeleteSecret(e){this.dialogService.open(Yt,{data:{secrets:e}})}openNewSecretDialog(){this.dialogService.open(Wt,{data:{organizationId:this.organizationId,operation:Gt.Add,organizationEnabled:this.organizationEnabled}})}copySecretName(e){Dn.copySecretName(e,this.platformUtilsService,this.i18nService)}copySecretValue(e){Dn.copySecretValue(e,this.platformUtilsService,this.i18nService,this.secretService)}copySecretUuid(e){Dn.copySecretUuid(e,this.platformUtilsService,this.i18nService)}}Bs.ɵfac=function(e){return new(e||Bs)(u.Y36(c.gz),u.Y36(Nt),u.Y36(ut.x),u.Y36(at.P),u.Y36(rt.D),u.Y36(j.Mn))},Bs.ɵcmp=u.Xpm({type:Bs,selectors:[["sm-secrets"]],decls:11,vars:8,consts:[[1,"tw-w-80",3,"placeholder","ngModel","ngModelChange"],[3,"secrets","search","deleteSecretsEvent","newSecretEvent","editSecretEvent","copySecretNameEvent","copySecretValueEvent","copySecretUuidEvent"]],template:function(e,t){1&e&&(u.TgZ(0,"app-header"),u._uU(1,"\n  "),u.TgZ(2,"bit-search",0),u.NdJ("ngModelChange",(function(e){return t.search=e})),u.ALo(3,"i18n"),u.qZA(),u._uU(4,"\n  "),u._UZ(5,"sm-new-menu"),u._uU(6,"\n"),u.qZA(),u._uU(7,"\n"),u.TgZ(8,"sm-secrets-list",1),u.NdJ("deleteSecretsEvent",(function(e){return t.openDeleteSecret(e)}))("newSecretEvent",(function(){return t.openNewSecretDialog()}))("editSecretEvent",(function(e){return t.openEditSecret(e)}))("copySecretNameEvent",(function(e){return t.copySecretName(e)}))("copySecretValueEvent",(function(e){return t.copySecretValue(e)}))("copySecretUuidEvent",(function(e){return t.copySecretUuid(e)})),u.ALo(9,"async"),u.qZA(),u._uU(10,"\n")),2&e&&(u.xp6(2),u.Q6J("placeholder",u.lcZ(3,4,"searchSecrets"))("ngModel",t.search),u.xp6(6),u.Q6J("secrets",u.lcZ(9,6,t.secrets$))("search",t.search))},dependencies:[ii,oi,Es.g,Dn,Je.JJ,Je.On,s.Ov,ge.C],encapsulation:2});const Fs=[{path:"",component:Bs}];class $s{}$s.ɵfac=function(e){return new(e||$s)},$s.ɵmod=u.oAB({type:$s}),$s.ɵinj=u.cJS({imports:[c.Bz.forChild(Fs),c.Bz]});class Vs{}Vs.ɵfac=function(e){return new(e||Vs)},Vs.ɵmod=u.oAB({type:Vs}),Vs.ɵinj=u.cJS({imports:[I,$s]});var Ks=n(4519),Hs=n(55637);class Ws{}class Xs{}class ec extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.name=this.getResponseProperty("Name"),this.clientSecret=this.getResponseProperty("ClientSecret"),this.expireAt=this.getResponseProperty("ExpireAt"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate")}}class tc extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.name=this.getResponseProperty("Name"),this.scopes=this.getResponseProperty("Scopes"),this.expireAt=this.getResponseProperty("ExpireAt"),this.creationDate=this.getResponseProperty("CreationDate"),this.revisionDate=this.getResponseProperty("RevisionDate")}}class nc{}var ic=n(79865),oc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class sc{constructor(e,t,n,i){this.cryptoService=e,this.apiService=t,this.cryptoFunctionService=n,this.encryptService=i,this._accessTokenVersion="0",this._accessToken=new Pe.x,this.accessToken$=this._accessToken.asObservable()}getAccessTokens(e,t){return oc(this,void 0,void 0,(function*(){const n=yield this.apiService.send("GET","/service-accounts/"+t+"/access-tokens",null,!0,!0),i=new $e.L(n,tc);return yield this.createAccessTokenViews(e,i.data)}))}createAccessToken(e,t,n){return oc(this,void 0,void 0,(function*(){const i=yield this.cryptoFunctionService.aesGenerateKey(128),o=yield this.cryptoFunctionService.hkdf(i,"bitwarden-accesstoken","sm-access-token",64,"sha256"),s=new Hs.N(o),c=yield this.createAccessTokenRequest(e,s,n),r=yield this.apiService.send("POST","/service-accounts/"+t+"/access-tokens",c,!0,!0),a=new ec(r);this._accessToken.next(null);const u=Qt.c.fromBufferToB64(i);return`${this._accessTokenVersion}.${a.id}.${a.clientSecret}:${u}`}))}revokeAccessTokens(e,t){return oc(this,void 0,void 0,(function*(){const n=new Xs;n.ids=t,yield this.apiService.send("POST","/service-accounts/"+e+"/access-tokens/revoke",n,!0,!1),this._accessToken.next(null)}))}createAccessTokenRequest(e,t,n){return oc(this,void 0,void 0,(function*(){const i=yield this.getOrganizationKey(e),o=new Ws,[s,c,r]=yield Promise.all([yield this.encryptService.encrypt(n.name,i),yield this.encryptService.encrypt(JSON.stringify({encryptionKey:i.keyB64}),t),yield this.encryptService.encrypt(t.keyB64,i)]);return o.name=s,o.encryptedPayload=c,o.key=r,o.expireAt=n.expireAt,o}))}getOrganizationKey(e){return oc(this,void 0,void 0,(function*(){return yield this.cryptoService.getOrgKey(e)}))}createAccessTokenViews(e,t){return oc(this,void 0,void 0,(function*(){const n=yield this.getOrganizationKey(e);return yield Promise.all(t.map((e=>oc(this,void 0,void 0,(function*(){const t=new nc;return t.id=e.id,t.name=yield this.encryptService.decryptToUtf8(new Ve._(e.name),n),t.scopes=e.scopes,t.expireAt=e.expireAt?new Date(e.expireAt):null,t.creationDate=new Date(e.creationDate),t.revisionDate=new Date(e.revisionDate),t})))))}))}}sc.ɵfac=function(e){return new(e||sc)(u.LFG(nt.$),u.LFG(it.s),u.LFG(ic.O),u.LFG(ot.U))},sc.ɵprov=u.Yz7({token:sc,factory:sc.ɵfac,providedIn:"root"});class cc{constructor(e,t,n,i){this.dialogRef=e,this.data=t,this.platformUtilsService=n,this.i18nService=i,this.dialogRef.disableClose=!0}ngOnInit(){if(!this.data.subTitle||!this.data.accessToken)throw this.dialogRef.close(),new Error("The access token dialog was not called with the appropriate values.")}copyAccessToken(){this.platformUtilsService.copyToClipboard(this.data.accessToken),this.platformUtilsService.showToast("success",null,this.i18nService.t("accessTokenCreatedAndCopied")),this.dialogRef.close()}}cc.ɵfac=function(e){return new(e||cc)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(at.P),u.Y36(rt.D))},cc.ɵcmp=u.Xpm({type:cc,selectors:[["ng-component"]],decls:48,vars:35,consts:[["dialogSize","default"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["type","info",3,"title"],[1,"tw-mb-0"],["bitInput","","disabled","","rows","4"],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-clone"]],template:function(e,t){1&e&&(u.TgZ(0,"bit-dialog",0),u._uU(1,"\n  "),u.ynx(2,1),u._uU(3,"\n    "),u.TgZ(4,"span"),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n    "),u.TgZ(8,"span",2),u._uU(9),u.qZA(),u._uU(10,"\n  "),u.BQk(),u._uU(11,"\n\n  "),u.TgZ(12,"div",3),u._uU(13,"\n    "),u.TgZ(14,"bit-callout",4),u.ALo(15,"i18n"),u._uU(16),u.ALo(17,"i18n"),u._UZ(18,"br"),u._uU(19),u.ALo(20,"i18n"),u.ALo(21,"i18n"),u.ALo(22,"date"),u.qZA(),u._uU(23,"\n\n    "),u.TgZ(24,"bit-form-field",5),u._uU(25,"\n      "),u.TgZ(26,"bit-label"),u._uU(27),u.ALo(28,"i18n"),u.qZA(),u._uU(29,"\n      "),u.TgZ(30,"textarea",6),u._uU(31),u.qZA(),u._uU(32,"\n    "),u.qZA(),u._uU(33),u.ALo(34,"i18n"),u.ALo(35,"i18n"),u.ALo(36,"date"),u.qZA(),u._uU(37,"\n\n  "),u.ynx(38,7),u._uU(39,"\n    "),u.TgZ(40,"button",8),u.NdJ("click",(function(){return t.copyAccessToken()})),u._uU(41,"\n      "),u._UZ(42,"i",9),u._uU(43),u.ALo(44,"i18n"),u.qZA(),u._uU(45,"\n  "),u.BQk(),u._uU(46,"\n"),u.qZA(),u._uU(47,"\n")),2&e&&(u.xp6(5),u.Oqu(u.lcZ(6,11,"newAccessToken")),u.xp6(4),u.hij("\n      ",t.data.subTitle,"\n    "),u.xp6(5),u.Q6J("title",u.lcZ(15,13,"accessTokenCallOutTitle")),u.xp6(2),u.hij("\n      ",u.lcZ(17,15,"downloadAccessToken"),""),u.xp6(3),u.AsE("\n      ",u.lcZ(20,17,"expiresOnAccessToken"),"\n      ",null===t.data.expirationDate?u.lcZ(21,19,"never"):u.xi3(22,21,t.data.expirationDate,"medium"),"\n    "),u.xp6(8),u.Oqu(u.lcZ(28,24,"accessToken")),u.xp6(4),u.Oqu(t.data.accessToken),u.xp6(2),u.AsE("\n    ",u.lcZ(34,26,"expiresOnAccessToken"),"\n    ",null===t.data.expirationDate?u.lcZ(35,28,"never"):u.xi3(36,30,t.data.expirationDate,"medium"),"\n  "),u.xp6(10),u.hij("\n      ",u.lcZ(44,33,"copyToken"),"\n    "))},dependencies:[De.r,pt.O,Ee.a,ht.d,gt.G,vt.u,s.uU,ge.C],encapsulation:2});var rc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function ac(e,t){if(1&e&&(u.TgZ(0,"option",6),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("ngValue",e),u.xp6(1),u.hij("\n        ",u.xi3(2,2,"days",e),"\n      ")}}function uc(e,t){if(1&e&&(u.TgZ(0,"bit-form-field"),u._uU(1,"\n    "),u.TgZ(2,"bit-label"),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n    "),u._UZ(6,"input",7),u.ALo(7,"date"),u._uU(8,"\n  "),u.qZA()),2&e){const e=u.oxw();u.xp6(3),u.Oqu(u.lcZ(4,2,"expirationDate")),u.xp6(3),u.Q6J("min",u.xi3(7,4,e.currentDate,"YYYY-MM-ddThh:mm"))}}class lc{set touched(e){e&&this.form.markAllAsTouched()}constructor(e,t){this.datePipe=e,this.i18nService=t,this.destroy$=new Pe.x,this.currentDate=new Date,this.form=new Je.cw({expires:new Je.NI("never",[Je.kI.required]),expireDateTime:new Je.NI("",[Je.kI.required,this.expiresInFutureValidator()])}),this._onChange=e=>{},this.onTouched=()=>{}}ngOnInit(){return rc(this,void 0,void 0,(function*(){this.form.valueChanges.pipe((0,je.R)(this.destroy$)).subscribe((()=>{this._onChange(this.getExpiresDate())}))}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}registerOnChange(e){this._onChange=e}registerOnTouched(e){this.onTouched=e}validate(e){return"custom"==this.form.value.expires&&!this.form.invalid||"custom"!==this.form.value.expires?null:{required:!0}}writeValue(e){null==e&&this.form.setValue({expires:"never",expireDateTime:null}),e&&this.form.setValue({expires:"custom",expireDateTime:this.datePipe.transform(e,"YYYY-MM-ddThh:mm")})}setDisabledState(e){e?this.form.disable():this.form.enable()}getExpiresDate(){if("never"==this.form.value.expires)return null;if("custom"==this.form.value.expires)return new Date(this.form.value.expireDateTime);const e=new Date;return e.setDate(e.getDate()+Number(this.form.value.expires)),e}expiresInFutureValidator(){return e=>new Date(e.value)>new Date?null:{ValidationError:{message:this.i18nService.t("expirationDateError")}}}}lc.ɵfac=function(e){return new(e||lc)(u.Y36(s.uU),u.Y36(rt.D))},lc.ɵcmp=u.Xpm({type:lc,selectors:[["sm-expiration-options"]],inputs:{expirationDayOptions:"expirationDayOptions",touched:"touched"},features:[u._Bn([{provide:Je.JU,multi:!0,useExisting:lc},{provide:Je.Cf,multi:!0,useExisting:lc}])],decls:25,vars:12,consts:[[3,"formGroup"],["bitInput","","formControlName","expires"],["ngValue","never"],[3,"ngValue",4,"ngFor","ngForOf"],["ngValue","custom"],[4,"ngIf"],[3,"ngValue"],["bitInput","","type","datetime-local","formControlName","expireDateTime",3,"min"]],template:function(e,t){1&e&&(u.ynx(0,0),u._uU(1,"\n  "),u.TgZ(2,"bit-form-field"),u._uU(3,"\n    "),u.TgZ(4,"bit-label"),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n    "),u.TgZ(8,"select",1),u._uU(9,"\n      "),u.TgZ(10,"option",2),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n      "),u.YNc(14,ac,3,5,"option",3),u._uU(15,"\n      "),u.TgZ(16,"option",4),u._uU(17),u.ALo(18,"i18n"),u.qZA(),u._uU(19,"\n    "),u.qZA(),u._uU(20,"\n  "),u.qZA(),u._uU(21,"\n  "),u.YNc(22,uc,9,7,"bit-form-field",5),u._uU(23,"\n"),u.BQk(),u._uU(24,"\n")),2&e&&(u.Q6J("formGroup",t.form),u.xp6(5),u.Oqu(u.lcZ(6,6,"expires")),u.xp6(6),u.Oqu(u.lcZ(12,8,"never")),u.xp6(3),u.Q6J("ngForOf",t.expirationDayOptions),u.xp6(3),u.Oqu(u.lcZ(18,10,"custom")),u.xp6(5),u.Q6J("ngIf","custom"===t.form.value.expires))},dependencies:[s.sg,s.O5,Je.YN,Je.Kr,Je.Fj,Je.EJ,Je.JJ,Je.JL,Je.sg,Je.u,ht.d,gt.G,vt.u,s.uU,ge.C],encapsulation:2});var dc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class pc{constructor(e,t,n,i){this.dialogRef=e,this.data=t,this.dialogService=n,this.accessService=i,this.formGroup=new Je.cw({name:new Je.NI("",{validators:[Je.kI.required,Je.kI.maxLength(80),At],updateOn:"submit"}),expirationDateControl:new Je.NI(null)}),this.loading=!1,this.expirationDayOptions=[7,30,60],this.submit=()=>dc(this,void 0,void 0,(function*(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const e=new nc;e.name=this.formGroup.value.name,e.expireAt=this.formGroup.value.expirationDateControl;const t=yield this.accessService.createAccessToken(this.data.serviceAccountView.organizationId,this.data.serviceAccountView.id,e);this.openAccessTokenDialog(this.data.serviceAccountView.name,t,e.expireAt),this.dialogRef.close()}))}ngOnInit(){return dc(this,void 0,void 0,(function*(){if(!this.data.serviceAccountView)throw this.dialogRef.close(),new Error("The access token create dialog was not called with the appropriate operation values.")}))}openAccessTokenDialog(e,t,n){this.dialogService.open(cc,{data:{subTitle:e,expirationDate:n,accessToken:t}})}static openNewAccessTokenDialog(e,t){return e.open(pc,{data:{serviceAccountView:t}})}}function hc(e,t){1&e&&(u.TgZ(0,"div",6),u._uU(1,"\n  "),u._UZ(2,"i",7),u._uU(3,"\n"),u.qZA())}function gc(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-no-items"),u._uU(1,"\n  "),u.ynx(2,8),u._uU(3),u.ALo(4,"i18n"),u.BQk(),u._uU(5,"\n  "),u.ynx(6,9),u._uU(7),u.ALo(8,"i18n"),u.BQk(),u._uU(9,"\n  "),u.TgZ(10,"button",10),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.newAccessTokenEvent.emit())})),u._uU(11,"\n    "),u._UZ(12,"i",11),u._uU(13),u.ALo(14,"i18n"),u.qZA(),u._uU(15,"\n"),u.qZA()}2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,3,"accessTokensNoItemsTitle")),u.xp6(4),u.Oqu(u.lcZ(8,5,"accessTokensNoItemsDesc")),u.xp6(6),u.hij("\n    ",u.lcZ(14,7,"newAccessToken"),"\n  "))}function vc(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr",20),u._uU(1,"\n      "),u.TgZ(2,"td",16),u._uU(3,"\n        "),u.TgZ(4,"input",21),u.NdJ("change",(function(t){const n=u.CHM(e).$implicit,i=u.oxw(3);return u.KtG(t?i.selection.toggle(n.id):null)})),u.qZA(),u._uU(5,"\n      "),u.qZA(),u._uU(6,"\n      "),u.TgZ(7,"td",16),u._uU(8),u.qZA(),u._uU(9,"\n      "),u.TgZ(10,"td",16),u._uU(11),u.ALo(12,"i18n"),u.ALo(13,"date"),u.qZA(),u._uU(14,"\n      "),u.TgZ(15,"td",16),u._uU(16),u.ALo(17,"date"),u.qZA(),u._uU(18,"\n      "),u.TgZ(19,"td",16),u._uU(20,"\n        "),u._UZ(21,"button",22),u.ALo(22,"i18n"),u.ALo(23,"i18n"),u._uU(24,"\n      "),u.qZA(),u._uU(25,"\n\n      "),u.TgZ(26,"bit-menu",null,23),u._uU(28,"\n        "),u.TgZ(29,"button",3),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,n=u.oxw(3);return u.KtG(n.revokeAccessTokensEvent.emit([t]))})),u._uU(30,"\n          "),u.TgZ(31,"span",4),u._uU(32,"\n            "),u._UZ(33,"i",5),u._uU(34),u.ALo(35,"i18n"),u.qZA(),u._uU(36,"\n        "),u.qZA(),u._uU(37,"\n      "),u.qZA(),u._uU(38,"\n    "),u.qZA()}if(2&e){const e=t.$implicit,n=u.MAs(27),i=u.oxw(3);u.xp6(4),u.Q6J("checked",i.selection.isSelected(e.id)),u.xp6(4),u.Oqu(e.name),u.xp6(3),u.hij("\n        ",null===e.expireAt?u.lcZ(12,8,"never"):u.xi3(13,10,e.expireAt,"medium"),"\n      "),u.xp6(5),u.Oqu(u.xi3(17,13,e.revisionDate,"medium")),u.xp6(5),u.Q6J("title",u.lcZ(22,16,"options"))("bitMenuTriggerFor",n),u.uIk("aria-label",u.lcZ(23,18,"options")),u.xp6(13),u.hij("\n            ",u.lcZ(35,20,"revokeAccessToken"),"\n          ")}}function fc(e,t){if(1&e&&(u._uU(0,"\n    "),u.YNc(1,vc,39,22,"tr",19),u._uU(2,"\n  ")),2&e){const e=u.oxw(2);u.xp6(1),u.Q6J("ngForOf",e.tokens)}}function mc(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-table"),u._uU(1,"\n  "),u.ynx(2,12),u._uU(3,"\n    "),u.TgZ(4,"tr"),u._uU(5,"\n      "),u.TgZ(6,"th",13),u._uU(7,"\n        "),u.TgZ(8,"label",14),u._uU(9,"\n          "),u.TgZ(10,"input",15),u.NdJ("change",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(t?n.toggleAll():null)})),u.qZA(),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n      "),u.qZA(),u._uU(14,"\n      "),u.TgZ(15,"th",16),u._uU(16),u.ALo(17,"i18n"),u.qZA(),u._uU(18,"\n      "),u.TgZ(19,"th",16),u._uU(20),u.ALo(21,"i18n"),u.qZA(),u._uU(22,"\n      "),u.TgZ(23,"th",16),u._uU(24),u.ALo(25,"i18n"),u.qZA(),u._uU(26,"\n      "),u.TgZ(27,"th",13),u._uU(28,"\n        "),u._UZ(29,"button",17),u.ALo(30,"i18n"),u.ALo(31,"i18n"),u._uU(32,"\n      "),u.qZA(),u._uU(33,"\n    "),u.qZA(),u._uU(34,"\n  "),u.BQk(),u._uU(35,"\n  "),u.YNc(36,fc,3,1,"ng-template",18),u._uU(37,"\n"),u.qZA()}if(2&e){const e=u.oxw(),t=u.MAs(7);u.xp6(10),u.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected()),u.xp6(1),u.hij("\n          ",u.lcZ(12,9,"all"),"\n        "),u.xp6(5),u.Oqu(u.lcZ(17,11,"name")),u.xp6(4),u.Oqu(u.lcZ(21,13,"expires")),u.xp6(4),u.Oqu(u.lcZ(25,15,"lastEdited")),u.xp6(5),u.Q6J("bitMenuTriggerFor",t)("title",u.lcZ(30,17,"options")),u.uIk("aria-label",u.lcZ(31,19,"options"))}}pc.ɵfac=function(e){return new(e||pc)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(ut.x),u.Y36(sc))},pc.ɵcmp=u.Xpm({type:pc,selectors:[["ng-component"]],decls:41,vars:17,consts:[[3,"formGroup","bitSubmit"],["dialogSize","default"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["bitInput","","appAutofocus","","formControlName","name"],["formControlName","expirationDateControl",3,"expirationDayOptions","touched"],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","primary","bitFormButton","",1,"tw-normal-case"],["type","button","bitButton","","buttonType","secondary","bitFormButton","","bitDialogClose",""]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-dialog",1),u._uU(3,"\n    "),u.ynx(4,2),u._uU(5,"\n      "),u.TgZ(6,"span"),u._uU(7),u.ALo(8,"i18n"),u.qZA(),u._uU(9,"\n      "),u.TgZ(10,"span",3),u._uU(11),u.qZA(),u._uU(12,"\n    "),u.BQk(),u._uU(13,"\n\n    "),u.TgZ(14,"div",4),u._uU(15,"\n      "),u.TgZ(16,"bit-form-field"),u._uU(17,"\n        "),u.TgZ(18,"bit-label"),u._uU(19),u.ALo(20,"i18n"),u.qZA(),u._uU(21,"\n        "),u._UZ(22,"input",5),u._uU(23,"\n      "),u.qZA(),u._uU(24,"\n      "),u._UZ(25,"sm-expiration-options",6),u._uU(26,"\n    "),u.qZA(),u._uU(27,"\n\n    "),u.ynx(28,7),u._uU(29,"\n      "),u.TgZ(30,"button",8),u._uU(31),u.ALo(32,"i18n"),u.qZA(),u._uU(33,"\n      "),u.TgZ(34,"button",9),u._uU(35),u.ALo(36,"i18n"),u.qZA(),u._uU(37,"\n    "),u.BQk(),u._uU(38,"\n  "),u.qZA(),u._uU(39,"\n"),u.qZA(),u._uU(40,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(7),u.Oqu(u.lcZ(8,9,"newAccessToken")),u.xp6(4),u.hij("\n        ",t.data.serviceAccountView.name,"\n      "),u.xp6(8),u.Oqu(u.lcZ(20,11,"name")),u.xp6(6),u.Q6J("expirationDayOptions",t.expirationDayOptions)("touched",t.formGroup.controls.expirationDateControl.touched),u.xp6(6),u.hij("\n        ",u.lcZ(32,13,"newAccessToken"),"\n      "),u.xp6(4),u.hij("\n        ",u.lcZ(36,15,"cancel"),"\n      "))},dependencies:[Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,bt.U,lt.b,dt.u,De.r,Ee.a,ze.f,ht.d,gt.G,vt.u,lc,ge.C],encapsulation:2});class wc{constructor(){this.newAccessTokenEvent=new u.vpe,this.revokeAccessTokensEvent=new u.vpe,this.selection=new pn.Ov(!0,[])}get tokens(){return this._tokens}set tokens(e){this.selection.clear(),this._tokens=e}isAllSelected(){return this.selection.selected.length===this.tokens.length}toggleAll(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.tokens.map((e=>e.id)))}revokeSelected(){const e=this.tokens.filter((e=>this.selection.selected.includes(e.id)));this.revokeAccessTokensEvent.emit(e)}}wc.ɵfac=function(e){return new(e||wc)},wc.ɵcmp=u.Xpm({type:wc,selectors:[["sm-access-list"]],inputs:{tokens:"tokens"},outputs:{newAccessTokenEvent:"newAccessTokenEvent",revokeAccessTokensEvent:"revokeAccessTokensEvent"},decls:19,vars:6,consts:[["class","tw-items-center tw-justify-center tw-pt-64 tw-text-center",4,"ngIf"],[4,"ngIf"],["tableMenu",""],["type","button","bitMenuItem","",3,"click"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-minus-circle"],[1,"tw-items-center","tw-justify-center","tw-pt-64","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["slot","title"],["slot","description"],["type","button","slot","button","bitButton","","buttonType","secondary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],["header",""],["bitCell","",1,"tw-w-0"],[1,"tw-m-0","tw-flex","tw-w-fit","tw-gap-2","!tw-font-bold","!tw-text-muted"],["type","checkbox",3,"checked","indeterminate","change"],["bitCell",""],["type","button","bitIconButton","bwi-ellipsis-v","buttonType","main",3,"bitMenuTriggerFor","title"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["type","checkbox",3,"checked","change"],["type","button","bitIconButton","bwi-ellipsis-v","buttonType","main",3,"title","bitMenuTriggerFor"],["tokenMenu",""]],template:function(e,t){1&e&&(u.YNc(0,hc,4,0,"div",0),u._uU(1,"\n\n"),u.YNc(2,gc,16,9,"bit-no-items",1),u._uU(3,"\n\n"),u.YNc(4,mc,38,21,"bit-table",1),u._uU(5,"\n\n"),u.TgZ(6,"bit-menu",null,2),u._uU(8,"\n  "),u.TgZ(9,"button",3),u.NdJ("click",(function(){return t.revokeSelected()})),u._uU(10,"\n    "),u.TgZ(11,"span",4),u._uU(12,"\n      "),u._UZ(13,"i",5),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n"),u.qZA(),u._uU(18,"\n")),2&e&&(u.Q6J("ngIf",!t.tokens),u.xp6(2),u.Q6J("ngIf",0==(null==t.tokens?null:t.tokens.length)),u.xp6(2),u.Q6J("ngIf",(null==t.tokens?null:t.tokens.length)>=1),u.xp6(10),u.hij("\n      ",u.lcZ(15,4,"revokeAccessTokens"),"\n    "))},dependencies:[Un.M,s.sg,s.O5,De.r,M.Q,vn.M,fn.t,mn.e,Ye.a,Ge.Y,Me.v,Ye.f,s.uU,ge.C],encapsulation:2});var Uc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Ac{constructor(e,t,n,i,o,s){this.route=e,this.accessService=t,this.dialogService=n,this.platformUtilsService=i,this.i18nService=o,this.serviceAccountService=s,this.destroy$=new Pe.x}ngOnInit(){this.accessTokens$=this.accessService.accessToken$.pipe((0,ke.O)(null),(0,Vo.V)(this.route.params),(0,Ce.w)((([e,t])=>Uc(this,void 0,void 0,(function*(){return this.accessService.getAccessTokens(t.organizationId,t.serviceAccountId)}))))),this.serviceAccountService.serviceAccount$.pipe((0,ke.O)(null),(0,Vo.V)(this.route.params),(0,Ce.w)((([e,t])=>this.serviceAccountService.getByServiceAccountId(t.serviceAccountId,t.organizationId))),(0,je.R)(this.destroy$)).subscribe((e=>{this.serviceAccountView=e}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}revoke(e){return Uc(this,void 0,void 0,(function*(){(null==e?void 0:e.length)?(yield this.verifyUser())&&(yield this.accessService.revokeAccessTokens(this.serviceAccountView.id,e.map((e=>e.id))),this.platformUtilsService.showToast("success",null,this.i18nService.t("accessTokenRevoked"))):this.platformUtilsService.showToast("error",null,this.i18nService.t("noAccessTokenSelected"))}))}openNewAccessTokenDialog(){pc.openNewAccessTokenDialog(this.dialogService,this.serviceAccountView)}verifyUser(){const e=(0,Ks.CV)(this.dialogService,{data:{confirmDescription:"revokeAccessTokenDesc",confirmButtonText:"revokeAccessToken",modalTitle:"revokeAccessToken"}});if(null!=e)return(0,cs.z)(e.closed)}}Ac.ɵfac=function(e){return new(e||Ac)(u.Y36(c.gz),u.Y36(sc),u.Y36(ut.x),u.Y36(at.P),u.Y36(rt.D),u.Y36(cn))},Ac.ɵcmp=u.Xpm({type:Ac,selectors:[["sm-access-tokens"]],decls:3,vars:3,consts:[[3,"tokens","newAccessTokenEvent","revokeAccessTokensEvent"]],template:function(e,t){1&e&&(u.TgZ(0,"sm-access-list",0),u.NdJ("newAccessTokenEvent",(function(){return t.openNewAccessTokenDialog()}))("revokeAccessTokensEvent",(function(e){return t.revoke(e)})),u.ALo(1,"async"),u.qZA(),u._uU(2,"\n")),2&e&&u.Q6J("tokens",u.lcZ(1,1,t.accessTokens$))},dependencies:[wc,s.Ov],encapsulation:2});var _c=n(37032),bc=n(7274),yc=n(63280),Zc=n(77787),xc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Sc{constructor(e){this.apiService=e}getEvents(e,t,n,i){return xc(this,void 0,void 0,(function*(){const o=yield this.apiService.send("GET",this.addEventParameters("/sm/events/service-accounts/"+e,t,n,i),null,!0,!0);return new $e.L(o,Zc.U)}))}addEventParameters(e,t,n,i){return null!=t&&(e+="?start="+t),null!=n&&(e+=e.indexOf("?")>-1?"&":"?",e+="end="+n),null!=i&&(e+=e.indexOf("?")>-1?"&":"?",e+="continuationToken="+i),e}}Sc.ɵfac=function(e){return new(e||Sc)(u.LFG(it.s))},Sc.ɵprov=u.Yz7({token:Sc,factory:Sc.ɵfac,providedIn:"root"});var Tc=n(66459),Ic=n(53481),Pc=n(24610),qc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function jc(e,t){1&e&&(u.ynx(0),u._uU(1,"\n  "),u._UZ(2,"i",11),u.ALo(3,"i18n"),u._uU(4,"\n  "),u.TgZ(5,"span",12),u._uU(6),u.ALo(7,"i18n"),u.qZA(),u._uU(8,"\n"),u.BQk()),2&e&&(u.xp6(2),u.s9C("title",u.lcZ(3,2,"loading")),u.xp6(4),u.Oqu(u.lcZ(7,4,"loading")))}function kc(e,t){1&e&&(u.TgZ(0,"p"),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"noEventsInList")))}function Cc(e,t){if(1&e&&(u.TgZ(0,"tr",18),u._uU(1,"\n        "),u.TgZ(2,"td",19),u._uU(3),u.ALo(4,"date"),u.qZA(),u._uU(5,"\n        "),u.TgZ(6,"td",15),u._uU(7,"\n          "),u.TgZ(8,"span",20),u._uU(9),u.qZA(),u._uU(10,"\n        "),u.qZA(),u._uU(11,"\n        "),u._UZ(12,"td",21),u._uU(13,"\n      "),u.qZA()),2&e){const e=t.$implicit;u.xp6(3),u.Oqu(u.xi3(4,5,e.date,"medium")),u.xp6(5),u.hYB("title","",e.appName,", ",e.ip,""),u.xp6(1),u.Oqu(e.appName),u.xp6(3),u.Q6J("innerHTML",e.message,u.oJD)}}function Lc(e,t){if(1&e&&(u._uU(0,"\n      "),u.YNc(1,Cc,14,8,"tr",17),u._uU(2,"\n    ")),2&e){const e=u.oxw(3);u.xp6(1),u.Q6J("ngForOf",e.events)}}function Oc(e,t){1&e&&(u.TgZ(0,"bit-table"),u._uU(1,"\n    "),u.ynx(2,14),u._uU(3,"\n      "),u.TgZ(4,"tr"),u._uU(5,"\n        "),u.TgZ(6,"th",15),u._uU(7),u.ALo(8,"i18n"),u.qZA(),u._uU(9,"\n        "),u.TgZ(10,"th",15),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n        "),u.TgZ(14,"th",15),u._uU(15),u.ALo(16,"i18n"),u.qZA(),u._uU(17,"\n      "),u.qZA(),u._uU(18,"\n    "),u.BQk(),u._uU(19,"\n    "),u.YNc(20,Lc,3,1,"ng-template",16),u._uU(21,"\n  "),u.qZA()),2&e&&(u.xp6(7),u.Oqu(u.lcZ(8,3,"timestamp")),u.xp6(4),u.Oqu(u.lcZ(12,5,"client")),u.xp6(4),u.Oqu(u.lcZ(16,7,"event")))}function Nc(e,t){1&e&&(u._UZ(0,"i",25),u.ALo(1,"i18n")),2&e&&u.s9C("title",u.lcZ(1,1,"loading"))}function Jc(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",22,23),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw(2);return u.KtG(t.loadEvents(!1))})),u._uU(2,"\n    "),u.YNc(3,Nc,2,3,"i",24),u._uU(4,"\n    "),u.TgZ(5,"span"),u._uU(6),u.ALo(7,"i18n"),u.qZA(),u._uU(8,"\n  "),u.qZA()}if(2&e){const e=u.MAs(1),t=u.oxw(2);u.Q6J("appApiAction",t.morePromise)("disabled",t.loaded&&e.loading),u.xp6(3),u.Q6J("ngIf",e.loading),u.xp6(3),u.Oqu(u.lcZ(7,4,"loadMore"))}}function Dc(e,t){if(1&e&&(u.ynx(0),u._uU(1,"\n  "),u.YNc(2,kc,3,3,"p",10),u._uU(3,"\n  "),u.YNc(4,Oc,22,9,"bit-table",10),u._uU(5,"\n  "),u.YNc(6,Jc,9,6,"button",13),u._uU(7,"\n"),u.BQk()),2&e){const e=u.oxw();u.xp6(2),u.Q6J("ngIf",!e.events||!e.events.length),u.xp6(2),u.Q6J("ngIf",e.events&&e.events.length),u.xp6(2),u.Q6J("ngIf",e.continuationToken)}}const Ec=function(e){return{loading:e}},zc=function(e,t){return{"bwi-sign-in":e,"bwi-spinner bwi-spin":t}};class Yc extends _c.i{constructor(e,t,n,i,o,s,c,r){super(e,i,o,s,c,r),this.serviceAccountEventsApiService=t,this.route=n,this.exportFileName="service-account-events",this.destroy$=new Pe.x}ngOnInit(){return qc(this,void 0,void 0,(function*(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>qc(this,void 0,void 0,(function*(){this.serviceAccountId=e.serviceAccountId,yield this.load()}))))}))}load(){return qc(this,void 0,void 0,(function*(){yield this.loadEvents(!0),this.loaded=!0}))}requestEvents(e,t,n){return this.serviceAccountEventsApiService.getEvents(this.serviceAccountId,e,t,n)}getUserName(){return{name:this.i18nService.t("serviceAccount")+" "+this.serviceAccountId,email:""}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}Yc.ɵfac=function(e){return new(e||Yc)(u.Y36(bc.PO),u.Y36(Sc),u.Y36(c.gz),u.Y36(rt.D),u.Y36(yc.f),u.Y36(at.P),u.Y36(Tc.$),u.Y36(Ic._))},Yc.ɵcmp=u.Xpm({type:Yc,selectors:[["sm-service-accounts-events"]],features:[u.qOj],decls:58,vars:36,consts:[[1,"tw-mb-4"],[1,"tw-mt-4","tw-flex","tw-items-center"],["bitInput","","type","datetime-local",3,"placeholder","ngModel","ngModelChange","change"],[1,"tw-mx-2"],[3,"appApiAction"],["refreshForm",""],["type","button","bitButton","","buttonType","primary",1,"tw-mx-3","tw-mt-1",3,"disabled","click"],["exportForm",""],["type","button","bitButton","",1,"tw-mt-1",3,"ngClass","disabled","click"],["aria-hidden","true",1,"bwi","bwi-fw",3,"ngClass"],[4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"],["type","button","bitButton","","buttonType","primary",3,"appApiAction","disabled","click",4,"ngIf"],["header",""],["bitCell",""],["body",""],["bitRow","","alignContent","top",4,"ngFor","ngForOf"],["bitRow","","alignContent","top"],["bitCell","",1,"tw-whitespace-nowrap"],[3,"title"],["bitCell","",3,"innerHTML"],["type","button","bitButton","","buttonType","primary",3,"appApiAction","disabled","click"],["moreBtn",""],["class","bwi bwi-spinner bwi-spin","aria-hidden","true",3,"title",4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"]],template:function(e,t){if(1&e&&(u.TgZ(0,"div",0),u._uU(1,"\n  "),u.TgZ(2,"h1"),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"div",1),u._uU(7,"\n    "),u.TgZ(8,"bit-form-field"),u._uU(9,"\n      "),u.TgZ(10,"bit-label"),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n      "),u.TgZ(14,"input",2),u.NdJ("ngModelChange",(function(e){return t.start=e}))("change",(function(){return t.dirtyDates=!0})),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n    "),u.qZA(),u._uU(17,"\n    "),u.TgZ(18,"span",3),u._uU(19,"-"),u.qZA(),u._uU(20,"\n    "),u.TgZ(21,"bit-form-field"),u._uU(22,"\n      "),u.TgZ(23,"bit-label"),u._uU(24),u.ALo(25,"i18n"),u.qZA(),u._uU(26,"\n      "),u.TgZ(27,"input",2),u.NdJ("ngModelChange",(function(e){return t.end=e}))("change",(function(){return t.dirtyDates=!0})),u.ALo(28,"i18n"),u.qZA(),u._uU(29,"\n    "),u.qZA(),u._uU(30,"\n    "),u.TgZ(31,"form",4,5),u._uU(33,"\n      "),u.TgZ(34,"button",6),u.NdJ("click",(function(){return t.loadEvents(!0)})),u._uU(35),u.ALo(36,"i18n"),u.qZA(),u._uU(37,"\n    "),u.qZA(),u._uU(38,"\n    "),u.TgZ(39,"form",4,7),u._uU(41,"\n      "),u.TgZ(42,"button",8),u.NdJ("click",(function(){return t.exportEvents()})),u._uU(43,"\n        "),u.TgZ(44,"span"),u._uU(45),u.ALo(46,"i18n"),u.qZA(),u._uU(47,"\n        "),u._UZ(48,"i",9),u._uU(49,"\n      "),u.qZA(),u._uU(50,"\n    "),u.qZA(),u._uU(51,"\n  "),u.qZA(),u._uU(52,"\n"),u.qZA(),u._uU(53,"\n"),u.YNc(54,jc,9,6,"ng-container",10),u._uU(55,"\n"),u.YNc(56,Dc,8,3,"ng-container",10),u._uU(57,"\n")),2&e){const e=u.MAs(32),n=u.MAs(40);u.xp6(3),u.Oqu(u.lcZ(4,17,"eventLogs")),u.xp6(8),u.Oqu(u.lcZ(12,19,"from")),u.xp6(3),u.s9C("placeholder",u.lcZ(15,21,"startDate")),u.Q6J("ngModel",t.start),u.xp6(10),u.Oqu(u.lcZ(25,23,"to")),u.xp6(3),u.s9C("placeholder",u.lcZ(28,25,"endDate")),u.Q6J("ngModel",t.end),u.xp6(4),u.Q6J("appApiAction",t.refreshPromise),u.xp6(3),u.Q6J("disabled",t.loaded&&e.loading),u.xp6(1),u.hij("\n        ",u.lcZ(36,27,"update"),"\n      "),u.xp6(4),u.Q6J("appApiAction",t.exportPromise),u.xp6(3),u.Q6J("ngClass",u.VKq(31,Ec,n.loading))("disabled",t.loaded&&n.loading||t.dirtyDates),u.xp6(3),u.Oqu(u.lcZ(46,29,"export")),u.xp6(3),u.Q6J("ngClass",u.WLB(33,zc,!n.loading,n.loading)),u.xp6(6),u.Q6J("ngIf",!t.loaded),u.xp6(2),u.Q6J("ngIf",t.loaded)}},dependencies:[s.mk,s.sg,s.O5,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.On,Je.F,Pc.b,De.r,ht.d,gt.G,vt.u,Ye.a,Ge.Y,Me.v,Ye.f,s.uU,ge.C],encapsulation:2});var Gc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};var Mc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function Qc(e,t){1&e&&(u.TgZ(0,"p",5),u._uU(1),u.ALo(2,"i18n"),u.qZA()),2&e&&(u.xp6(1),u.hij("\n      ",u.lcZ(2,1,"serviceAccountPeopleDescription"),"\n    "))}class Rc{constructor(e,t,n,i,o,s,c,r,a){this.route=e,this.dialogService=t,this.changeDetectorRef=n,this.validationService=i,this.accessPolicyService=o,this.router=s,this.platformUtilsService=c,this.i18nService=r,this.accessPolicySelectorService=a,this.destroy$=new Pe.x,this.currentAccessPolicies$=(0,pe.a)([this.route.params]).pipe((0,Ce.w)((([e])=>this.accessPolicyService.getServiceAccountPeopleAccessPolicies(e.serviceAccountId).then((e=>ao(e))))),(0,Fi.K)((()=>(this.router.navigate(["/sm",this.organizationId,"service-accounts"]),$i.E)))),this.potentialGrantees$=(0,pe.a)([this.route.params]).pipe((0,Ce.w)((([e])=>this.accessPolicyService.getPeoplePotentialGrantees(e.organizationId).then((e=>uo(e)))))),this.formGroup=new Je.cw({accessPolicies:new Je.NI([])}),this.loading=!0,this.staticPermission=Ri.CanReadWrite,this.submit=()=>Mc(this,void 0,void 0,(function*(){if(this.isFormInvalid())return;const e=yield this.accessPolicySelectorService.showAccessRemovalWarning(this.organizationId,this.formGroup.value.accessPolicies);if(!(yield this.handleAccessRemovalWarning(e,this.currentAccessPolicies)))try{const t=yield this.updateServiceAccountPeopleAccessPolicies(this.serviceAccountId,this.formGroup.value.accessPolicies);yield this.handleAccessTokenAvailableWarning(e,this.currentAccessPolicies,this.formGroup.value.accessPolicies),this.currentAccessPolicies=ao(t),this.platformUtilsService.showToast("success",null,this.i18nService.t("serviceAccountAccessUpdated"))}catch(t){this.validationService.showError(t),this.setSelected(this.currentAccessPolicies)}}))}ngOnInit(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.organizationId=e.organizationId,this.serviceAccountId=e.serviceAccountId})),(0,pe.a)([this.potentialGrantees$,this.currentAccessPolicies$]).pipe((0,je.R)(this.destroy$)).subscribe((([e,t])=>{this.potentialGrantees=e,this.setSelected(t)}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setSelected(e){this.loading=!0,this.currentAccessPolicies=e,null!=e&&(this.changeDetectorRef.detectChanges(),this.formGroup.patchValue({accessPolicies:e.map((e=>({type:e.type,id:e.id,permission:e.permission,currentUser:e.type==Qi.User?e.currentUser:null,currentUserInGroup:e.type==Qi.Group?e.currentUserInGroup:null})))})),this.loading=!1}isFormInvalid(){return this.formGroup.markAllAsTouched(),this.formGroup.invalid}handleAccessRemovalWarning(e,t){return Mc(this,void 0,void 0,(function*(){if(e){if(!(yield this.showWarning()))return this.setSelected(t),!0}return!1}))}updateServiceAccountPeopleAccessPolicies(e,t){return Mc(this,void 0,void 0,(function*(){const n=function(e,t){const n=new ro;return n.userAccessPolicies=t.filter((e=>e.type==Qi.User)).map((t=>{const n=new to;return n.grantedServiceAccountId=e,n.organizationUserId=t.id,n.read=Ki.toRead(t.permission),n.write=Ki.toWrite(t.permission),n.currentUser=t.currentUser,n})),n.groupAccessPolicies=t.filter((e=>e.type==Qi.Group)).map((t=>{const n=new io;return n.grantedServiceAccountId=e,n.groupId=t.id,n.read=Ki.toRead(t.permission),n.write=Ki.toWrite(t.permission),n})),n}(e,t);return yield this.accessPolicyService.putServiceAccountPeopleAccessPolicies(e,n)}))}handleAccessTokenAvailableWarning(e,t,n){return Mc(this,void 0,void 0,(function*(){e?this.router.navigate(["sm",this.organizationId,"service-accounts"]):this.accessPolicySelectorService.isAccessRemoval(t,n)&&(yield this.showAccessTokenStillAvailableWarning())}))}showWarning(){return Mc(this,void 0,void 0,(function*(){return yield this.dialogService.openSimpleDialog({title:{key:"smAccessRemovalWarningSaTitle"},content:{key:"smAccessRemovalWarningSaMessage"},acceptButtonText:{key:"removeAccess"},cancelButtonText:{key:"cancel"},type:"warning"})}))}showAccessTokenStillAvailableWarning(){return Mc(this,void 0,void 0,(function*(){yield this.dialogService.openSimpleDialog({title:{key:"saPeopleWarningTitle"},content:{key:"saPeopleWarningMessage"},type:"warning",acceptButtonText:{key:"close"},cancelButtonText:null})}))}}Rc.ɵfac=function(e){return new(e||Rc)(u.Y36(c.gz),u.Y36(ut.x),u.Y36(u.sBO),u.Y36(Po.R),u.Y36(Io),u.Y36(c.F0),u.Y36(at.P),u.Y36(rt.D),u.Y36(Wi))},Rc.ɵcmp=u.Xpm({type:Rc,selectors:[["sm-service-account-people"]],decls:19,vars:22,consts:[[3,"formGroup","bitSubmit"],[1,"tw-w-2/5"],["class","tw-mt-8",4,"ngIf"],["formControlName","accessPolicies",3,"loading","addButtonMode","items","label","hint","columnTitle","emptyMessage","staticPermission"],["bitButton","","buttonType","primary","bitFormButton","","type","submit",1,"tw-mt-7"],[1,"tw-mt-8"]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"div",1),u._uU(3,"\n    "),u.YNc(4,Qc,3,3,"p",2),u._uU(5,"\n    "),u.TgZ(6,"sm-access-policy-selector",3),u.ALo(7,"i18n"),u.ALo(8,"i18n"),u.ALo(9,"i18n"),u.ALo(10,"i18n"),u._uU(11,"\n    "),u.qZA(),u._uU(12,"\n    "),u.TgZ(13,"button",4),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n"),u.qZA(),u._uU(18,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(4),u.Q6J("ngIf",!t.loading),u.xp6(2),u.Q6J("loading",t.loading)("addButtonMode",!0)("items",t.potentialGrantees)("label",u.lcZ(7,12,"people"))("hint",u.lcZ(8,14,"projectPeopleSelectHint"))("columnTitle",u.lcZ(9,16,"name"))("emptyMessage",u.lcZ(10,18,"projectEmptyPeopleAccessPolicies"))("staticPermission",t.staticPermission),u.xp6(8),u.hij("\n      ",u.lcZ(15,20,"save"),"\n    "))},dependencies:[Qo,s.O5,Je._Y,Je.JJ,Je.JL,Je.sg,Je.u,lt.b,dt.u,De.r,ge.C],encapsulation:2});var Bc=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Fc{handleCreateAccessPolicies(e){const t=e.filter((e=>"project"===Us.getAccessItemType(e))).map((e=>{const t=new oo;return t.serviceAccountId=this.serviceAccountId,t.grantedProjectId=e.id,t.read=!0,t.write=!1,t}));return this.accessPolicyService.createGrantedPolicies(this.organizationId,this.serviceAccountId,t)}handleUpdateAccessPolicy(e){return Bc(this,void 0,void 0,(function*(){try{return yield this.accessPolicyService.updateAccessPolicy(Us.getBaseAccessPolicyView(e))}catch(t){this.validationService.showError(t)}}))}handleDeleteAccessPolicy(e){return Bc(this,void 0,void 0,(function*(){try{yield this.accessPolicyService.deleteAccessPolicy(e.accessPolicyId)}catch(t){this.validationService.showError(t)}}))}constructor(e,t,n){this.route=e,this.validationService=t,this.accessPolicyService=n,this.destroy$=new Pe.x,this.rows$=this.accessPolicyService.serviceAccountGrantedPolicyChanges$.pipe((0,ke.O)(null),(0,Vo.V)(this.route.params),(0,Ce.w)((([e,t])=>this.accessPolicyService.getGrantedPolicies(t.serviceAccountId,t.organizationId))),(0,D.U)((e=>e.map((e=>({type:"project",name:e.grantedProjectName,id:e.grantedProjectId,accessPolicyId:e.id,read:e.read,write:e.write,icon:Us.projectIcon,static:!1}))))))}ngOnInit(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.organizationId=e.organizationId,this.serviceAccountId=e.serviceAccountId}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}Fc.ɵfac=function(e){return new(e||Fc)(u.Y36(c.gz),u.Y36(Po.R),u.Y36(Io))},Fc.ɵcmp=u.Xpm({type:Fc,selectors:[["sm-service-account-projects"]],decls:15,vars:18,consts:[[1,"tw-mt-4","tw-w-2/5"],[1,"tw-mt-6"],["granteeType","projects",3,"rows","label","hint","columnTitle","emptyMessage","onCreateAccessPolicies","onDeleteAccessPolicy","onUpdateAccessPolicy"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u._uU(1,"\n  "),u.TgZ(2,"p",1),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"sm-access-selector",2),u.NdJ("onCreateAccessPolicies",(function(e){return t.handleCreateAccessPolicies(e)}))("onDeleteAccessPolicy",(function(e){return t.handleDeleteAccessPolicy(e)}))("onUpdateAccessPolicy",(function(e){return t.handleUpdateAccessPolicy(e)})),u.ALo(7,"async"),u.ALo(8,"i18n"),u.ALo(9,"i18n"),u.ALo(10,"i18n"),u.ALo(11,"i18n"),u._uU(12,"\n  "),u.qZA(),u._uU(13,"\n"),u.qZA(),u._uU(14,"\n")),2&e&&(u.xp6(3),u.hij("\n    ",u.lcZ(4,6,"serviceAccountProjectsDescription"),"\n  "),u.xp6(3),u.Q6J("rows",u.lcZ(7,8,t.rows$))("label",u.lcZ(8,10,"projects"))("hint",u.lcZ(9,12,"newSaSelectAccess"))("columnTitle",u.lcZ(10,14,"projects"))("emptyMessage",u.lcZ(11,16,"serviceAccountEmptyProjectAccesspolicies")))},dependencies:[Us,s.Ov,ge.C],encapsulation:2});const $c=function(){return[".."]},Vc=function(){return["projects"]},Kc=function(){return["people"]},Hc=function(){return["access"]},Wc=function(){return["events"]};function Xc(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"app-header",1),u._uU(1,"\n  "),u.TgZ(2,"bit-breadcrumbs",2),u._uU(3,"\n    "),u.TgZ(4,"bit-breadcrumb",3),u._uU(5),u.ALo(6,"i18n"),u.qZA(),u._uU(7,"\n  "),u.qZA(),u._uU(8,"\n  "),u._UZ(9,"sm-new-menu"),u._uU(10,"\n  "),u.TgZ(11,"bit-tab-nav-bar",4),u._uU(12,"\n    "),u.TgZ(13,"bit-tab-link",5),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n    "),u.TgZ(17,"bit-tab-link",5),u._uU(18),u.ALo(19,"i18n"),u.qZA(),u._uU(20,"\n    "),u.TgZ(21,"bit-tab-link",5),u._uU(22),u.ALo(23,"i18n"),u.qZA(),u._uU(24,"\n    "),u.TgZ(25,"bit-tab-link",5),u._uU(26),u.ALo(27,"i18n"),u.qZA(),u._uU(28,"\n  "),u.qZA(),u._uU(29,"\n  "),u.TgZ(30,"button",6),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.openNewAccessTokenDialog())})),u._uU(31,"\n    "),u._UZ(32,"i",7),u._uU(33),u.ALo(34,"i18n"),u.qZA(),u._uU(35,"\n"),u.qZA()}if(2&e){const e=t.ngIf;u.Q6J("title",e.name),u.xp6(4),u.Q6J("route",u.DdM(24,$c)),u.xp6(1),u.Oqu(u.lcZ(6,12,"serviceAccounts")),u.xp6(8),u.Q6J("route",u.DdM(25,Vc)),u.xp6(1),u.Oqu(u.lcZ(15,14,"projects")),u.xp6(3),u.Q6J("route",u.DdM(26,Kc)),u.xp6(1),u.Oqu(u.lcZ(19,16,"people")),u.xp6(3),u.Q6J("route",u.DdM(27,Hc)),u.xp6(1),u.Oqu(u.lcZ(23,18,"accessTokens")),u.xp6(3),u.Q6J("route",u.DdM(28,Wc)),u.xp6(1),u.Oqu(u.lcZ(27,20,"eventLogs")),u.xp6(7),u.hij("\n    ",u.lcZ(34,22,"newAccessToken"),"\n  ")}}class er{constructor(e,t,n,i,o,s){this.route=e,this.serviceAccountService=t,this.dialogService=n,this.router=i,this.platformUtilsService=o,this.i18nService=s,this.destroy$=new Pe.x,this.onChange$=this.serviceAccountService.serviceAccount$.pipe((0,$o.h)((e=>(null==e?void 0:e.id)===this.serviceAccountId)),(0,ke.O)(null)),this.serviceAccount$=(0,pe.a)([this.route.params,this.onChange$]).pipe((0,Ce.w)((([e,t])=>this.serviceAccountService.getByServiceAccountId(e.serviceAccountId,e.organizationId))),(0,Fi.K)((()=>(this.router.navigate(["/sm",this.organizationId,"service-accounts"]).then((()=>{this.platformUtilsService.showToast("error",null,this.i18nService.t("notFound",this.i18nService.t("serviceAccount")))})),$i.E))))}ngOnInit(){this.serviceAccount$.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.serviceAccountView=e}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}openNewAccessTokenDialog(){pc.openNewAccessTokenDialog(this.dialogService,this.serviceAccountView)}}er.ɵfac=function(e){return new(e||er)(u.Y36(c.gz),u.Y36(cn),u.Y36(ut.x),u.Y36(c.F0),u.Y36(at.P),u.Y36(rt.D))},er.ɵcmp=u.Xpm({type:er,selectors:[["sm-service-account"]],decls:5,vars:3,consts:[["icon","bwi-wrench",3,"title",4,"ngIf"],["icon","bwi-wrench",3,"title"],["slot","breadcrumbs"],["icon","bwi-angle-left",3,"route"],["label","Main","slot","tabs"],[3,"route"],["type","button","slot","secondary","bitButton","","buttonType","secondary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"]],template:function(e,t){1&e&&(u.YNc(0,Xc,36,29,"app-header",0),u.ALo(1,"async"),u._uU(2,"\n"),u._UZ(3,"router-outlet"),u._uU(4,"\n")),2&e&&u.Q6J("ngIf",u.lcZ(1,1,t.serviceAccount$))},dependencies:[ii,oi,s.O5,c.lC,De.r,bs.f,ys.G,Zs.n,xs.L,s.Ov,ge.C],encapsulation:2});var tr=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function nr(e,t){if(1&e&&(u.ynx(0),u._uU(1),u.BQk()),2&e){const e=u.oxw();u.xp6(1),u.hij("\n          ",e.data.serviceAccounts[0].name,"\n        ")}}function ir(e,t){if(1&e&&(u.ynx(0),u._uU(1),u.ALo(2,"i18n"),u.BQk()),2&e){const e=u.oxw();u.xp6(1),u.AsE("\n          ",e.data.serviceAccounts.length,"\n          ",u.lcZ(2,2,"serviceAccounts"),"\n        ")}}class or{constructor(e,t,n,i,o,s){this.dialogRef=e,this.data=t,this.serviceAccountService=n,this.i18nService=i,this.platformUtilsService=o,this.dialogService=s,this.formGroup=new Je.cw({confirmDelete:new Je.NI("",[this.matchConfirmationMessageValidator()])}),this.submit=()=>tr(this,void 0,void 0,(function*(){this.formGroup.markAllAsTouched(),this.formGroup.invalid||(yield this.delete(),this.dialogRef.close())}))}get title(){return 1===this.data.serviceAccounts.length?this.i18nService.t("deleteServiceAccount"):this.i18nService.t("deleteServiceAccounts")}get dialogContent(){return 1===this.data.serviceAccounts.length?this.i18nService.t("deleteServiceAccountDialogMessage",this.data.serviceAccounts[0].name):this.i18nService.t("deleteServiceAccountsDialogMessage")}get dialogConfirmationLabel(){return this.i18nService.t("deleteProjectInputLabel",this.dialogConfirmationMessage)}delete(){return tr(this,void 0,void 0,(function*(){const e=(yield this.serviceAccountService.delete(this.data.serviceAccounts)).filter((e=>e.errorMessage));if(e.length>0)return void this.openBulkStatusDialog(e);const t=1===this.data.serviceAccounts.length?"deleteServiceAccountToast":"deleteServiceAccountsToast";this.platformUtilsService.showToast("success",null,this.i18nService.t(t))}))}openBulkStatusDialog(e){this.dialogService.open(Fe,{data:{title:"deleteServiceAccounts",subTitle:"serviceAccounts",columnTitle:"serviceAccountName",message:"bulkDeleteProjectsErrorMessage",details:e}})}get dialogConfirmationMessage(){var e,t;return 1===(null===(e=this.data.serviceAccounts)||void 0===e?void 0:e.length)?this.i18nService.t("deleteProjectConfirmMessage",this.data.serviceAccounts[0].name):this.i18nService.t("deleteServiceAccountsConfirmMessage",null===(t=this.data.serviceAccounts)||void 0===t?void 0:t.length.toString())}matchConfirmationMessageValidator(){return e=>this.dialogConfirmationMessage.toLowerCase()==e.value.toLowerCase()?null:{confirmationDoesntMatchError:{message:this.i18nService.t("smConfirmationRequired")}}}}function sr(e,t){1&e&&(u.TgZ(0,"div",7),u._uU(1,"\n  "),u._UZ(2,"i",8),u._uU(3,"\n"),u.qZA())}function cr(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-no-items"),u._uU(1,"\n  "),u.ynx(2,9),u._uU(3),u.ALo(4,"i18n"),u.BQk(),u._uU(5,"\n  "),u.ynx(6,10),u._uU(7),u.ALo(8,"i18n"),u.BQk(),u._uU(9,"\n  "),u.TgZ(10,"button",11),u.NdJ("click",(function(){u.CHM(e);const t=u.oxw();return u.KtG(t.newServiceAccountEvent.emit())})),u._uU(11,"\n    "),u._UZ(12,"i",12),u._uU(13),u.ALo(14,"i18n"),u.qZA(),u._uU(15,"\n"),u.qZA()}2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,3,"serviceAccountsNoItemsTitle")),u.xp6(4),u.Oqu(u.lcZ(8,5,"serviceAccountsNoItemsMessage")),u.xp6(6),u.hij("\n    ",u.lcZ(14,7,"newServiceAccount"),"\n  "))}function rr(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr",24),u._uU(1,"\n      "),u.TgZ(2,"td",19),u._uU(3,"\n        "),u.TgZ(4,"input",25),u.NdJ("change",(function(t){const n=u.CHM(e).$implicit,i=u.oxw(3);return u.KtG(t?i.selection.toggle(n.id):null)})),u.qZA(),u._uU(5,"\n      "),u.qZA(),u._uU(6,"\n      "),u.TgZ(7,"td",26),u._uU(8,"\n        "),u._UZ(9,"i",27),u._uU(10,"\n      "),u.qZA(),u._uU(11,"\n      "),u.TgZ(12,"td",28),u._uU(13,"\n        "),u.TgZ(14,"a",29),u._uU(15),u.qZA(),u._uU(16,"\n      "),u.qZA(),u._uU(17,"\n      "),u.TgZ(18,"td",19),u._uU(19,"\n        "),u.TgZ(20,"span"),u._uU(21),u.qZA(),u._uU(22,"\n      "),u.qZA(),u._uU(23,"\n      "),u.TgZ(24,"td",19),u._uU(25),u.ALo(26,"date"),u.qZA(),u._uU(27,"\n      "),u.TgZ(28,"td",19),u._uU(29,"\n        "),u._UZ(30,"button",21),u.ALo(31,"i18n"),u.ALo(32,"i18n"),u._uU(33,"\n      "),u.qZA(),u._uU(34,"\n      "),u.TgZ(35,"bit-menu",null,30),u._uU(37,"\n        "),u.TgZ(38,"a",31),u._uU(39,"\n          "),u._UZ(40,"i",32),u._uU(41),u.ALo(42,"i18n"),u.qZA(),u._uU(43,"\n        "),u.TgZ(44,"button",4),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,n=u.oxw(3);return u.KtG(n.editServiceAccountEvent.emit(t.id))})),u._uU(45,"\n          "),u._UZ(46,"i",33),u._uU(47),u.ALo(48,"i18n"),u.qZA(),u._uU(49,"\n        "),u.TgZ(50,"button",4),u.NdJ("click",(function(){const t=u.CHM(e).$implicit,n=u.oxw(3);return u.KtG(n.delete(t))})),u._uU(51,"\n          "),u._UZ(52,"i",5),u._uU(53,"\n          "),u.TgZ(54,"span",6),u._uU(55),u.ALo(56,"i18n"),u.qZA(),u._uU(57,"\n        "),u.qZA(),u._uU(58,"\n      "),u.qZA(),u._uU(59,"\n    "),u.qZA()}if(2&e){const e=t.$implicit,n=u.MAs(36),i=u.oxw(3);u.xp6(4),u.Q6J("checked",i.selection.isSelected(e.id)),u.xp6(10),u.Q6J("routerLink",e.id),u.xp6(1),u.hij("\n          ",e.name,"\n        "),u.xp6(6),u.hij(" ",e.accessToSecrets," "),u.xp6(4),u.Oqu(u.xi3(26,12,e.revisionDate,"medium")),u.xp6(5),u.Q6J("title",u.lcZ(31,15,"options"))("bitMenuTriggerFor",n),u.uIk("aria-label",u.lcZ(32,17,"options")),u.xp6(8),u.Q6J("routerLink",e.id),u.xp6(3),u.hij("\n          ",u.lcZ(42,19,"viewServiceAccount"),"\n        "),u.xp6(6),u.hij("\n          ",u.lcZ(48,21,"editServiceAccount"),"\n        "),u.xp6(8),u.hij("\n            ",u.lcZ(56,23,"deleteServiceAccount"),"\n          ")}}function ar(e,t){if(1&e&&(u._uU(0,"\n    "),u.YNc(1,rr,60,25,"tr",23),u.ALo(2,"async"),u._uU(3,"\n  ")),2&e){const e=t.$implicit;u.xp6(1),u.Q6J("ngForOf",u.lcZ(2,1,e))}}function ur(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"bit-table",13),u._uU(1,"\n  "),u.ynx(2,14),u._uU(3,"\n    "),u.TgZ(4,"tr"),u._uU(5,"\n      "),u.TgZ(6,"th",15),u._uU(7,"\n        "),u.TgZ(8,"label",16),u._uU(9,"\n          "),u.TgZ(10,"input",17),u.NdJ("change",(function(t){u.CHM(e);const n=u.oxw();return u.KtG(t?n.toggleAll():null)})),u.qZA(),u._uU(11),u.ALo(12,"i18n"),u.qZA(),u._uU(13,"\n      "),u.qZA(),u._uU(14,"\n      "),u.TgZ(15,"th",18),u._uU(16),u.ALo(17,"i18n"),u.qZA(),u._uU(18,"\n      "),u.TgZ(19,"th",19),u._uU(20),u.ALo(21,"i18n"),u.qZA(),u._uU(22,"\n      "),u.TgZ(23,"th",20),u._uU(24),u.ALo(25,"i18n"),u.qZA(),u._uU(26,"\n      "),u.TgZ(27,"th",15),u._uU(28,"\n        "),u._UZ(29,"button",21),u.ALo(30,"i18n"),u.ALo(31,"i18n"),u._uU(32,"\n      "),u.qZA(),u._uU(33,"\n    "),u.qZA(),u._uU(34,"\n  "),u.BQk(),u._uU(35,"\n  "),u.YNc(36,ar,4,3,"ng-template",22),u._uU(37,"\n"),u.qZA()}if(2&e){const e=u.oxw(),t=u.MAs(7);u.Q6J("dataSource",e.dataSource),u.xp6(10),u.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected()),u.xp6(1),u.hij("\n          ",u.lcZ(12,10,"all"),"\n        "),u.xp6(5),u.Oqu(u.lcZ(17,12,"name")),u.xp6(4),u.Oqu(u.lcZ(21,14,"secrets")),u.xp6(4),u.Oqu(u.lcZ(25,16,"lastEdited")),u.xp6(5),u.Q6J("title",u.lcZ(30,18,"options"))("bitMenuTriggerFor",t),u.uIk("aria-label",u.lcZ(31,20,"options"))}}or.ɵfac=function(e){return new(e||or)(u.Y36(Ne.zj),u.Y36(Ne.Kt),u.Y36(cn),u.Y36(rt.D),u.Y36(at.P),u.Y36(ut.x))},or.ɵcmp=u.Xpm({type:or,selectors:[["ng-component"]],decls:44,vars:14,consts:[[3,"formGroup","bitSubmit"],["dialogSize","default"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],[4,"ngIf"],["bitDialogContent",""],["type","warning",3,"title"],["bitInput","","formControlName","confirmDelete"],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","danger","bitFormButton",""],["type","button","bitButton","","buttonType","secondary","bitFormButton","","bitDialogClose",""]],template:function(e,t){1&e&&(u.TgZ(0,"form",0),u._uU(1,"\n  "),u.TgZ(2,"bit-dialog",1),u._uU(3,"\n    "),u.ynx(4,2),u._uU(5,"\n      "),u.TgZ(6,"span"),u._uU(7),u.qZA(),u._uU(8,"\n      "),u.TgZ(9,"span",3),u._uU(10,"\n        "),u.YNc(11,nr,2,1,"ng-container",4),u._uU(12,"\n        "),u.YNc(13,ir,3,4,"ng-container",4),u._uU(14,"\n      "),u.qZA(),u._uU(15,"\n    "),u.BQk(),u._uU(16,"\n\n    "),u.TgZ(17,"div",5),u._uU(18,"\n      "),u.TgZ(19,"bit-callout",6),u.ALo(20,"i18n"),u._uU(21),u.qZA(),u._uU(22,"\n      "),u.TgZ(23,"bit-form-field"),u._uU(24,"\n        "),u.TgZ(25,"bit-label"),u._uU(26),u.qZA(),u._uU(27,"\n        "),u._UZ(28,"input",7),u._uU(29,"\n      "),u.qZA(),u._uU(30,"\n    "),u.qZA(),u._uU(31,"\n\n    "),u.ynx(32,8),u._uU(33,"\n      "),u.TgZ(34,"button",9),u._uU(35),u.qZA(),u._uU(36,"\n      "),u.TgZ(37,"button",10),u._uU(38),u.ALo(39,"i18n"),u.qZA(),u._uU(40,"\n    "),u.BQk(),u._uU(41,"\n  "),u.qZA(),u._uU(42,"\n"),u.qZA(),u._uU(43,"\n")),2&e&&(u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(7),u.Oqu(t.title),u.xp6(4),u.Q6J("ngIf",1==t.data.serviceAccounts.length),u.xp6(2),u.Q6J("ngIf",t.data.serviceAccounts.length>1),u.xp6(6),u.Q6J("title",u.lcZ(20,10,"warning")),u.xp6(2),u.hij("\n        ",t.dialogContent,"\n      "),u.xp6(5),u.Oqu(t.dialogConfirmationLabel),u.xp6(9),u.hij("\n        ",t.title,"\n      "),u.xp6(3),u.hij("\n        ",u.lcZ(39,12,"cancel"),"\n      "))},dependencies:[s.O5,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,lt.b,dt.u,De.r,pt.O,Ee.a,ze.f,ht.d,gt.G,vt.u,ge.C],encapsulation:2});class lr{get serviceAccounts(){return this._serviceAccounts}set serviceAccounts(e){this.selection.clear(),this._serviceAccounts=e,this.dataSource.data=e}set search(e){this.selection.clear(),this.dataSource.filter=e}constructor(e,t){this.i18nService=e,this.platformUtilsService=t,this.dataSource=new hn.G,this.newServiceAccountEvent=new u.vpe,this.deleteServiceAccountsEvent=new u.vpe,this.onServiceAccountCheckedEvent=new u.vpe,this.editServiceAccountEvent=new u.vpe,this.destroy$=new Pe.x,this.selection=new pn.Ov(!0,[]),this.selection.changed.pipe((0,je.R)(this.destroy$)).subscribe((e=>this.onServiceAccountCheckedEvent.emit(this.selection.selected)))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}isAllSelected(){var e;if((null===(e=this.selection.selected)||void 0===e?void 0:e.length)>0){return this.selection.selected.length===this.dataSource.filteredData.length}return!1}toggleAll(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.filteredData.map((e=>e.id)))}delete(e){this.deleteServiceAccountsEvent.emit([e])}bulkDeleteServiceAccounts(){this.selection.selected.length>=1?this.deleteServiceAccountsEvent.emit(this.serviceAccounts.filter((e=>this.selection.isSelected(e.id)))):this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"))}}lr.ɵfac=function(e){return new(e||lr)(u.Y36(rt.D),u.Y36(at.P))},lr.ɵcmp=u.Xpm({type:lr,selectors:[["sm-service-accounts-list"]],inputs:{serviceAccounts:"serviceAccounts",search:"search"},outputs:{newServiceAccountEvent:"newServiceAccountEvent",deleteServiceAccountsEvent:"deleteServiceAccountsEvent",onServiceAccountCheckedEvent:"onServiceAccountCheckedEvent",editServiceAccountEvent:"editServiceAccountEvent"},decls:19,vars:6,consts:[["class","tw-items-center tw-justify-center tw-pt-64 tw-text-center",4,"ngIf"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["tableMenu",""],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash","tw-text-danger"],[1,"tw-text-danger"],[1,"tw-items-center","tw-justify-center","tw-pt-64","tw-text-center"],[1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],["slot","title"],["slot","description"],["slot","button","type","button","bitButton","","buttonType","secondary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"dataSource"],["header",""],["bitCell","",1,"tw-w-0"],[1,"!tw-mb-0","tw-flex","tw-w-fit","tw-gap-2","!tw-font-bold","!tw-text-muted"],["type","checkbox",3,"checked","indeterminate","change"],["bitCell","","colspan","2","bitSortable","name","default",""],["bitCell",""],["bitCell","","bitSortable","revisionDate"],["type","button","bitIconButton","bwi-ellipsis-v","buttonType","main",3,"title","bitMenuTriggerFor"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["type","checkbox",3,"checked","change"],["bitCell","",1,"tw-w-0","tw-pr-0"],["aria-hidden","true",1,"bwi","bwi-wrench","tw-text-muted"],["bitCell","",1,"tw-break-all"],["bitLink","",3,"routerLink"],["serviceAccountMenu",""],["type","button","bitMenuItem","",3,"routerLink"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-eye"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil"]],template:function(e,t){1&e&&(u.YNc(0,sr,4,0,"div",0),u._uU(1,"\n\n"),u.YNc(2,cr,16,9,"bit-no-items",1),u._uU(3,"\n\n"),u.YNc(4,ur,38,22,"bit-table",2),u._uU(5,"\n\n"),u.TgZ(6,"bit-menu",null,3),u._uU(8,"\n  "),u.TgZ(9,"button",4),u.NdJ("click",(function(){return t.bulkDeleteServiceAccounts()})),u._uU(10,"\n    "),u._UZ(11,"i",5),u._uU(12,"\n    "),u.TgZ(13,"span",6),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n  "),u.qZA(),u._uU(17,"\n"),u.qZA(),u._uU(18,"\n")),2&e&&(u.Q6J("ngIf",!t.serviceAccounts),u.xp6(2),u.Q6J("ngIf",0==(null==t.serviceAccounts?null:t.serviceAccounts.length)),u.xp6(2),u.Q6J("ngIf",(null==t.serviceAccounts?null:t.serviceAccounts.length)>=1),u.xp6(10),u.hij("\n      ",u.lcZ(15,4,"deleteServiceAccounts"),"\n    "))},dependencies:[Un.M,s.sg,s.O5,c.rH,De.r,M.Q,h.r,vn.M,fn.t,mn.e,Ye.a,Ge.Y,Me.v,wn.T,Ye.f,s.Ov,s.uU,ge.C],encapsulation:2});var dr=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class pr{constructor(e,t,n,i){this.route=e,this.dialogService=t,this.serviceAccountService=n,this.organizationService=i}ngOnInit(){this.serviceAccounts$=(0,pe.a)([this.route.params,this.serviceAccountService.serviceAccount$.pipe((0,ke.O)(null))]).pipe((0,Ce.w)((([e])=>dr(this,void 0,void 0,(function*(){var t;return this.organizationId=e.organizationId,this.organizationEnabled=null===(t=this.organizationService.get(e.organizationId))||void 0===t?void 0:t.enabled,yield this.getServiceAccounts()})))))}openNewServiceAccountDialog(){this.dialogService.open(dn,{data:{organizationId:this.organizationId,operation:rn.Add,organizationEnabled:this.organizationEnabled}})}openEditServiceAccountDialog(e){this.dialogService.open(dn,{data:{organizationId:this.organizationId,serviceAccountId:e,operation:rn.Edit,organizationEnabled:this.organizationEnabled}})}openDeleteDialog(e){this.dialogService.open(or,{data:{serviceAccounts:e}})}getServiceAccounts(){return dr(this,void 0,void 0,(function*(){return yield this.serviceAccountService.getServiceAccounts(this.organizationId,!0)}))}}pr.ɵfac=function(e){return new(e||pr)(u.Y36(c.gz),u.Y36(ut.x),u.Y36(cn),u.Y36(j.Mn))},pr.ɵcmp=u.Xpm({type:pr,selectors:[["sm-service-accounts"]],decls:11,vars:8,consts:[[1,"tw-w-80",3,"placeholder","ngModel","ngModelChange"],[3,"serviceAccounts","search","newServiceAccountEvent","editServiceAccountEvent","deleteServiceAccountsEvent"]],template:function(e,t){1&e&&(u.TgZ(0,"app-header"),u._uU(1,"\n  "),u.TgZ(2,"bit-search",0),u.NdJ("ngModelChange",(function(e){return t.search=e})),u.ALo(3,"i18n"),u.qZA(),u._uU(4,"\n  "),u._UZ(5,"sm-new-menu"),u._uU(6,"\n"),u.qZA(),u._uU(7,"\n"),u.TgZ(8,"sm-service-accounts-list",1),u.NdJ("newServiceAccountEvent",(function(){return t.openNewServiceAccountDialog()}))("editServiceAccountEvent",(function(e){return t.openEditServiceAccountDialog(e)}))("deleteServiceAccountsEvent",(function(e){return t.openDeleteDialog(e)})),u.ALo(9,"async"),u.qZA(),u._uU(10,"\n")),2&e&&(u.xp6(2),u.Q6J("placeholder",u.lcZ(3,4,"searchServiceAccounts"))("ngModel",t.search),u.xp6(6),u.Q6J("serviceAccounts",u.lcZ(9,6,t.serviceAccounts$))("search",t.search))},dependencies:[ii,oi,Es.g,Je.JJ,Je.On,lr,s.Ov,ge.C],encapsulation:2});const hr=[{path:"",component:pr},{path:":serviceAccountId",component:er,canActivate:[e=>Gc(void 0,void 0,void 0,(function*(){const t=(0,u.f3M)(cn);try{if(yield t.getByServiceAccountId(e.params.serviceAccountId,e.params.organizationId))return!0}catch(n){return(0,c.RI)(e,["/sm",e.params.organizationId,"service-accounts"])}return(0,c.RI)(e,["/sm",e.params.organizationId,"service-accounts"])}))],children:[{path:"",pathMatch:"full",redirectTo:"projects"},{path:"access",component:Ac},{path:"people",component:Rc},{path:"projects",component:Fc},{path:"events",component:Yc}]}];class gr{}gr.ɵfac=function(e){return new(e||gr)},gr.ɵmod=u.oAB({type:gr}),gr.ɵinj=u.cJS({imports:[c.Bz.forChild(hr),c.Bz]});class vr{}vr.ɵfac=function(e){return new(e||vr)},vr.ɵmod=u.oAB({type:vr}),vr.ɵinj=u.cJS({imports:[I,gr,Bi.J]});var fr=n(25679);class mr extends Error{constructor(e){super(e)}}class wr{}class Ur{}class Ar{}class _r extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.name=this.getResponseProperty("Name")}}class br extends Xe.c{constructor(e){super(e),this.id=this.getResponseProperty("Id"),this.key=this.getResponseProperty("Key"),this.value=this.getResponseProperty("Value"),this.note=this.getResponseProperty("Note");const t=this.getResponseProperty("ProjectIds");this.projectIds=null==t?void 0:t.map((e=>e.toString()))}}class yr extends Xe.c{constructor(e){super(e);const t=this.getResponseProperty("Projects"),n=this.getResponseProperty("Secrets");this.projects=null==t?void 0:t.map((e=>new _r(e))),this.secrets=null==n?void 0:n.map((e=>new br(e)))}}class Zr{}class xr{}class Sr{}var Tr=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Ir{constructor(e,t,n,i){this.apiService=e,this.encryptService=t,this.cryptoService=n,this.i18nService=i}export(e){return Tr(this,void 0,void 0,(function*(){const t=yield this.apiService.send("GET","/sm/"+e+"/export",null,!0,!0);return JSON.stringify(yield this.decryptExport(e,new yr(t)),null,"  ")}))}import(e,t){return Tr(this,void 0,void 0,(function*(){let n={};try{n=JSON.parse(t);const i=yield this.encryptImport(e,n);yield this.apiService.send("POST","/sm/"+e+"/import",i,!0,!0)}catch(i){const e=new fr.i(i,400);return this.handleServerError(e,n)}}))}encryptImport(e,t){return Tr(this,void 0,void 0,(function*(){const n=new wr;try{const i=yield this.cryptoService.getOrgKey(e);n.projects=[],n.secrets=[],n.projects=yield Promise.all(t.projects.map((e=>Tr(this,void 0,void 0,(function*(){const t=new Ur;return t.id=e.id,t.name=yield this.encryptService.encrypt(e.name,i),t}))))),n.secrets=yield Promise.all(t.secrets.map((e=>Tr(this,void 0,void 0,(function*(){const t=new Ar;return[t.key,t.value,t.note]=yield Promise.all([this.encryptService.encrypt(e.key,i),this.encryptService.encrypt(e.value,i),this.encryptService.encrypt(e.note,i)]),t.id=e.id,t.projectIds=e.projectIds,t})))))}catch(i){return null}return n}))}decryptExport(e,t){return Tr(this,void 0,void 0,(function*(){const n=yield this.cryptoService.getOrgKey(e),i=new Zr;return i.projects=[],i.secrets=[],i.projects=yield Promise.all(t.projects.map((e=>Tr(this,void 0,void 0,(function*(){const t=new xr;return t.id=e.id,t.name=yield this.encryptService.decryptToUtf8(new Ve._(e.name),n),t}))))),i.secrets=yield Promise.all(t.secrets.map((e=>Tr(this,void 0,void 0,(function*(){const t=new Sr;return[t.key,t.value,t.note]=yield Promise.all([this.encryptService.decryptToUtf8(new Ve._(e.key),n),this.encryptService.decryptToUtf8(new Ve._(e.value),n),this.encryptService.decryptToUtf8(new Ve._(e.note),n)]),t.id=e.id,t.projectIds=e.projectIds,t}))))),i}))}handleServerError(e,t){if(null==e.validationErrors)return new mr(e.message);const n=new mr;return n.lines=[],Object.entries(e.validationErrors).forEach((([e,i],o)=>{let s,c;const r=Number(e.match(/[0-9]+/)[0]);switch(e.match(/^\w+/)[0]){case"Projects":s=t.projects[r],c="Project";break;case"Secrets":s=t.secrets[r],c="Secret";break;default:return}n.lines.push({id:r+1,type:"Project"==c?"Project":"Secret",key:s.key,errorMessage:i.length>0?i[0]:""})})),n}}Ir.ɵfac=function(e){return new(e||Ir)(u.LFG(it.s),u.LFG(ot.U),u.LFG(nt.$),u.LFG(rt.D))},Ir.ɵprov=u.Yz7({token:Ir,factory:Ir.ɵfac,providedIn:"root"});var Pr=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class qr{constructor(e){this.i18nService=e}getFileName(e=null,t="json"){return Pr(this,void 0,void 0,(function*(){const n=yield(0,cs.z)(this.i18nService.locale$),i=(0,s.p6)(new Date,"yyyyMMddHHmmss",n);return"bitwarden"+(e?"_"+e:"")+"_export_"+i+"."+t}))}}qr.ɵfac=function(e){return new(e||qr)(u.LFG(rt.D))},qr.ɵprov=u.Yz7({token:qr,factory:qr.ɵfac,providedIn:"root"});var jr=n(47064),kr=n(53707),Cr=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};function Lr(e,t){if(1&e&&(u.TgZ(0,"option",7),u._uU(1),u.qZA()),2&e){const e=t.$implicit,n=t.index;u.Q6J("value",n),u.xp6(1),u.hij("\n        ",e.name,"\n      ")}}class Or{constructor(e,t,n,i,o,s,c,r,a){this.route=e,this.i18nService=t,this.organizationService=n,this.platformUtilsService=i,this.smPortingService=o,this.fileDownloadService=s,this.logService=c,this.dialogService=r,this.secretsManagerApiService=a,this.destroy$=new Pe.x,this.exportFormats=[{name:"Bitwarden (json)",fileExtension:"json"}],this.formGroup=new Je.cw({format:new Je.NI(0,[Je.kI.required])}),this.submit=()=>Cr(this,void 0,void 0,(function*(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;(yield this.verifyUser())&&(yield this.doExport())}))}ngOnInit(){return Cr(this,void 0,void 0,(function*(){this.route.params.pipe((0,Ce.w)((e=>Cr(this,void 0,void 0,(function*(){return yield this.organizationService.get(e.organizationId)})))),(0,je.R)(this.destroy$)).subscribe((e=>{this.orgName=e.name,this.orgId=e.id})),this.formGroup.get("format").disable()}))}ngOnDestroy(){return Cr(this,void 0,void 0,(function*(){this.destroy$.next(),this.destroy$.complete()}))}doExport(){return Cr(this,void 0,void 0,(function*(){const e=this.exportFormats[this.formGroup.get("format").value].fileExtension,t=yield this.secretsManagerApiService.export(this.orgId);yield this.downloadFile(t,e),this.platformUtilsService.showToast("success",null,this.i18nService.t("dataExportSuccess"))}))}downloadFile(e,t){return Cr(this,void 0,void 0,(function*(){const n=yield this.smPortingService.getFileName(null,t);this.fileDownloadService.download({fileName:n,blobData:e,blobOptions:{type:"text/plain"}})}))}verifyUser(){const e=(0,Ks.CV)(this.dialogService,{data:{confirmDescription:"exportSecretsWarningDesc",confirmButtonText:"exportSecrets",modalTitle:"confirmSecretsExport"}});if(null!=e)return(0,cs.z)(e.closed)}}function Nr(e,t){if(1&e&&(u.TgZ(0,"tr",9),u._uU(1,"\n          "),u.TgZ(2,"td",10),u._uU(3),u.qZA(),u._uU(4,"\n          "),u.TgZ(5,"td",4),u._uU(6),u.qZA(),u._uU(7,"\n        "),u.qZA()),2&e){const e=t.$implicit;u.xp6(3),u.lnq("\n            [",e.id,"] [",e.type,"] ",e.key,"\n          "),u.xp6(3),u.Oqu(e.errorMessage)}}function Jr(e,t){if(1&e&&(u._uU(0,"\n        "),u.YNc(1,Nr,8,4,"tr",8),u._uU(2,"\n      ")),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngForOf",e.errorLines)}}Or.ɵfac=function(e){return new(e||Or)(u.Y36(c.gz),u.Y36(rt.D),u.Y36(j.Mn),u.Y36(at.P),u.Y36(qr),u.Y36(Ic._),u.Y36(Tc.$),u.Y36(ut.x),u.Y36(Ir))},Or.ɵcmp=u.Xpm({type:Or,selectors:[["sm-export"]],decls:29,vars:16,consts:[[3,"formGroup","bitSubmit"],[1,"tw-my-4","tw-max-w-xl"],["type","info",3,"title"],[1,"tw-max-w-sm"],["bitInput","","formControlName","format"],[3,"value",4,"ngFor","ngForOf"],["bitButton","","bitFormButton","","type","submit","buttonType","primary"],[3,"value"]],template:function(e,t){1&e&&(u._UZ(0,"app-header"),u._uU(1,"\n\n"),u.TgZ(2,"form",0),u._uU(3,"\n  "),u.TgZ(4,"div",1),u._uU(5,"\n    "),u.TgZ(6,"app-callout",2),u.ALo(7,"i18n"),u._uU(8),u.ALo(9,"i18n"),u.qZA(),u._uU(10,"\n  "),u.qZA(),u._uU(11,"\n\n  "),u.TgZ(12,"bit-form-field",3),u._uU(13,"\n    "),u.TgZ(14,"bit-label"),u._uU(15),u.ALo(16,"i18n"),u.qZA(),u._uU(17,"\n    "),u.TgZ(18,"select",4),u._uU(19,"\n      "),u.YNc(20,Lr,2,2,"option",5),u._uU(21,"\n    "),u.qZA(),u._uU(22,"\n  "),u.qZA(),u._uU(23,"\n\n  "),u.TgZ(24,"button",6),u._uU(25),u.ALo(26,"i18n"),u.qZA(),u._uU(27,"\n"),u.qZA(),u._uU(28,"\n")),2&e&&(u.xp6(2),u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(4),u.s9C("title",u.lcZ(7,7,"exportingOrganizationSecretDataTitle")),u.xp6(2),u.hij("\n      ",u.xi3(9,9,"exportingOrganizationSecretDataDescription",t.orgName),"\n    "),u.xp6(7),u.Oqu(u.lcZ(16,12,"fileFormat")),u.xp6(5),u.Q6J("ngForOf",t.exportFormats),u.xp6(5),u.hij("\n    ",u.lcZ(26,14,"exportData"),"\n  "))},dependencies:[ii,s.sg,Je._Y,Je.YN,Je.Kr,Je.EJ,Je.JJ,Je.JL,Je.sg,Je.u,kr.O,lt.b,dt.u,De.r,ht.d,gt.G,vt.u,ge.C],encapsulation:2});class Dr{constructor(e,t,n){this.dialogRef=e,this.i18nService=t,this.data=n,this.errorLines=n.error.lines}}Dr.ɵfac=function(e){return new(e||Dr)(u.Y36(Ne.zj),u.Y36(rt.D),u.Y36(Ne.Kt))},Dr.ɵcmp=u.Xpm({type:Dr,selectors:[["ng-component"]],decls:40,vars:15,consts:[["dialogSize","large"],["bitDialogTitle",""],["bitDialogContent",""],["header",""],["bitCell",""],["body",""],["bitDialogFooter",""],["bitButton","","bitDialogClose","","buttonType","primary","type","button"],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-whitespace-nowrap"]],template:function(e,t){1&e&&(u.TgZ(0,"bit-dialog",0),u._uU(1,"\n  "),u.TgZ(2,"span",1),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"span",2),u._uU(7,"\n    "),u.TgZ(8,"div"),u._uU(9),u.ALo(10,"i18n"),u.qZA(),u._uU(11,"\n    "),u.TgZ(12,"bit-table"),u._uU(13,"\n      "),u.ynx(14,3),u._uU(15,"\n        "),u.TgZ(16,"tr"),u._uU(17,"\n          "),u.TgZ(18,"th",4),u._uU(19),u.ALo(20,"i18n"),u.qZA(),u._uU(21,"\n          "),u.TgZ(22,"th",4),u._uU(23),u.ALo(24,"i18n"),u.qZA(),u._uU(25,"\n        "),u.qZA(),u._uU(26,"\n      "),u.BQk(),u._uU(27,"\n      "),u.YNc(28,Jr,3,1,"ng-template",5),u._uU(29,"\n    "),u.qZA(),u._uU(30,"\n  "),u.qZA(),u._uU(31,"\n  "),u.ynx(32,6),u._uU(33,"\n    "),u.TgZ(34,"button",7),u._uU(35),u.ALo(36,"i18n"),u.qZA(),u._uU(37,"\n  "),u.BQk(),u._uU(38,"\n"),u.qZA(),u._uU(39,"\n")),2&e&&(u.xp6(3),u.hij("\n    ",u.lcZ(4,5,"importError"),"\n  "),u.xp6(6),u.Oqu(u.lcZ(10,7,"resolveTheErrorsBelowAndTryAgain")),u.xp6(10),u.Oqu(u.lcZ(20,9,"name")),u.xp6(4),u.Oqu(u.lcZ(24,11,"description")),u.xp6(12),u.hij("\n      ",u.lcZ(36,13,"ok"),"\n    "))},dependencies:[s.sg,De.r,Ee.a,ze.f,Ye.a,Ge.Y,Me.v,Ye.f,ge.C],encapsulation:2});var Er=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class zr{constructor(e,t,n,i,o,s,c,r){this.route=e,this.i18nService=t,this.organizationService=n,this.platformUtilsService=i,this.fileDownloadService=o,this.logService=s,this.secretsManagerPortingApiService=c,this.dialogService=r,this.destroy$=new Pe.x,this.orgId=null,this.formGroup=new Je.cw({pastedContents:new Je.NI("")}),this.submit=()=>Er(this,void 0,void 0,(function*(){var e;const t=document.getElementById("file"),n=yield this.getImportContents(t,this.formGroup.get("pastedContents").value.trim());if(null!=n)try{const t=yield this.secretsManagerPortingApiService.import(this.orgId,n);if((null===(e=null==t?void 0:t.lines)||void 0===e?void 0:e.length)>0)return void this.openImportErrorDialog(t);if(!Qt.c.isNullOrWhitespace(null==t?void 0:t.message))return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),t.message);if(null!=t)return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("errorReadingImportFile"));this.platformUtilsService.showToast("success",null,this.i18nService.t("importSuccess")),this.clearForm()}catch(i){this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("errorReadingImportFile")),this.logService.error(i)}else this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("selectFile"))}))}ngOnInit(){return Er(this,void 0,void 0,(function*(){this.route.params.pipe((0,je.R)(this.destroy$)).subscribe((e=>{this.orgId=e.organizationId}))}))}ngOnDestroy(){return Er(this,void 0,void 0,(function*(){this.destroy$.next(),this.destroy$.complete()}))}getImportContents(e,t){return Er(this,void 0,void 0,(function*(){const n=e.files;if(!(null!=n&&0!==n.length||null!=t&&""!==t))return null;let i=t;if(null!=n&&n.length>0)try{const e=yield this.getFileContents(n[0]);null!=e&&(i=e)}catch(o){this.logService.error(o)}return null==i||""===i?null:i}))}setSelectedFile(e){const t=e.target,n=t.files.length>0?t.files[0]:null;this.selectedFile=n}clearForm(){document.getElementById("file").value="",this.selectedFile=null,this.formGroup.reset({pastedContents:""})}getFileContents(e){return new Promise(((t,n)=>{const i=new FileReader;i.readAsText(e,"utf-8"),i.onload=e=>{t(e.target.result)},i.onerror=()=>{n()}}))}openImportErrorDialog(e){this.dialogService.open(Dr,{data:{error:e}})}}zr.ɵfac=function(e){return new(e||zr)(u.Y36(c.gz),u.Y36(rt.D),u.Y36(j.Mn),u.Y36(at.P),u.Y36(Ic._),u.Y36(Tc.$),u.Y36(Ir),u.Y36(ut.x))},zr.ɵcmp=u.Xpm({type:zr,selectors:[["sm-import"]],decls:48,vars:26,consts:[[1,"tw-max-w-xl",3,"formGroup","bitSubmit"],[1,"file-selector"],["bitButton","","type","button","buttonType","secondary",3,"click"],["hidden","","bitInput","","type","file","id","file","name","file","accept","application/JSON",1,"form-control-file",3,"change"],["fileSelector",""],[1,"my-4"],["for","pastedContents"],["bitInput","","id","pastedContents","name","FileContents","formControlName","pastedContents",1,"form-control"],["bitButton","","bitFormButton","","type","submit","buttonType","primary"]],template:function(e,t){if(1&e){const e=u.EpF();u._UZ(0,"app-header"),u._uU(1,"\n\n"),u.TgZ(2,"form",0),u._uU(3,"\n  "),u.TgZ(4,"bit-form-field"),u._uU(5,"\n    "),u.TgZ(6,"bit-label"),u._uU(7),u.ALo(8,"i18n"),u.qZA(),u._uU(9,"\n    "),u.TgZ(10,"div",1),u._uU(11,"\n      "),u.TgZ(12,"button",2),u.NdJ("click",(function(){u.CHM(e);const t=u.MAs(19);return u.KtG(t.click())})),u._uU(13),u.ALo(14,"i18n"),u.qZA(),u._uU(15),u.ALo(16,"i18n"),u.qZA(),u._uU(17,"\n    "),u.TgZ(18,"input",3,4),u.NdJ("change",(function(e){return t.setSelectedFile(e)})),u.qZA(),u._uU(20,"\n    "),u.TgZ(21,"bit-hint"),u._uU(22),u.ALo(23,"i18n"),u.qZA(),u._uU(24,"\n  "),u.qZA(),u._uU(25,"\n  "),u.TgZ(26,"div",5),u._uU(27),u.ALo(28,"i18n"),u.qZA(),u._uU(29,"\n  "),u.TgZ(30,"bit-form-field"),u._uU(31,"\n    "),u.TgZ(32,"bit-label",6),u._uU(33),u.ALo(34,"i18n"),u.qZA(),u._uU(35,"\n    "),u._UZ(36,"textarea",7),u._uU(37,"\n    "),u.TgZ(38,"bit-hint"),u._uU(39),u.ALo(40,"i18n"),u.qZA(),u._uU(41,"\n  "),u.qZA(),u._uU(42,"\n  "),u.TgZ(43,"button",8),u._uU(44),u.ALo(45,"i18n"),u.qZA(),u._uU(46,"\n"),u.qZA(),u._uU(47,"\n")}if(2&e){let e;u.xp6(2),u.Q6J("formGroup",t.formGroup)("bitSubmit",t.submit),u.xp6(5),u.Oqu(u.lcZ(8,10,"fileUpload")),u.xp6(6),u.hij("\n        ",u.lcZ(14,12,"chooseFile"),"\n      "),u.xp6(2),u.hij("\n      ",null!==(e=null==t.selectedFile?null:t.selectedFile.name)&&void 0!==e?e:u.lcZ(16,14,"noFileChosen"),"\n    "),u.xp6(7),u.hij("",u.lcZ(23,16,"acceptedFormats")," Bitwarden (json)"),u.xp6(5),u.hij("\n    ",u.lcZ(28,18,"or"),"\n  "),u.xp6(6),u.Oqu(u.lcZ(34,20,"copyPasteImportContents")),u.xp6(6),u.hij("",u.lcZ(40,22,"acceptedFormats")," Bitwarden (json)"),u.xp6(5),u.hij("\n    ",u.lcZ(45,24,"importData"),"\n  ")}},dependencies:[ii,Je._Y,Je.Fj,Je.JJ,Je.JL,Je.sg,Je.u,lt.b,dt.u,De.r,ht.d,gt.G,vt.u,ko.M,ge.C],encapsulation:2});const Yr=[{path:"import",component:zr,canActivate:[jr.G],data:{titleId:"importData",organizationPermissions:e=>e.isAdmin}},{path:"export",component:Or,canActivate:[jr.G],data:{titleId:"exportData",organizationPermissions:e=>e.isAdmin}}];class Gr{}Gr.ɵfac=function(e){return new(e||Gr)},Gr.ɵmod=u.oAB({type:Gr}),Gr.ɵinj=u.cJS({imports:[c.Bz.forChild(Yr),c.Bz]});class Mr{}Mr.ɵfac=function(e){return new(e||Mr)},Mr.ɵmod=u.oAB({type:Mr}),Mr.ɵinj=u.cJS({providers:[qr,Ir],imports:[I,Gr]});const Qr=n(66997).W4`
<svg xmlns="http://www.w3.org/2000/svg" width="154" height="130" fill="none">
  <path class="tw-stroke-secondary-500" d="M60.795 112.1h55.135a4 4 0 0 0 4-4V59.65M32.9 51.766V6a4 4 0 0 1 4-4h79.03a4 4 0 0 1 4 4v19.992"  stroke-width="4"/>
  <path class="tw-stroke-secondary-500" d="M46.997 21.222h13.806M69.832 21.222h13.806M93.546 21.222h13.806M46.997 44.188h13.806M69.832 44.188h13.806M93.546 44.188h13.806M50.05 67.02h10.753M69.832 67.02h13.806M93.546 67.02h13.806M46.997 90.118h13.806M69.832 90.118h13.806M93.546 90.118h13.806" stroke-width="2" stroke-linecap="round"/>
  <path class="tw-stroke-secondary-500" d="M30.914 89.366c10.477 0 18.97-8.493 18.97-18.97 0-10.476-8.493-18.97-18.97-18.97-10.476 0-18.969 8.494-18.969 18.97 0 10.477 8.493 18.97 18.97 18.97ZM2.313 117.279c2.183-16.217 15.44-27.362 29.623-27.362 14.07 0 25.942 11.022 27.898 27.33.167 1.39-.988 2.753-2.719 2.753H5c-1.741 0-2.87-1.366-2.687-2.721Z" stroke-width="4"/>
  <path class="tw-stroke-danger-500" d="m147.884 50.361-15.89-27.522c-2.31-4-8.083-4-10.392 0l-15.891 27.523c-2.309 4 .578 9 5.196 9h31.781c4.619 0 7.505-5 5.196-9Z" stroke-width="4"/>
  <path class="tw-stroke-danger-500" d="M126.798 29.406v16.066" stroke-width="4" stroke-linecap="round"/>
  <path class="tw-fill-danger-500" d="M126.798 54.727a2.635 2.635 0 1 0 0-5.27 2.635 2.635 0 0 0 0 5.27Z" />
</svg>
`;class Rr{constructor(e,t){this.organizationService=e,this.route=t,this.NoAccess=Qr,this.organizationName$=this.route.params.pipe((0,D.U)((e=>{var t;return null===(t=this.organizationService.get(e.organizationId))||void 0===t?void 0:t.name})))}}Rr.ɵfac=function(e){return new(e||Rr)(u.Y36(j.Mn),u.Y36(c.gz))},Rr.ɵcmp=u.Xpm({type:Rr,selectors:[["ng-component"]],decls:17,vars:10,consts:[[3,"title"],[3,"icon"],["slot","title"],["slot","description"]],template:function(e,t){1&e&&(u.TgZ(0,"app-header",0),u.ALo(1,"async"),u._uU(2,"\n  "),u._UZ(3,"sm-new-menu"),u._uU(4,"\n"),u.qZA(),u._uU(5,"\n"),u.TgZ(6,"bit-no-items",1),u._uU(7,"\n  "),u.ynx(8,2),u._uU(9),u.ALo(10,"i18n"),u.BQk(),u._uU(11,"\n  "),u.ynx(12,3),u._uU(13),u.ALo(14,"i18n"),u.BQk(),u._uU(15,"\n"),u.qZA(),u._uU(16,"\n")),2&e&&(u.Q6J("title",u.lcZ(1,4,t.organizationName$)),u.xp6(6),u.Q6J("icon",t.NoAccess),u.xp6(3),u.Oqu(u.lcZ(10,6,"organizationIsDisabled")),u.xp6(4),u.Oqu(u.lcZ(14,8,"secretsAccessSuspended")))},dependencies:[Un.M,ii,oi,s.Ov,ge.C],encapsulation:2});var Br=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Fr{constructor(e,t,n,i,o){this.dialogRef=e,this.secretService=t,this.i18nService=n,this.platformUtilsService=i,this.data=o,this.delete=()=>Br(this,void 0,void 0,(function*(){yield this.secretService.deleteTrashed(this.data.organizationId,this.data.secretIds);const e=1===this.data.secretIds.length?"hardDeleteSuccessToast":"hardDeletesSuccessToast";this.dialogRef.close(this.data.secretIds),this.platformUtilsService.showToast("success",null,this.i18nService.t(e))}))}get title(){return 1===this.data.secretIds.length?"hardDeleteSecret":"hardDeleteSecrets"}get submitButtonText(){return 1===this.data.secretIds.length?"deleteSecret":"deleteSecrets"}}Fr.ɵfac=function(e){return new(e||Fr)(u.Y36(Ne.zj),u.Y36(Nt),u.Y36(rt.D),u.Y36(at.P),u.Y36(Ne.Kt))},Fr.ɵcmp=u.Xpm({type:Fr,selectors:[["ng-component"]],decls:23,vars:15,consts:[["bitDialogTitle",""],["bitDialogContent",""],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"bitAction"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""]],template:function(e,t){1&e&&(u.TgZ(0,"bit-simple-dialog"),u._uU(1,"\n  "),u.TgZ(2,"span",0),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"span",1),u._uU(7),u.ALo(8,"i18n"),u.ALo(9,"i18n"),u.qZA(),u._uU(10,"\n  "),u.ynx(11,2),u._uU(12,"\n    "),u.TgZ(13,"button",3),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n    "),u.TgZ(17,"button",4),u._uU(18),u.ALo(19,"i18n"),u.qZA(),u._uU(20,"\n  "),u.BQk(),u._uU(21,"\n"),u.qZA(),u._uU(22,"\n")),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,5,t.title)),u.xp6(4),u.hij("\n    ",1===t.data.secretIds.length?u.lcZ(8,7,"hardDeleteSecretConfirmation"):u.lcZ(9,9,"hardDeleteSecretsConfirmation"),"\n  "),u.xp6(6),u.Q6J("bitAction",t.delete),u.xp6(1),u.hij("\n      ",u.lcZ(15,11,t.submitButtonText),"\n    "),u.xp6(4),u.hij("\n      ",u.lcZ(19,13,"close"),"\n    "))},dependencies:[Jt.Q,De.r,Dt.r,ze.f,ge.C],encapsulation:2});var $r=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Vr{constructor(e,t,n,i,o){this.dialogRef=e,this.secretService=t,this.i18nService=n,this.platformUtilsService=i,this.data=o,this.restore=()=>$r(this,void 0,void 0,(function*(){let e="";yield this.secretService.restoreTrashed(this.data.organizationId,this.data.secretIds),e=1===this.data.secretIds.length?"secretRestoredSuccessToast":"secretsRestoredSuccessToast",this.dialogRef.close(this.data.secretIds),this.platformUtilsService.showToast("success",null,this.i18nService.t(e))}))}get title(){return 1===this.data.secretIds.length?"restoreSecret":"restoreSecrets"}}Vr.ɵfac=function(e){return new(e||Vr)(u.Y36(Ne.zj),u.Y36(Nt),u.Y36(rt.D),u.Y36(at.P),u.Y36(Ne.Kt))},Vr.ɵcmp=u.Xpm({type:Vr,selectors:[["ng-component"]],decls:23,vars:15,consts:[["bitDialogTitle",""],["bitDialogContent",""],["bitDialogFooter",""],["type","button","bitButton","","buttonType","primary",3,"bitAction"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""]],template:function(e,t){1&e&&(u.TgZ(0,"bit-simple-dialog"),u._uU(1,"\n  "),u.TgZ(2,"span",0),u._uU(3),u.ALo(4,"i18n"),u.qZA(),u._uU(5,"\n  "),u.TgZ(6,"span",1),u._uU(7),u.ALo(8,"i18n"),u.ALo(9,"i18n"),u.qZA(),u._uU(10,"\n  "),u.ynx(11,2),u._uU(12,"\n    "),u.TgZ(13,"button",3),u._uU(14),u.ALo(15,"i18n"),u.qZA(),u._uU(16,"\n    "),u.TgZ(17,"button",4),u._uU(18),u.ALo(19,"i18n"),u.qZA(),u._uU(20,"\n  "),u.BQk(),u._uU(21,"\n"),u.qZA(),u._uU(22,"\n")),2&e&&(u.xp6(3),u.Oqu(u.lcZ(4,5,t.title)),u.xp6(4),u.hij("\n    ",1===t.data.secretIds.length?u.lcZ(8,7,"restoreSecretPrompt"):u.lcZ(9,9,"restoreSecretsPrompt"),"\n  "),u.xp6(6),u.Q6J("bitAction",t.restore),u.xp6(1),u.hij("\n      ",u.lcZ(15,11,t.title),"\n    "),u.xp6(4),u.hij("\n      ",u.lcZ(19,13,"close"),"\n    "))},dependencies:[Jt.Q,De.r,Dt.r,ze.f,ge.C],encapsulation:2});var Kr=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function c(e){try{a(i.next(e))}catch(t){s(t)}}function r(e){try{a(i.throw(e))}catch(t){s(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((i=i.apply(e,t||[])).next())}))};class Hr{constructor(e,t,n,i,o){this.route=e,this.secretService=t,this.platformUtilsService=n,this.i18nService=i,this.dialogService=o}ngOnInit(){this.secrets$=this.secretService.secret$.pipe((0,ke.O)(null),(0,Vo.V)(this.route.params),(0,Ce.w)((([e,t])=>Kr(this,void 0,void 0,(function*(){return this.organizationId=t.organizationId,yield this.getSecrets()})))))}getSecrets(){return Kr(this,void 0,void 0,(function*(){return yield this.secretService.getTrashedSecrets(this.organizationId)}))}openDeleteSecret(e){const t=e.map((e=>e.id));this.dialogService.open(Fr,{data:{secretIds:t,organizationId:this.organizationId}})}openRestoreSecret(e){this.dialogService.open(Vr,{data:{secretIds:e,organizationId:this.organizationId}})}copySecretUuid(e){Dn.copySecretUuid(e,this.platformUtilsService,this.i18nService)}}Hr.ɵfac=function(e){return new(e||Hr)(u.Y36(c.gz),u.Y36(Nt),u.Y36(at.P),u.Y36(rt.D),u.Y36(ut.x))},Hr.ɵcmp=u.Xpm({type:Hr,selectors:[["sm-trash"]],decls:13,vars:10,consts:[["type","warning",3,"title"],[3,"secrets","trash","deleteSecretsEvent","restoreSecretsEvent","copySecretUuidEvent"]],template:function(e,t){1&e&&(u.TgZ(0,"app-header"),u._uU(1,"\n  "),u._UZ(2,"sm-new-menu"),u._uU(3,"\n"),u.qZA(),u._uU(4,"\n"),u.TgZ(5,"bit-callout",0),u.ALo(6,"i18n"),u._uU(7),u.ALo(8,"i18n"),u.qZA(),u._uU(9,"\n"),u.TgZ(10,"sm-secrets-list",1),u.NdJ("deleteSecretsEvent",(function(e){return t.openDeleteSecret(e)}))("restoreSecretsEvent",(function(e){return t.openRestoreSecret(e)}))("copySecretUuidEvent",(function(e){return t.copySecretUuid(e)})),u.ALo(11,"async"),u.qZA(),u._uU(12,"\n")),2&e&&(u.xp6(5),u.Q6J("title",u.lcZ(6,4,"warning")),u.xp6(2),u.Oqu(u.lcZ(8,6,"trashCleanupWarning")),u.xp6(3),u.Q6J("secrets",u.lcZ(11,8,t.secrets$))("trash",!0))},dependencies:[ii,oi,Dn,pt.O,s.Ov,ge.C],encapsulation:2});const Wr=[{path:"",component:Hr}];class Xr{}Xr.ɵfac=function(e){return new(e||Xr)},Xr.ɵmod=u.oAB({type:Xr}),Xr.ɵinj=u.cJS({imports:[c.Bz.forChild(Wr),c.Bz]});class ea{}ea.ɵfac=function(e){return new(e||ea)},ea.ɵmod=u.oAB({type:ea}),ea.ɵinj=u.cJS({imports:[I,Xr]});const ta=[(0,q.M)("secretsManager",{path:"",children:[{path:"",canActivate:[(e,t)=>N(void 0,void 0,void 0,(function*(){const n=(0,u.f3M)(k._),i=(0,u.f3M)(L.e),o=(0,u.f3M)(j.Mn),s=(0,u.f3M)(P.a1);if(null==(yield n.getLastSync())&&(yield n.fullSync(!1)),(yield i.getAuthStatus())!==O.y.Unlocked)return s.canActivate(e,t);const r=(yield o.getAll()).find((e=>e.canAccessSecretsManager));return r?(0,c.RI)(e,["/sm",r.id]):(0,c.RI)(e,["/vault"])}))],pathMatch:"full",children:[]},{path:":organizationId",component:J,canActivate:[P.a1],children:[{path:"",component:Se,outlet:"sidebar"},{path:"",canActivate:[e=>C(void 0,void 0,void 0,(function*(){const t=(0,u.f3M)(k._),n=(0,u.f3M)(j.Mn);null==(yield t.getLastSync())&&(yield t.fullSync(!1));const i=n.get(e.params.organizationId);return null!=i&&i.canAccessSecretsManager?!!i.enabled||(0,c.RI)(e,["/sm",i.id,"organization-suspended"]):(0,c.RI)(e,["/"])}))],children:[{path:"secrets",loadChildren:()=>Vs,data:{titleId:"secrets"}},{path:"projects",loadChildren:()=>Qs,data:{titleId:"projects"}},{path:"service-accounts",loadChildren:()=>vr,data:{titleId:"serviceAccounts"}},{path:"trash",loadChildren:()=>ea,data:{titleId:"trash"}},{path:"settings",loadChildren:()=>Mr},{path:"",loadChildren:()=>Mi,pathMatch:"full"}]},{path:"organization-suspended",component:Rr}]}]})];class na{}na.ɵfac=function(e){return new(e||na)},na.ɵmod=u.oAB({type:na}),na.ɵinj=u.cJS({imports:[c.Bz.forChild(ta),c.Bz]});class ia{}ia.ɵfac=function(e){return new(e||ia)},ia.ɵmod=u.oAB({type:ia}),ia.ɵinj=u.cJS({imports:[i.m,I,na,U]})},1931:(e,t,n)=>{n.d(t,{t:()=>u});var i=n(24852),o=n(19419);function s(e,t){if(1&e&&(i.TgZ(0,"div",3),i._uU(1,"\n      "),i._uU(2,"\n      "),i.TgZ(3,"div",4),i._uU(4," "),i.qZA(),i._uU(5,"\n      "),i.TgZ(6,"div",5),i._uU(7),i.qZA(),i._uU(8,"\n    "),i.qZA()),2&e){const e=i.oxw();i.xp6(7),i.Oqu(e.textContent)}}const c=function(e){return{width:e}},r={small:["tw-h-1"],default:["tw-h-4"],large:["tw-h-6"]},a={danger:["tw-bg-danger-500"],primary:["tw-bg-primary-500"],success:["tw-bg-success-500"],warning:["tw-bg-warning-500"]};class u{constructor(){this.barWidth=0,this.bgColor="primary",this.showText=!0,this.size="default"}get displayText(){return this.showText&&"small"!==this.size}get outerBarStyles(){return["tw-overflow-hidden","tw-rounded","tw-bg-secondary-100"].concat(r[this.size])}get innerBarStyles(){return["tw-flex","tw-justify-center","tw-items-center","tw-whitespace-nowrap","tw-text-xs","tw-font-semibold","tw-text-contrast","tw-transition-all"].concat(r[this.size]).concat(a[this.bgColor])}get textContent(){return this.text||this.barWidth+"%"}}u.ɵfac=function(e){return new(e||u)},u.ɵcmp=i.Xpm({type:u,selectors:[["bit-progress"]],inputs:{barWidth:"barWidth",bgColor:"bgColor",showText:"showText",size:"size",text:"text"},decls:8,vars:7,consts:[[3,"ngClass"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",3,"ngClass","ngStyle"],["class","tw-flex tw-h-full tw-flex-wrap tw-items-center tw-overflow-hidden",4,"ngIf"],[1,"tw-flex","tw-h-full","tw-flex-wrap","tw-items-center","tw-overflow-hidden"],[1,"tw-h-full"],[1,"tw-pr-1"]],template:function(e,t){1&e&&(i.TgZ(0,"div",0),i._uU(1,"\n  "),i.TgZ(2,"div",1),i._uU(3,"\n    "),i.YNc(4,s,9,1,"div",2),i._uU(5,"\n  "),i.qZA(),i._uU(6,"\n"),i.qZA(),i._uU(7,"\n")),2&e&&(i.Q6J("ngClass",t.outerBarStyles),i.xp6(2),i.Q6J("ngClass",t.innerBarStyles)("ngStyle",i.VKq(5,c,t.barWidth+"%")),i.uIk("aria-valuenow",t.barWidth),i.xp6(2),i.Q6J("ngIf",t.displayText))},dependencies:[o.mk,o.O5,o.PC],encapsulation:2})}}]);
//# sourceMappingURL=539.ca5b58a69c27a8228832.js.map