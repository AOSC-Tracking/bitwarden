"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[228],{42228:(n,t,i)=>{i.r(t),i.d(t,{IndividualBillingModule:()=>yn});var e=i(35256),o=i(75557),s=i(24852),u=i(55602),c=i(99721),r=i(19419),a=i(81974),l=i(72081),p=i(82933),d=function(n,t,i,e){return new(i||(i=Promise))((function(o,s){function u(n){try{r(e.next(n))}catch(t){s(t)}}function c(n){try{r(e.throw(n))}catch(t){s(t)}}function r(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(n){n(t)}))).then(u,c)}r((e=e.apply(n,t||[])).next())}))};const g=function(n){return{"bwi-spin":n}};function f(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"button",3),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw();return s.KtG(t.load())})),s._uU(1,"\n    "),s._UZ(2,"i",4),s._uU(3),s.ALo(4,"i18n"),s.qZA()}if(2&n){const n=s.oxw();s.Q6J("disabled",n.loading),s.xp6(2),s.Q6J("ngClass",s.VKq(5,g,n.loading)),s.xp6(1),s.hij("\n    ",s.lcZ(4,3,"refresh"),"\n  ")}}function h(n,t){1&n&&(s.ynx(0),s._uU(1,"\n  "),s._UZ(2,"i",5),s.ALo(3,"i18n"),s._uU(4,"\n  "),s.TgZ(5,"span",6),s._uU(6),s.ALo(7,"i18n"),s.qZA(),s._uU(8,"\n"),s.BQk()),2&n&&(s.xp6(2),s.s9C("title",s.lcZ(3,2,"loading")),s.xp6(4),s.Oqu(s.lcZ(7,4,"loading")))}function U(n,t){if(1&n&&(s.ynx(0),s._uU(1,"\n  "),s._UZ(2,"app-billing-history",7),s._uU(3,"\n"),s.BQk()),2&n){const n=s.oxw();s.xp6(2),s.Q6J("billing",n.billing)}}class Z{constructor(n,t,i){this.apiService=n,this.platformUtilsService=t,this.router=i,this.loading=!1,this.firstLoaded=!1}ngOnInit(){return d(this,void 0,void 0,(function*(){this.platformUtilsService.isSelfHost()?this.router.navigate(["/settings/subscription"]):(yield this.load(),this.firstLoaded=!0)}))}load(){return d(this,void 0,void 0,(function*(){this.loading||(this.loading=!0,this.billing=yield this.apiService.getUserBillingHistory(),this.loading=!1)}))}}Z.ɵfac=function(n){return new(n||Z)(s.Y36(u.s),s.Y36(c.P),s.Y36(o.F0))},Z.ɵcmp=s.Xpm({type:Z,selectors:[["ng-component"]],decls:13,vars:6,consts:[[1,"d-flex","tabbed-header"],["type","button","bitButton","","buttonType","secondary","class","tw-ml-auto",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["type","button","bitButton","","buttonType","secondary",1,"tw-ml-auto",3,"disabled","click"],["aria-hidden","true",1,"bwi","bwi-refresh","bwi-fw",3,"ngClass"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"],[3,"billing"]],template:function(n,t){1&n&&(s.TgZ(0,"div",0),s._uU(1,"\n  "),s.TgZ(2,"h1"),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n  "),s.YNc(6,f,5,7,"button",1),s._uU(7,"\n"),s.qZA(),s._uU(8,"\n"),s.YNc(9,h,9,6,"ng-container",2),s._uU(10,"\n"),s.YNc(11,U,4,1,"ng-container",2),s._uU(12,"\n")),2&n&&(s.xp6(3),s.hij("\n    ",s.lcZ(4,4,"billingHistory"),"\n  "),s.xp6(3),s.Q6J("ngIf",t.firstLoaded),s.xp6(3),s.Q6J("ngIf",!t.firstLoaded&&t.loading),s.xp6(2),s.Q6J("ngIf",t.billing))},dependencies:[r.mk,r.O5,a.r,l.Z,p.C],encapsulation:2});var m=i(56934),_=i(78627),b=i(77097),A=i(34961),x=i(4871),y=i(66459),v=i(58172),q=i(98645),T=i(24610),S=i(24083),w=i(42759),L=i(34279),C=function(n,t,i,e){return new(i||(i=Promise))((function(o,s){function u(n){try{r(e.next(n))}catch(t){s(t)}}function c(n){try{r(e.throw(n))}catch(t){s(t)}}function r(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(n){n(t)}))).then(u,c)}r((e=e.apply(n,t||[])).next())}))};function I(n,t){1&n&&(s.TgZ(0,"div",11),s._uU(1,"\n  "),s.TgZ(2,"h1"),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n"),s.qZA()),2&n&&(s.xp6(3),s.Oqu(s.lcZ(4,1,"subscription")))}function k(n,t){1&n&&(s.TgZ(0,"div",12),s._uU(1,"\n  "),s.TgZ(2,"h1"),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n"),s.qZA()),2&n&&(s.xp6(3),s.Oqu(s.lcZ(4,1,"goPremium")))}function P(n,t){1&n&&(s.TgZ(0,"bit-callout",13),s.ALo(1,"i18n"),s._uU(2),s.ALo(3,"i18n"),s.qZA()),2&n&&(s.s9C("title",s.lcZ(1,2,"youHavePremiumAccess")),s.xp6(2),s.hij("\n  ",s.lcZ(3,4,"alreadyPremiumFromOrg"),"\n"))}function J(n,t){if(1&n&&(s.TgZ(0,"a",14),s._uU(1),s.ALo(2,"i18n"),s.qZA()),2&n){const n=s.oxw();s.MGl("href","",n.cloudWebVaultUrl,"/#/settings/premium",s.LSH),s.xp6(1),s.hij("\n    ",s.lcZ(2,2,"purchasePremium"),"\n  ")}}function Q(n,t){if(1&n){const n=s.EpF();s.ynx(0),s._uU(1,"\n  "),s.TgZ(2,"p"),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n  "),s.TgZ(6,"form",15,16),s.NdJ("ngSubmit",(function(){s.CHM(n);const t=s.oxw();return s.KtG(t.submit())})),s._uU(8,"\n    "),s.TgZ(9,"div",17),s._uU(10,"\n      "),s.TgZ(11,"label",18),s._uU(12),s.ALo(13,"i18n"),s.qZA(),s._uU(14,"\n      "),s._UZ(15,"input",19),s._uU(16,"\n      "),s.TgZ(17,"small",20),s._uU(18),s.ALo(19,"i18n"),s.qZA(),s._uU(20,"\n    "),s.qZA(),s._uU(21,"\n    "),s.TgZ(22,"button",21),s._uU(23),s.ALo(24,"i18n"),s.qZA(),s._uU(25,"\n  "),s.qZA(),s._uU(26,"\n"),s.BQk()}if(2&n){const n=s.MAs(7),t=s.oxw();s.xp6(3),s.Oqu(s.lcZ(4,6,"uploadLicenseFilePremium")),s.xp6(3),s.Q6J("appApiAction",t.formPromise),s.xp6(6),s.Oqu(s.lcZ(13,8,"licenseFile")),s.xp6(6),s.Oqu(s.xi3(19,10,"licenseFileDesc","bitwarden_premium_license.json")),s.xp6(4),s.Q6J("loading",n.loading),s.xp6(1),s.hij("\n      ",s.lcZ(24,13,"submit"),"\n    ")}}function Y(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"form",15,16),s.NdJ("ngSubmit",(function(){s.CHM(n);const t=s.oxw();return s.KtG(t.submit())})),s._uU(2,"\n  "),s.TgZ(3,"h2",22),s._uU(4),s.ALo(5,"i18n"),s.qZA(),s._uU(6,"\n  "),s.TgZ(7,"div",23),s._uU(8,"\n    "),s.TgZ(9,"div",24),s._uU(10,"\n      "),s.TgZ(11,"label",25),s._uU(12),s.ALo(13,"i18n"),s.qZA(),s._uU(14,"\n      "),s.TgZ(15,"input",26),s.NdJ("ngModelChange",(function(t){s.CHM(n);const i=s.oxw();return s.KtG(i.additionalStorage=t)})),s.ALo(16,"i18n"),s.qZA(),s._uU(17,"\n      "),s.TgZ(18,"small",27),s._uU(19),s.ALo(20,"i18n"),s.ALo(21,"currency"),s.ALo(22,"i18n"),s.qZA(),s._uU(23,"\n    "),s.qZA(),s._uU(24,"\n  "),s.qZA(),s._uU(25,"\n  "),s.TgZ(26,"h2",28),s._uU(27),s.ALo(28,"i18n"),s.qZA(),s._uU(29),s.ALo(30,"i18n"),s.ALo(31,"currency"),s._UZ(32,"br"),s._uU(33),s.ALo(34,"i18n"),s.ALo(35,"currency"),s.ALo(36,"currency"),s._UZ(37,"hr",29),s._uU(38,"\n  "),s.TgZ(39,"h2",30),s._uU(40),s.ALo(41,"i18n"),s.qZA(),s._uU(42,"\n  "),s._UZ(43,"app-payment",31),s._uU(44,"\n  "),s._UZ(45,"app-tax-info"),s._uU(46,"\n  "),s.TgZ(47,"div",32),s._uU(48,"\n    "),s.TgZ(49,"div",33),s._uU(50),s.ALo(51,"i18n"),s.ALo(52,"currency"),s._UZ(53,"br"),s._uU(54,"\n      "),s.ynx(55),s._uU(56),s.ALo(57,"i18n"),s.ALo(58,"currency"),s.BQk(),s._uU(59,"\n    "),s.qZA(),s._uU(60,"\n    "),s._UZ(61,"hr",34),s._uU(62,"\n    "),s.TgZ(63,"p",35),s._uU(64,"\n      "),s.TgZ(65,"strong"),s._uU(66),s.ALo(67,"i18n"),s.qZA(),s._uU(68),s.ALo(69,"currency"),s.ALo(70,"i18n"),s.qZA(),s._uU(71,"\n  "),s.qZA(),s._uU(72,"\n  "),s.TgZ(73,"small",36),s._uU(74),s.ALo(75,"i18n"),s.qZA(),s._uU(76,"\n  "),s.TgZ(77,"button",37),s._uU(78),s.ALo(79,"i18n"),s.qZA(),s._uU(80,"\n"),s.qZA()}if(2&n){const n=s.MAs(1),t=s.oxw();s.Q6J("appApiAction",t.formPromise),s.xp6(4),s.Oqu(s.lcZ(5,25,"addons")),s.xp6(8),s.Oqu(s.lcZ(13,27,"additionalStorageGb")),s.xp6(3),s.s9C("placeholder",s.lcZ(16,29,"additionalStorageGbDesc")),s.Q6J("ngModel",t.additionalStorage),s.xp6(4),s.Oqu(s.gM2(20,31,"additionalStorageIntervalDesc","1 GB",s.xi3(21,36,t.storageGbPrice,"$"),s.lcZ(22,39,"year"))),s.xp6(8),s.Oqu(s.lcZ(28,41,"summary")),s.xp6(2),s.AsE("\n  ",s.lcZ(30,43,"premiumMembership"),": ",s.xi3(31,45,t.premiumPrice,"$")," "),s.xp6(4),s.HOy("\n  ",s.lcZ(34,48,"additionalStorageGb"),": ",t.additionalStorage||0," GB ×\n  ",s.xi3(35,50,t.storageGbPrice,"$")," =\n  ",s.xi3(36,53,t.additionalStorageTotal,"$"),"\n  "),s.xp6(7),s.Oqu(s.lcZ(41,56,"paymentInformation")),s.xp6(3),s.Q6J("hideBank",!0),s.xp6(7),s.AsE("\n      ",s.lcZ(51,58,"planPrice"),": ",s.xi3(52,60,t.subtotal,"USD $"),"\n      "),s.xp6(6),s.AsE("\n        ",s.lcZ(57,63,"estimatedTax"),": ",s.xi3(58,65,t.taxCharges,"USD $"),"\n      "),s.xp6(10),s.hij("",s.lcZ(67,68,"total"),":"),s.xp6(2),s.AsE(" ",s.xi3(69,70,t.total,"USD $"),"/",s.lcZ(70,73,"year"),"\n    "),s.xp6(6),s.Oqu(s.lcZ(75,75,"paymentChargedAnnually")),s.xp6(3),s.Q6J("loading",n.loading),s.xp6(1),s.hij("\n    ",s.lcZ(79,77,"submit"),"\n  ")}}const N=function(n){return{"mb-0":n}},O=function(){return{plan:"families"}};class H{constructor(n,t,i,e,o,s,u,c,r,a){this.apiService=n,this.i18nService=t,this.platformUtilsService=i,this.tokenService=e,this.router=o,this.messagingService=s,this.syncService=u,this.logService=c,this.stateService=r,this.environmentService=a,this.canAccessPremium=!1,this.selfHosted=!1,this.premiumPrice=10,this.familyPlanMaxUserCount=6,this.storageGbPrice=4,this.additionalStorage=0,this.selfHosted=i.isSelfHost(),this.cloudWebVaultUrl=this.environmentService.getCloudWebVaultUrl()}ngOnInit(){return C(this,void 0,void 0,(function*(){this.canAccessPremium=yield this.stateService.getCanAccessPremium();(yield this.stateService.getHasPremiumPersonally())&&this.router.navigate(["/settings/subscription/user-subscription"])}))}submit(){return C(this,void 0,void 0,(function*(){let n=null;if(this.selfHosted){if(n=document.getElementById("file").files,null==n||0===n.length)return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("selectFile"))}try{if(this.selfHosted){if(!this.tokenService.getEmailVerified())return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("verifyEmailFirst"));const t=new FormData;t.append("license",n[0]),this.formPromise=this.apiService.postAccountLicense(t).then((()=>this.finalizePremium()))}else this.formPromise=this.paymentComponent.createPaymentToken().then((n=>{const t=new FormData;return t.append("paymentMethodType",n[1].toString()),null!=n[0]&&t.append("paymentToken",n[0]),t.append("additionalStorageGb",(this.additionalStorage||0).toString()),t.append("country",this.taxInfoComponent.taxInfo.country),t.append("postalCode",this.taxInfoComponent.taxInfo.postalCode),this.apiService.postPremium(t)})).then((n=>n.success||null==n.paymentIntentClientSecret?this.finalizePremium():this.paymentComponent.handleStripeCardPayment(n.paymentIntentClientSecret,(()=>this.finalizePremium()))));yield this.formPromise}catch(t){this.logService.error(t)}}))}finalizePremium(){return C(this,void 0,void 0,(function*(){yield this.apiService.refreshIdentityToken(),yield this.syncService.fullSync(!0),this.platformUtilsService.showToast("success",null,this.i18nService.t("premiumUpdated")),this.messagingService.send("purchasedPremium"),this.router.navigate(["/settings/subscription/user-subscription"])}))}get additionalStorageTotal(){return this.storageGbPrice*Math.abs(this.additionalStorage||0)}get subtotal(){return this.premiumPrice+this.additionalStorageTotal}get taxCharges(){return null!=this.taxInfoComponent&&null!=this.taxInfoComponent.taxRate?this.taxInfoComponent.taxRate/100*this.subtotal:0}get total(){return this.subtotal+this.taxCharges||0}}H.ɵfac=function(n){return new(n||H)(s.Y36(u.s),s.Y36(_.D),s.Y36(c.P),s.Y36(b.B),s.Y36(o.F0),s.Y36(A.o),s.Y36(x._),s.Y36(y.$),s.Y36(v.b),s.Y36(m.L$))},H.ɵcmp=s.Xpm({type:H,selectors:[["ng-component"]],viewQuery:function(n,t){if(1&n&&(s.Gf(e.pV,5),s.Gf(e.Fi,5)),2&n){let n;s.iGM(n=s.CRH())&&(t.paymentComponent=n.first),s.iGM(n=s.CRH())&&(t.taxInfoComponent=n.first)}},decls:73,vars:46,consts:[["class","page-header",4,"ngIf"],["class","tabbed-header",4,"ngIf"],["type","info","icon","bwi bwi-star-f",3,"title",4,"ngIf"],["type","success"],[1,"bwi-ul"],["aria-hidden","true",1,"bwi","bwi-check","text-success","bwi-li"],[1,"text-lg",3,"ngClass"],["routerLink","/create-organization",3,"queryParams"],["bitButton","","target","_blank","rel","noopener","buttonType","secondary",3,"href",4,"ngIf"],[4,"ngIf"],["ngNativeValidate","",3,"appApiAction","ngSubmit",4,"ngIf"],[1,"page-header"],[1,"tabbed-header"],["type","info","icon","bwi bwi-star-f",3,"title"],["bitButton","","target","_blank","rel","noopener","buttonType","secondary",3,"href"],["ngNativeValidate","",3,"appApiAction","ngSubmit"],["form",""],[1,"form-group"],["for","file"],["type","file","id","file","name","file","required","",1,"form-control-file"],[1,"form-text","text-muted"],["type","submit","buttonType","primary","bitButton","",3,"loading"],[1,"mt-5"],[1,"row"],[1,"form-group","col-6"],["for","additionalStorage"],["id","additionalStorage","type","number","name","AdditionalStorageGb","min","0","max","99","step","1",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"text-muted","form-text"],[1,"spaced-header"],[1,"my-3"],[1,"spaced-header","mb-4"],[3,"hideBank"],["id","price",1,"my-4"],[1,"text-muted","text-sm"],[1,"my-1","col-3","ml-0"],[1,"text-lg"],[1,"text-muted","font-italic"],["type","submit","bitButton","",3,"loading"]],template:function(n,t){1&n&&(s.YNc(0,I,6,3,"div",0),s._uU(1,"\n"),s.YNc(2,k,6,3,"div",1),s._uU(3,"\n"),s.YNc(4,P,4,6,"bit-callout",2),s._uU(5,"\n"),s.TgZ(6,"bit-callout",3),s._uU(7,"\n  "),s.TgZ(8,"p"),s._uU(9),s.ALo(10,"i18n"),s.qZA(),s._uU(11,"\n  "),s.TgZ(12,"ul",4),s._uU(13,"\n    "),s.TgZ(14,"li"),s._uU(15,"\n      "),s._UZ(16,"i",5),s._uU(17),s.ALo(18,"i18n"),s.qZA(),s._uU(19,"\n    "),s.TgZ(20,"li"),s._uU(21,"\n      "),s._UZ(22,"i",5),s._uU(23),s.ALo(24,"i18n"),s.qZA(),s._uU(25,"\n    "),s.TgZ(26,"li"),s._uU(27,"\n      "),s._UZ(28,"i",5),s._uU(29),s.ALo(30,"i18n"),s.qZA(),s._uU(31,"\n    "),s.TgZ(32,"li"),s._uU(33,"\n      "),s._UZ(34,"i",5),s._uU(35),s.ALo(36,"i18n"),s.qZA(),s._uU(37,"\n    "),s.TgZ(38,"li"),s._uU(39,"\n      "),s._UZ(40,"i",5),s._uU(41),s.ALo(42,"i18n"),s.qZA(),s._uU(43,"\n    "),s.TgZ(44,"li"),s._uU(45,"\n      "),s._UZ(46,"i",5),s._uU(47),s.ALo(48,"i18n"),s.qZA(),s._uU(49,"\n    "),s.TgZ(50,"li"),s._uU(51,"\n      "),s._UZ(52,"i",5),s._uU(53),s.ALo(54,"i18n"),s.qZA(),s._uU(55,"\n  "),s.qZA(),s._uU(56,"\n  "),s.TgZ(57,"p",6),s._uU(58),s.ALo(59,"i18n"),s.ALo(60,"currency"),s.TgZ(61,"a",7),s._uU(62),s.ALo(63,"i18n"),s.qZA(),s._uU(64,"\n  "),s.qZA(),s._uU(65,"\n  "),s.YNc(66,J,3,4,"a",8),s._uU(67,"\n"),s.qZA(),s._uU(68,"\n"),s.YNc(69,Q,27,15,"ng-container",9),s._uU(70,"\n"),s.YNc(71,Y,81,79,"form",10),s._uU(72,"\n")),2&n&&(s.Q6J("ngIf",t.selfHosted),s.xp6(2),s.Q6J("ngIf",!t.selfHosted),s.xp6(2),s.Q6J("ngIf",t.canAccessPremium),s.xp6(5),s.Oqu(s.lcZ(10,18,"premiumUpgradeUnlockFeatures")),s.xp6(8),s.hij("\n      ",s.lcZ(18,20,"premiumSignUpStorage"),"\n    "),s.xp6(6),s.hij("\n      ",s.lcZ(24,22,"premiumSignUpTwoStepOptions"),"\n    "),s.xp6(6),s.hij("\n      ",s.lcZ(30,24,"premiumSignUpEmergency"),"\n    "),s.xp6(6),s.hij("\n      ",s.lcZ(36,26,"premiumSignUpReports"),"\n    "),s.xp6(6),s.hij("\n      ",s.lcZ(42,28,"premiumSignUpTotp"),"\n    "),s.xp6(6),s.hij("\n      ",s.lcZ(48,30,"premiumSignUpSupport"),"\n    "),s.xp6(6),s.hij("\n      ",s.lcZ(54,32,"premiumSignUpFuture"),"\n    "),s.xp6(4),s.Q6J("ngClass",s.VKq(43,N,!t.selfHosted)),s.xp6(1),s.hij("\n    ",s.Dn7(59,34,"premiumPriceWithFamilyPlan",s.xi3(60,38,t.premiumPrice,"$"),t.familyPlanMaxUserCount),"\n    "),s.xp6(3),s.Q6J("queryParams",s.DdM(45,O)),s.xp6(1),s.Oqu(s.lcZ(63,41,"bitwardenFamiliesPlan")),s.xp6(4),s.Q6J("ngIf",t.selfHosted),s.xp6(3),s.Q6J("ngIf",t.selfHosted),s.xp6(2),s.Q6J("ngIf",!t.selfHosted))},dependencies:[o.rH,r.mk,r.O5,q.Fj,q.wV,q.JJ,q.JL,q.qQ,q.Fd,q.On,q.F,T.b,a.r,S.O,w.p,L.F,r.H9,p.C],encapsulation:2});var j=function(n,t,i,e){return new(i||(i=Promise))((function(o,s){function u(n){try{r(e.next(n))}catch(t){s(t)}}function c(n){try{r(e.throw(n))}catch(t){s(t)}}function r(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(n){n(t)}))).then(u,c)}r((e=e.apply(n,t||[])).next())}))};function B(n,t){if(1&n&&(s.TgZ(0,"div",1),s._uU(1,"\n  "),s.TgZ(2,"ul",2),s._uU(3,"\n    "),s.TgZ(4,"li",3),s._uU(5,"\n      "),s.TgZ(6,"a",4),s._uU(7),s.ALo(8,"i18n"),s.qZA(),s._uU(9,"\n    "),s.qZA(),s._uU(10,"\n    "),s.TgZ(11,"li",3),s._uU(12,"\n      "),s.TgZ(13,"a",5),s._uU(14),s.ALo(15,"i18n"),s.qZA(),s._uU(16,"\n    "),s.qZA(),s._uU(17,"\n    "),s.TgZ(18,"li",3),s._uU(19,"\n      "),s.TgZ(20,"a",6),s._uU(21),s.ALo(22,"i18n"),s.qZA(),s._uU(23,"\n    "),s.qZA(),s._uU(24,"\n  "),s.qZA(),s._uU(25,"\n"),s.qZA()),2&n){const n=s.oxw();s.xp6(6),s.Q6J("routerLink",n.subscriptionRoute),s.xp6(1),s.hij("\n        ",s.lcZ(8,4,"subscription"),"\n      "),s.xp6(7),s.hij("\n        ",s.lcZ(15,6,"paymentMethod"),"\n      "),s.xp6(7),s.hij("\n        ",s.lcZ(22,8,"billingHistory"),"\n      ")}}class M{constructor(n,t){this.stateService=n,this.platformUtilsService=t}ngOnInit(){return j(this,void 0,void 0,(function*(){this.hasPremium=yield this.stateService.getHasPremiumPersonally(),this.selfHosted=this.platformUtilsService.isSelfHost()}))}get subscriptionRoute(){return this.hasPremium?"user-subscription":"premium"}}M.ɵfac=function(n){return new(n||M)(s.Y36(v.b),s.Y36(c.P))},M.ɵcmp=s.Xpm({type:M,selectors:[["ng-component"]],decls:4,vars:1,consts:[["class","tabbed-nav d-flex flex-column",4,"ngIf"],[1,"tabbed-nav","d-flex","flex-column"],[1,"nav","nav-tabs"],[1,"nav-item"],["routerLinkActive","active",1,"nav-link",3,"routerLink"],["routerLink","payment-method","routerLinkActive","active",1,"nav-link"],["routerLink","billing-history","routerLinkActive","active",1,"nav-link"]],template:function(n,t){1&n&&(s.YNc(0,B,26,10,"div",0),s._uU(1,"\n"),s._UZ(2,"router-outlet"),s._uU(3,"\n")),2&n&&s.Q6J("ngIf",!t.selfHosted)},dependencies:[o.lC,o.rH,o.Od,r.O5,p.C],encapsulation:2});var F=i(53481),G=i(73369),D=i(33245),E=i(66385),$=i(71837),K=i(24681),z=function(n,t,i,e){return new(i||(i=Promise))((function(o,s){function u(n){try{r(e.next(n))}catch(t){s(t)}}function c(n){try{r(e.throw(n))}catch(t){s(t)}}function r(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(n){n(t)}))).then(u,c)}r((e=e.apply(n,t||[])).next())}))};function V(n,t){1&n&&(s.TgZ(0,"small"),s._uU(1,"\n      "),s._UZ(2,"i",2),s.ALo(3,"i18n"),s._uU(4,"\n      "),s.TgZ(5,"span",3),s._uU(6),s.ALo(7,"i18n"),s.qZA(),s._uU(8,"\n    "),s.qZA()),2&n&&(s.xp6(2),s.s9C("title",s.lcZ(3,2,"loading")),s.xp6(4),s.Oqu(s.lcZ(7,4,"loading")))}function W(n,t){1&n&&(s.ynx(0),s._uU(1,"\n  "),s._UZ(2,"i",2),s.ALo(3,"i18n"),s._uU(4,"\n  "),s.TgZ(5,"span",3),s._uU(6),s.ALo(7,"i18n"),s.qZA(),s._uU(8,"\n"),s.BQk()),2&n&&(s.xp6(2),s.s9C("title",s.lcZ(3,2,"loading")),s.xp6(4),s.Oqu(s.lcZ(7,4,"loading")))}function R(n,t){1&n&&(s.TgZ(0,"bit-callout",6),s.ALo(1,"i18n"),s._uU(2),s.ALo(3,"i18n"),s.qZA()),2&n&&(s.s9C("title",s.lcZ(1,2,"canceled")),s.xp6(2),s.hij("\n    ",s.lcZ(3,4,"subscriptionCanceled"),""))}function X(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"bit-callout",6),s.ALo(1,"i18n"),s._uU(2,"\n    "),s.TgZ(3,"p"),s._uU(4),s.ALo(5,"i18n"),s.qZA(),s._uU(6,"\n    "),s.TgZ(7,"button",7,8),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(2);return s.KtG(t.reinstate())})),s._uU(9,"\n      "),s._UZ(10,"i",9),s.ALo(11,"i18n"),s._uU(12,"\n      "),s.TgZ(13,"span"),s._uU(14),s.ALo(15,"i18n"),s.qZA(),s._uU(16,"\n    "),s.qZA(),s._uU(17,"\n  "),s.qZA()}if(2&n){const n=s.MAs(8),t=s.oxw(2);s.s9C("title",s.lcZ(1,6,"pendingCancellation")),s.xp6(4),s.Oqu(s.lcZ(5,8,"subscriptionPendingCanceled")),s.xp6(3),s.Q6J("appApiAction",t.reinstatePromise)("disabled",n.loading),s.xp6(3),s.s9C("title",s.lcZ(11,10,"loading")),s.xp6(4),s.Oqu(s.lcZ(15,12,"reinstateSubscription"))}}function nn(n,t){if(1&n&&(s.TgZ(0,"dd"),s._uU(1),s.ALo(2,"date"),s.qZA()),2&n){const n=s.oxw(3);s.xp6(1),s.Oqu(s.xi3(2,1,n.sub.expiration,"mediumDate"))}}function tn(n,t){1&n&&(s.TgZ(0,"dd"),s._uU(1),s.ALo(2,"i18n"),s.qZA()),2&n&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"neverExpires")))}function en(n,t){if(1&n&&(s.TgZ(0,"dl"),s._uU(1,"\n    "),s.TgZ(2,"dt"),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n    "),s.YNc(6,nn,3,4,"dd",1),s._uU(7,"\n    "),s.YNc(8,tn,3,3,"dd",1),s._uU(9,"\n  "),s.qZA()),2&n){const n=s.oxw(2);s.xp6(3),s.Oqu(s.lcZ(4,3,"expiration")),s.xp6(3),s.Q6J("ngIf",n.sub.expiration),s.xp6(2),s.Q6J("ngIf",!n.sub.expiration)}}function on(n,t){1&n&&(s.TgZ(0,"span",15),s._uU(1),s.ALo(2,"i18n"),s.qZA()),2&n&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"pendingCancellation")))}function sn(n,t){if(1&n&&(s.TgZ(0,"tr"),s._uU(1,"\n            "),s.TgZ(2,"td"),s._uU(3),s.ALo(4,"currency"),s.qZA(),s._uU(5,"\n            "),s.TgZ(6,"td"),s._uU(7),s.ALo(8,"currency"),s.ALo(9,"i18n"),s.qZA(),s._uU(10,"\n          "),s.qZA()),2&n){const n=t.$implicit;s.xp6(3),s.lnq("\n              ",n.name," ",n.quantity>1?"×"+n.quantity:""," @\n              ",s.xi3(4,5,n.amount,"$"),"\n            "),s.xp6(4),s.AsE("",s.xi3(8,8,n.quantity*n.amount,"$")," /",s.lcZ(9,11,n.interval),"")}}function un(n,t){1&n&&(s.TgZ(0,"tr"),s._uU(1,"\n            "),s.TgZ(2,"td",20),s._uU(3,"\n              "),s.TgZ(4,"small"),s._uU(5),s.ALo(6,"i18n"),s.TgZ(7,"a",21),s._uU(8),s.ALo(9,"i18n"),s.qZA(),s._uU(10),s.ALo(11,"i18n"),s.qZA(),s._uU(12,"\n            "),s.qZA(),s._uU(13,"\n          "),s.qZA()),2&n&&(s.xp6(5),s.hij("\n                ",s.lcZ(6,3,"customBillingStart"),"\n                "),s.xp6(3),s.hij("\n                  ",s.lcZ(9,5,"billingHistory"),"\n                "),s.xp6(2),s.hij("\n                ",s.lcZ(11,7,"customBillingEnd"),"\n              "))}function cn(n,t){if(1&n&&(s.TgZ(0,"div",16),s._uU(1,"\n      "),s.TgZ(2,"strong",17),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n      "),s.TgZ(6,"table",18),s._uU(7,"\n        "),s.TgZ(8,"tbody"),s._uU(9,"\n          "),s.YNc(10,sn,11,13,"tr",19),s._uU(11,"\n          "),s.YNc(12,un,14,9,"tr",1),s._uU(13,"\n        "),s.qZA(),s._uU(14,"\n      "),s.qZA(),s._uU(15,"\n    "),s.qZA()),2&n){const n=s.oxw(3);s.xp6(3),s.Oqu(s.lcZ(4,3,"details")),s.xp6(7),s.Q6J("ngForOf",n.subscription.items),s.xp6(2),s.Q6J("ngIf",null!=n.discount&&n.discount.active)}}function rn(n,t){if(1&n&&(s.TgZ(0,"div",10),s._uU(1,"\n    "),s.TgZ(2,"div",11),s._uU(3,"\n      "),s.TgZ(4,"dl"),s._uU(5,"\n        "),s.TgZ(6,"dt"),s._uU(7),s.ALo(8,"i18n"),s.qZA(),s._uU(9,"\n        "),s.TgZ(10,"dd"),s._uU(11,"\n          "),s.TgZ(12,"span",12),s._uU(13),s.qZA(),s._uU(14,"\n          "),s.YNc(15,on,3,3,"span",13),s._uU(16,"\n        "),s.qZA(),s._uU(17,"\n        "),s.TgZ(18,"dt"),s._uU(19),s.ALo(20,"i18n"),s.qZA(),s._uU(21,"\n        "),s.TgZ(22,"dd"),s._uU(23),s.ALo(24,"date"),s.ALo(25,"currency"),s.qZA(),s._uU(26,"\n      "),s.qZA(),s._uU(27,"\n    "),s.qZA(),s._uU(28,"\n    "),s.YNc(29,cn,16,5,"div",14),s._uU(30,"\n  "),s.qZA()),2&n){const n=s.oxw(2);s.xp6(7),s.Oqu(s.lcZ(8,6,"status")),s.xp6(6),s.Oqu(n.subscription&&n.subscription.status||"-"),s.xp6(2),s.Q6J("ngIf",n.subscriptionMarkedForCancel),s.xp6(4),s.Oqu(s.lcZ(20,8,"nextCharge")),s.xp6(4),s.hij("\n          ",n.nextInvoice?s.xi3(24,10,n.nextInvoice.date,"mediumDate")+", "+s.xi3(25,13,n.nextInvoice.amount,"$"):"-","\n        "),s.xp6(6),s.Q6J("ngIf",n.subscription)}}function an(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"div",25),s._uU(1,"\n      "),s.TgZ(2,"div",26),s._uU(3,"\n        "),s.TgZ(4,"button",27),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(3);return s.KtG(t.closeUpdateLicense(!1))})),s.ALo(5,"i18n"),s._uU(6,"\n          "),s.TgZ(7,"span",28),s._uU(8,"×"),s.qZA(),s._uU(9,"\n        "),s.qZA(),s._uU(10,"\n        "),s.TgZ(11,"h3",29),s._uU(12),s.ALo(13,"i18n"),s.qZA(),s._uU(14,"\n        "),s.TgZ(15,"app-update-license",30),s.NdJ("onUpdated",(function(){s.CHM(n);const t=s.oxw(3);return s.KtG(t.closeUpdateLicense(!0))}))("onCanceled",(function(){s.CHM(n);const t=s.oxw(3);return s.KtG(t.closeUpdateLicense(!1))})),s._uU(16,"\n        "),s.qZA(),s._uU(17,"\n      "),s.qZA(),s._uU(18,"\n    "),s.qZA()}2&n&&(s.xp6(4),s.s9C("appA11yTitle",s.lcZ(5,2,"cancel")),s.xp6(8),s.Oqu(s.lcZ(13,4,"updateLicense")))}function ln(n,t){if(1&n){const n=s.EpF();s.ynx(0),s._uU(1,"\n    "),s.TgZ(2,"div"),s._uU(3,"\n      "),s.TgZ(4,"button",22),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(2);return s.KtG(t.updateLicense())})),s._uU(5),s.ALo(6,"i18n"),s.qZA(),s._uU(7,"\n      "),s.TgZ(8,"a",23),s._uU(9),s.ALo(10,"i18n"),s.qZA(),s._uU(11,"\n    "),s.qZA(),s._uU(12,"\n    "),s.YNc(13,an,19,6,"div",24),s._uU(14,"\n  "),s.BQk()}if(2&n){const n=s.oxw(2);s.xp6(5),s.hij("\n        ",s.lcZ(6,4,"updateLicense"),"\n      "),s.xp6(3),s.MGl("href","",n.cloudWebVaultUrl,"/#/settings/subscription",s.LSH),s.xp6(1),s.hij("\n        ",s.lcZ(10,6,"launchCloudSubscription"),"\n      "),s.xp6(4),s.Q6J("ngIf",n.showUpdateLicense)}}function pn(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"button",37),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(3);return s.KtG(t.downloadLicense())})),s._uU(1),s.ALo(2,"i18n"),s.qZA()}2&n&&(s.xp6(1),s.hij("\n        ",s.lcZ(2,1,"downloadLicense"),"\n      "))}function dn(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"button",38,39),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(3);return s.KtG(t.cancel())})),s._uU(2,"\n        "),s._UZ(3,"i",9),s.ALo(4,"i18n"),s._uU(5,"\n        "),s.TgZ(6,"span"),s._uU(7),s.ALo(8,"i18n"),s.qZA(),s._uU(9,"\n      "),s.qZA()}if(2&n){const n=s.MAs(1),t=s.oxw(3);s.Q6J("appApiAction",t.cancelPromise)("disabled",n.loading),s.xp6(3),s.s9C("title",s.lcZ(4,4,"loading")),s.xp6(4),s.Oqu(s.lcZ(8,6,"cancelSubscription"))}}function gn(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"div",31),s._uU(1,"\n          "),s.TgZ(2,"button",37),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(4);return s.KtG(t.adjustStorage(!0))})),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n          "),s.TgZ(6,"button",43),s.NdJ("click",(function(){s.CHM(n);const t=s.oxw(4);return s.KtG(t.adjustStorage(!1))})),s._uU(7),s.ALo(8,"i18n"),s.qZA(),s._uU(9,"\n        "),s.qZA()}2&n&&(s.xp6(3),s.hij("\n            ",s.lcZ(4,2,"addStorage"),"\n          "),s.xp6(4),s.hij("\n            ",s.lcZ(8,4,"removeStorage"),"\n          "))}function fn(n,t){if(1&n){const n=s.EpF();s.TgZ(0,"app-adjust-storage",44),s.NdJ("onAdjusted",(function(){s.CHM(n);const t=s.oxw(4);return s.KtG(t.closeStorage(!0))}))("onCanceled",(function(){s.CHM(n);const t=s.oxw(4);return s.KtG(t.closeStorage(!1))})),s.qZA()}if(2&n){const n=s.oxw(4);s.Q6J("storageGbPrice",4)("add",n.adjustStorageAdd)}}function hn(n,t){if(1&n&&(s.ynx(0),s._uU(1,"\n      "),s.TgZ(2,"div",40),s._uU(3,"\n        "),s.YNc(4,gn,10,6,"div",41),s._uU(5,"\n        "),s.YNc(6,fn,1,2,"app-adjust-storage",42),s._uU(7,"\n      "),s.qZA(),s._uU(8,"\n    "),s.BQk()),2&n){const n=s.oxw(3);s.xp6(4),s.Q6J("ngIf",!n.showAdjustStorage),s.xp6(2),s.Q6J("ngIf",n.showAdjustStorage)}}const Un=function(n){return{width:n}};function Zn(n,t){if(1&n&&(s.ynx(0),s._uU(1,"\n    "),s.TgZ(2,"div",31),s._uU(3,"\n      "),s.YNc(4,pn,3,3,"button",32),s._uU(5,"\n      "),s.YNc(6,dn,10,8,"button",33),s._uU(7,"\n    "),s.qZA(),s._uU(8,"\n    "),s.TgZ(9,"h2",34),s._uU(10),s.ALo(11,"i18n"),s.qZA(),s._uU(12,"\n    "),s.TgZ(13,"p"),s._uU(14),s.ALo(15,"i18n"),s.qZA(),s._uU(16,"\n    "),s.TgZ(17,"div",35),s._uU(18,"\n      "),s.TgZ(19,"div",36),s._uU(20),s.ALo(21,"percent"),s.qZA(),s._uU(22,"\n    "),s.qZA(),s._uU(23,"\n    "),s.YNc(24,hn,9,2,"ng-container",1),s._uU(25,"\n  "),s.BQk()),2&n){const n=s.oxw(2);s.xp6(4),s.Q6J("ngIf",!n.subscription||!n.subscription.cancelled),s.xp6(2),s.Q6J("ngIf",n.subscription&&!n.subscription.cancelled&&!n.subscriptionMarkedForCancel),s.xp6(4),s.Oqu(s.lcZ(11,8,"storage")),s.xp6(4),s.Oqu(s.Dn7(15,10,"subscriptionStorage",n.sub.maxStorageGb||0,n.sub.storageName||"0 MB")),s.xp6(5),s.Q6J("ngStyle",s.VKq(16,Un,n.storageProgressWidth+"%")),s.uIk("aria-valuenow",n.storagePercentage),s.xp6(1),s.hij("\n        ",s.lcZ(21,14,n.storagePercentage/100),"\n      "),s.xp6(4),s.Q6J("ngIf",n.subscription&&!n.subscription.cancelled&&!n.subscriptionMarkedForCancel)}}function mn(n,t){if(1&n&&(s.ynx(0),s._uU(1,"\n  "),s.YNc(2,R,4,6,"bit-callout",4),s._uU(3,"\n  "),s.YNc(4,X,18,14,"bit-callout",4),s._uU(5,"\n  "),s.YNc(6,en,10,5,"dl",1),s._uU(7,"\n  "),s.YNc(8,rn,31,16,"div",5),s._uU(9,"\n  "),s.YNc(10,ln,15,8,"ng-container",1),s._uU(11,"\n  "),s.YNc(12,Zn,26,18,"ng-container",1),s._uU(13,"\n"),s.BQk()),2&n){const n=s.oxw();s.xp6(2),s.Q6J("ngIf",n.subscription&&n.subscription.cancelled),s.xp6(2),s.Q6J("ngIf",n.subscriptionMarkedForCancel),s.xp6(2),s.Q6J("ngIf",n.selfHosted),s.xp6(2),s.Q6J("ngIf",!n.selfHosted),s.xp6(2),s.Q6J("ngIf",n.selfHosted),s.xp6(2),s.Q6J("ngIf",!n.selfHosted)}}const _n=function(n,t){return{"page-header":n,"tabbed-header":t}};class bn{constructor(n,t,i,e,o,s,u,c,r){this.stateService=n,this.apiService=t,this.platformUtilsService=i,this.i18nService=e,this.router=o,this.logService=s,this.fileDownloadService=u,this.dialogService=c,this.environmentService=r,this.loading=!1,this.firstLoaded=!1,this.adjustStorageAdd=!0,this.showAdjustStorage=!1,this.showUpdateLicense=!1,this.selfHosted=!1,this.selfHosted=i.isSelfHost(),this.cloudWebVaultUrl=this.environmentService.getCloudWebVaultUrl()}ngOnInit(){return z(this,void 0,void 0,(function*(){yield this.load(),this.firstLoaded=!0}))}load(){return z(this,void 0,void 0,(function*(){this.loading||(this.stateService.getHasPremiumPersonally()?(this.loading=!0,this.sub=yield this.apiService.getUserSubscription(),this.loading=!1):this.router.navigate(["/settings/subscription/premium"]))}))}reinstate(){return z(this,void 0,void 0,(function*(){if(this.loading)return;if(this.usingInAppPurchase)return void this.dialogService.openSimpleDialog({title:{key:"cancelSubscription"},content:{key:"manageSubscriptionFromStore"},acceptButtonText:{key:"ok"},cancelButtonText:null,type:"warning"});if(yield this.dialogService.openSimpleDialog({title:{key:"reinstateSubscription"},content:{key:"reinstateConfirmation"},type:"warning"}))try{this.reinstatePromise=this.apiService.postReinstatePremium(),yield this.reinstatePromise,this.platformUtilsService.showToast("success",null,this.i18nService.t("reinstated")),this.load()}catch(n){this.logService.error(n)}}))}cancel(){return z(this,void 0,void 0,(function*(){if(this.loading)return;if(this.usingInAppPurchase)return void this.dialogService.openSimpleDialog({title:{key:"cancelSubscription"},content:{key:"manageSubscriptionFromStore"},acceptButtonText:{key:"ok"},cancelButtonText:null,type:"warning"});if(yield this.dialogService.openSimpleDialog({title:{key:"cancelSubscription"},content:{key:"cancelConfirmation"},type:"warning"}))try{this.cancelPromise=this.apiService.postCancelPremium(),yield this.cancelPromise,this.platformUtilsService.showToast("success",null,this.i18nService.t("canceledSubscription")),this.load()}catch(n){this.logService.error(n)}}))}downloadLicense(){if(this.loading)return;const n=JSON.stringify(this.sub.license,null,2);this.fileDownloadService.download({fileName:"bitwarden_premium_license.json",blobData:n})}updateLicense(){this.loading||(this.showUpdateLicense=!0)}closeUpdateLicense(n){this.showUpdateLicense=!1,n&&this.load()}adjustStorage(n){this.usingInAppPurchase?this.dialogService.openSimpleDialog({title:{key:n?"addStorage":"removeStorage"},content:{key:"cannotPerformInAppPurchase"},acceptButtonText:{key:"ok"},cancelButtonText:null,type:"warning"}):(this.adjustStorageAdd=n,this.showAdjustStorage=!0)}closeStorage(n){this.showAdjustStorage=!1,n&&this.load()}get subscriptionMarkedForCancel(){return null!=this.subscription&&!this.subscription.cancelled&&this.subscription.cancelAtEndDate}get subscription(){return null!=this.sub?this.sub.subscription:null}get nextInvoice(){return null!=this.sub?this.sub.upcomingInvoice:null}get discount(){return null!=this.sub?this.sub.discount:null}get storagePercentage(){return null!=this.sub&&this.sub.maxStorageGb?+(this.sub.storageGb/this.sub.maxStorageGb*100).toFixed(2):0}get storageProgressWidth(){return this.storagePercentage<5?5:0}get usingInAppPurchase(){return null!=this.sub&&this.sub.usingInAppPurchase}get title(){return this.i18nService.t(this.selfHosted?"subscription":"premiumMembership")}}bn.ɵfac=function(n){return new(n||bn)(s.Y36(v.b),s.Y36(u.s),s.Y36(c.P),s.Y36(_.D),s.Y36(o.F0),s.Y36(y.$),s.Y36(F._),s.Y36(G.x),s.Y36(m.L$))},bn.ɵcmp=s.Xpm({type:bn,selectors:[["ng-component"]],decls:12,vars:8,consts:[[3,"ngClass"],[4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"],["type","warning",3,"title",4,"ngIf"],["class","row",4,"ngIf"],["type","warning",3,"title"],["bitButton","","type","button","buttonType","secondary",1,"btn-submit",3,"appApiAction","disabled","click"],["reinstateBtn",""],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"],[1,"row"],[1,"col-4"],[1,"text-capitalize"],["bitBadge","","badgeType","warning",4,"ngIf"],["class","col-8",4,"ngIf"],["bitBadge","","badgeType","warning"],[1,"col-8"],[1,"d-block","mb-1"],[1,"table"],[4,"ngFor","ngForOf"],["colspan","2"],["routerLink","/settings/subscription/billing-history"],["type","button","bitButton","","buttonType","secondary",3,"click"],["bitButton","","buttonType","secondary","target","_blank","rel","noopener",3,"href"],["class","card mt-3",4,"ngIf"],[1,"card","mt-3"],[1,"card-body"],["type","button",1,"close",3,"appA11yTitle","click"],["aria-hidden","true"],[1,"card-body-header"],[3,"onUpdated","onCanceled"],[1,"d-flex"],["bitButton","","type","button","buttonType","secondary",3,"click",4,"ngIf"],["bitButton","","type","button","buttonType","danger","class","btn-submit tw-ml-auto",3,"appApiAction","disabled","click",4,"ngIf"],[1,"spaced-header"],[1,"progress"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-success",3,"ngStyle"],["bitButton","","type","button","buttonType","secondary",3,"click"],["bitButton","","type","button","buttonType","danger",1,"btn-submit","tw-ml-auto",3,"appApiAction","disabled","click"],["cancelBtn",""],[1,"mt-3"],["class","d-flex",4,"ngIf"],[3,"storageGbPrice","add","onAdjusted","onCanceled",4,"ngIf"],["bitButton","","type","button","buttonType","secondary",1,"tw-ml-1",3,"click"],[3,"storageGbPrice","add","onAdjusted","onCanceled"]],template:function(n,t){1&n&&(s.TgZ(0,"div",0),s._uU(1,"\n  "),s.TgZ(2,"h1"),s._uU(3),s.YNc(4,V,9,6,"small",1),s._uU(5,"\n  "),s.qZA(),s._uU(6,"\n"),s.qZA(),s._uU(7,"\n"),s.YNc(8,W,9,6,"ng-container",1),s._uU(9,"\n"),s.YNc(10,mn,14,6,"ng-container",1),s._uU(11,"\n")),2&n&&(s.Q6J("ngClass",s.WLB(5,_n,t.selfHosted,!t.selfHosted)),s.xp6(3),s.hij("\n    ",t.title,"\n    "),s.xp6(1),s.Q6J("ngIf",t.firstLoaded&&t.loading),s.xp6(4),s.Q6J("ngIf",!t.firstLoaded&&t.loading),s.xp6(2),s.Q6J("ngIf",t.sub))},dependencies:[o.rH,r.mk,r.sg,r.O5,r.PC,D.B,T.b,E.l,a.r,S.O,$.H,K.$,r.Zx,r.H9,r.uU,p.C],encapsulation:2});const An=[{path:"",component:M,data:{titleId:"subscription"},children:[{path:"",pathMatch:"full",redirectTo:"premium"},{path:"user-subscription",component:bn,data:{titleId:"premiumMembership"}},{path:"premium",component:H,data:{titleId:"goPremium"}},{path:"payment-method",component:e.ZN,data:{titleId:"paymentMethod"}},{path:"billing-history",component:Z,data:{titleId:"billingHistory"}}]}];class xn{}xn.ɵfac=function(n){return new(n||xn)},xn.ɵmod=s.oAB({type:xn}),xn.ɵinj=s.cJS({imports:[o.Bz.forChild(An),o.Bz]});class yn{}yn.ɵfac=function(n){return new(n||yn)},yn.ɵmod=s.oAB({type:yn}),yn.ɵinj=s.cJS({imports:[xn,e.ql]})},72081:(n,t,i)=>{i.d(t,{Z:()=>b});var e=i(69485),o=i(24852),s=i(19419),u=i(33245),c=i(82933);function r(n,t){1&n&&(o.TgZ(0,"p"),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&n&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"noInvoices")))}function a(n,t){1&n&&(o.TgZ(0,"span"),o._uU(1,"\n          "),o._UZ(2,"i",10),o._uU(3),o.ALo(4,"i18n"),o.qZA()),2&n&&(o.xp6(3),o.hij("\n          ",o.lcZ(4,1,"paid"),"\n        "))}function l(n,t){1&n&&(o.TgZ(0,"span"),o._uU(1,"\n          "),o._UZ(2,"i",11),o._uU(3),o.ALo(4,"i18n"),o.qZA()),2&n&&(o.xp6(3),o.hij("\n          ",o.lcZ(4,1,"unpaid"),"\n        "))}function p(n,t){if(1&n&&(o.TgZ(0,"tr"),o._uU(1,"\n      "),o.TgZ(2,"td"),o._uU(3),o.ALo(4,"date"),o.qZA(),o._uU(5,"\n      "),o.TgZ(6,"td"),o._uU(7,"\n        "),o.TgZ(8,"a",7),o.ALo(9,"i18n"),o._uU(10,"\n          "),o._UZ(11,"i",8),o.qZA(),o._uU(12,"\n        "),o.TgZ(13,"a",9),o.ALo(14,"i18n"),o._uU(15),o.ALo(16,"i18n"),o.qZA(),o._uU(17,"\n      "),o.qZA(),o._uU(18,"\n      "),o.TgZ(19,"td"),o._uU(20),o.ALo(21,"currency"),o.qZA(),o._uU(22,"\n      "),o.TgZ(23,"td"),o._uU(24,"\n        "),o.YNc(25,a,5,3,"span",1),o._uU(26,"\n        "),o.YNc(27,l,5,3,"span",1),o._uU(28,"\n      "),o.qZA(),o._uU(29,"\n    "),o.qZA()),2&n){const n=t.$implicit;o.xp6(3),o.Oqu(o.xi3(4,9,n.date,"mediumDate")),o.xp6(5),o.s9C("href",n.pdfUrl,o.LSH),o.s9C("appA11yTitle",o.lcZ(9,12,"downloadInvoice")),o.xp6(5),o.s9C("href",n.url,o.LSH),o.s9C("title",o.lcZ(14,14,"viewInvoice")),o.xp6(2),o.hij("\n          ",o.xi3(16,16,"invoiceNumber",n.number),""),o.xp6(5),o.Oqu(o.xi3(21,19,n.amount,"$")),o.xp6(5),o.Q6J("ngIf",n.paid),o.xp6(2),o.Q6J("ngIf",!n.paid)}}function d(n,t){if(1&n&&(o.TgZ(0,"table",5),o._uU(1,"\n  "),o.TgZ(2,"tbody"),o._uU(3,"\n    "),o.YNc(4,p,30,22,"tr",6),o._uU(5,"\n  "),o.qZA(),o._uU(6,"\n"),o.qZA()),2&n){const n=o.oxw();o.xp6(4),o.Q6J("ngForOf",n.invoices)}}function g(n,t){1&n&&(o.TgZ(0,"p"),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&n&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"noTransactions")))}function f(n,t){1&n&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&n&&(o.xp6(1),o.hij("\n          ",o.lcZ(2,1,"chargeNoun"),"\n        "))}function h(n,t){1&n&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"i18n"),o.qZA()),2&n&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"refundNoun")))}function U(n,t){if(1&n&&o._UZ(0,"i",14),2&n){const n=o.oxw().$implicit,t=o.oxw(2);o.Q6J("ngClass",t.paymentMethodClasses(n.paymentMethodType))}}const Z=function(n){return{"text-strike":n}};function m(n,t){if(1&n&&(o.TgZ(0,"tr"),o._uU(1,"\n      "),o.TgZ(2,"td"),o._uU(3),o.ALo(4,"date"),o.qZA(),o._uU(5,"\n      "),o.TgZ(6,"td"),o._uU(7,"\n        "),o.YNc(8,f,3,3,"span",1),o._uU(9,"\n        "),o.YNc(10,h,3,3,"span",1),o._uU(11,"\n      "),o.qZA(),o._uU(12,"\n      "),o.TgZ(13,"td"),o._uU(14,"\n        "),o.YNc(15,U,1,1,"i",12),o._uU(16),o.qZA(),o._uU(17,"\n      "),o.TgZ(18,"td",13),o.ALo(19,"i18n"),o._uU(20),o.ALo(21,"currency"),o.qZA(),o._uU(22,"\n    "),o.qZA()),2&n){const n=t.$implicit,i=o.oxw(2);o.xp6(3),o.Oqu(o.xi3(4,8,n.createdDate,"mediumDate")),o.xp6(5),o.Q6J("ngIf",n.type===i.transactionType.Charge||n.type===i.transactionType.Credit),o.xp6(2),o.Q6J("ngIf",n.type===i.transactionType.Refund),o.xp6(5),o.Q6J("ngIf",n.paymentMethodType),o.xp6(1),o.hij("\n        ",n.details,"\n      "),o.xp6(2),o.s9C("title",o.lcZ(19,11,n.refunded?"refunded":"")),o.Q6J("ngClass",o.VKq(16,Z,n.refunded)),o.xp6(2),o.hij("\n        ",o.xi3(21,13,n.amount,"$"),"\n      ")}}function _(n,t){if(1&n&&(o.TgZ(0,"table",5),o._uU(1,"\n  "),o.TgZ(2,"tbody"),o._uU(3,"\n    "),o.YNc(4,m,23,18,"tr",6),o._uU(5,"\n  "),o.qZA(),o._uU(6,"\n"),o.qZA()),2&n){const n=o.oxw();o.xp6(4),o.Q6J("ngForOf",n.transactions)}}class b{constructor(){this.paymentMethodType=e.Lt,this.transactionType=e.iU}get invoices(){return null!=this.billing?this.billing.invoices:null}get transactions(){return null!=this.billing?this.billing.transactions:null}paymentMethodClasses(n){switch(n){case e.Lt.Card:return["bwi-credit-card"];case e.Lt.BankAccount:case e.Lt.WireTransfer:return["bwi-bank"];case e.Lt.BitPay:return["bwi-bitcoin text-warning"];case e.Lt.PayPal:return["bwi-paypal text-primary"];default:return[]}}}b.ɵfac=function(n){return new(n||b)},b.ɵcmp=o.Xpm({type:b,selectors:[["app-billing-history"]],inputs:{billing:"billing"},decls:20,vars:14,consts:[[1,"mt-3"],[4,"ngIf"],["class","table mb-2",4,"ngIf"],[1,"spaced-header"],[1,"text-muted"],[1,"table","mb-2"],[4,"ngFor","ngForOf"],["target","_blank","rel","noopener",1,"mr-2",3,"href","appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-file-pdf"],["target","_blank","rel","noopener",3,"href","title"],["aria-hidden","true",1,"bwi","bwi-check","text-success"],["aria-hidden","true",1,"bwi","bwi-exclamation-circle","text-muted"],["class","bwi bwi-fw","aria-hidden","true",3,"ngClass",4,"ngIf"],[3,"ngClass","title"],["aria-hidden","true",1,"bwi","bwi-fw",3,"ngClass"]],template:function(n,t){1&n&&(o.TgZ(0,"h2",0),o._uU(1),o.ALo(2,"i18n"),o.qZA(),o._uU(3,"\n"),o.YNc(4,r,3,3,"p",1),o._uU(5,"\n"),o.YNc(6,d,7,1,"table",2),o._uU(7,"\n"),o.TgZ(8,"h2",3),o._uU(9),o.ALo(10,"i18n"),o.qZA(),o._uU(11,"\n"),o.YNc(12,g,3,3,"p",1),o._uU(13,"\n"),o.YNc(14,_,7,1,"table",2),o._uU(15,"\n"),o.TgZ(16,"small",4),o._uU(17),o.ALo(18,"i18n"),o.qZA(),o._uU(19,"\n")),2&n&&(o.xp6(1),o.Oqu(o.lcZ(2,7,"invoices")),o.xp6(3),o.Q6J("ngIf",!t.invoices||!t.invoices.length),o.xp6(2),o.Q6J("ngIf",t.invoices&&t.invoices.length),o.xp6(3),o.Oqu(o.lcZ(10,9,"transactions")),o.xp6(3),o.Q6J("ngIf",!t.transactions||!t.transactions.length),o.xp6(2),o.Q6J("ngIf",t.transactions&&t.transactions.length),o.xp6(3),o.hij("* ",o.xi3(18,11,"chargesStatement","BITWARDEN"),""))},dependencies:[s.mk,s.sg,s.O5,u.B,s.H9,s.uU,c.C],encapsulation:2})},24681:(n,t,i)=>{i.d(t,{$:()=>h});var e=i(24852),o=i(55602),s=i(78627),u=i(99721),c=i(66459),r=i(97360),a=i(19419),l=i(98645),p=i(24610),d=i(82933),g=function(n,t,i,e){return new(i||(i=Promise))((function(o,s){function u(n){try{r(e.next(n))}catch(t){s(t)}}function c(n){try{r(e.throw(n))}catch(t){s(t)}}function r(n){var t;n.done?o(n.value):(t=n.value,t instanceof i?t:new i((function(n){n(t)}))).then(u,c)}r((e=e.apply(n,t||[])).next())}))};function f(n,t){if(1&n){const n=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",(function(){e.CHM(n);const t=e.oxw();return e.KtG(t.cancel())})),e._uU(1),e.ALo(2,"i18n"),e.qZA()}2&n&&(e.xp6(1),e.hij("\n    ",e.lcZ(2,1,"cancel"),"\n  "))}class h{constructor(n,t,i,o,s){this.apiService=n,this.i18nService=t,this.platformUtilsService=i,this.logService=o,this.organizationApiService=s,this.showCancel=!0,this.onUpdated=new e.vpe,this.onCanceled=new e.vpe}submit(){return g(this,void 0,void 0,(function*(){const n=document.getElementById("file").files;if(null!=n&&0!==n.length)try{const t=new FormData;t.append("license",n[0]);let i=null;i=null==this.organizationId?this.apiService.postAccountLicense(t):this.organizationApiService.updateLicense(this.organizationId,t),this.formPromise=i.then((()=>this.apiService.refreshIdentityToken())),yield this.formPromise,this.platformUtilsService.showToast("success",null,this.i18nService.t("licenseUploadSuccess")),this.onUpdated.emit()}catch(t){this.logService.error(t)}else this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("selectFile"))}))}cancel(){this.onCanceled.emit()}}h.ɵfac=function(n){return new(n||h)(e.Y36(o.s),e.Y36(s.D),e.Y36(u.P),e.Y36(c.$),e.Y36(r.M))},h.ɵcmp=e.Xpm({type:h,selectors:[["app-update-license"]],inputs:{organizationId:"organizationId",showCancel:"showCancel"},outputs:{onUpdated:"onUpdated",onCanceled:"onCanceled"},decls:29,vars:16,consts:[["ngNativeValidate","",3,"appApiAction","ngSubmit"],["form",""],[1,"form-group"],["for","file",1,"sr-only"],["type","file","id","file","name","file","required","",1,"form-control-file"],[1,"form-text","text-muted"],["type","submit",1,"btn","btn-primary","btn-submit",3,"disabled"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"],["type","button","class","btn btn-outline-secondary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"click"]],template:function(n,t){if(1&n&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",(function(){return t.submit()})),e._uU(2,"\n  "),e.TgZ(3,"div",2),e._uU(4,"\n    "),e.TgZ(5,"label",3),e._uU(6),e.ALo(7,"i18n"),e.qZA(),e._uU(8,"\n    "),e._UZ(9,"input",4),e._uU(10,"\n    "),e.TgZ(11,"small",5),e._uU(12),e.ALo(13,"i18n"),e.qZA(),e._uU(14,"\n  "),e.qZA(),e._uU(15,"\n  "),e.TgZ(16,"button",6),e._uU(17,"\n    "),e._UZ(18,"i",7),e.ALo(19,"i18n"),e._uU(20,"\n    "),e.TgZ(21,"span"),e._uU(22),e.ALo(23,"i18n"),e.qZA(),e._uU(24,"\n  "),e.qZA(),e._uU(25,"\n  "),e.YNc(26,f,3,3,"button",8),e._uU(27,"\n"),e.qZA(),e._uU(28,"\n")),2&n){const n=e.MAs(1);e.Q6J("appApiAction",t.formPromise),e.xp6(6),e.Oqu(e.lcZ(7,7,"licenseFile")),e.xp6(6),e.Oqu(e.xi3(13,9,"licenseFileDesc",t.organizationId?"bitwarden_organization_license.json":"bitwarden_premium_license.json")),e.xp6(4),e.Q6J("disabled",n.loading),e.xp6(2),e.s9C("title",e.lcZ(19,12,"loading")),e.xp6(4),e.Oqu(e.lcZ(23,14,"submit")),e.xp6(4),e.Q6J("ngIf",t.showCancel)}},dependencies:[a.O5,l.JL,l.F,p.b,d.C],encapsulation:2})}}]);
//# sourceMappingURL=228.4966542a67be575237f4.js.map